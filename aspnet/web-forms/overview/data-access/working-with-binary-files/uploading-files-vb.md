---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
title: Dosyalar (VB) | Microsoft Docs
author: rick-anderson
description: "İkili dosyaları (örneğin, Word veya PDF belgesini) yüklemek kullanıcıların Web sitenize sunucusunun dosya sisteminde bunlar burada depolanabilir öğrenin..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/27/2007
ms.topic: article
ms.assetid: f7c00fbd-652c-433d-8ed3-0e5168a4d4df
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
msc.type: authoredcontent
ms.openlocfilehash: 69586ade54a40aabb55dd507731a6c2820774c04
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2018
---
<a name="uploading-files-vb"></a><span data-ttu-id="41c68-103">Dosyalar (VB)</span><span class="sxs-lookup"><span data-stu-id="41c68-103">Uploading Files (VB)</span></span>
====================
<span data-ttu-id="41c68-104">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="41c68-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="41c68-105">[Örnek uygulamayı indirin](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) veya [PDF indirin](uploading-files-vb/_static/datatutorial54vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="41c68-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) or [Download PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span></span>

> <span data-ttu-id="41c68-106">İkili dosyaları (örneğin, Word veya PDF belgesini) yüklemek kullanıcıların Web sitenize burada bunlar sunucunun dosya sistemini veya veritabanı depolanabilir öğrenin.</span><span class="sxs-lookup"><span data-stu-id="41c68-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>


## <a name="introduction"></a><span data-ttu-id="41c68-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="41c68-107">Introduction</span></span>

<span data-ttu-id="41c68-108">Tüm öğreticileri biz kadarki incelenmesi ve özel olarak metin verilerle çalışılan.</span><span class="sxs-lookup"><span data-stu-id="41c68-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="41c68-109">Ancak, birçok uygulama, metin ve ikili veri yakalama veri modelleri vardır.</span><span class="sxs-lookup"><span data-stu-id="41c68-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="41c68-110">Çevrimiçi dating site kullanıcıların kendi profiliyle ilişkilendirmek için bir resim yüklemesine olanak sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="41c68-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="41c68-111">Personel arama bir Web sitesi, kullanıcıların kendi Sürdür Microsoft Word veya PDF belgesi olarak karşıya sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="41c68-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="41c68-112">İkili veriler ile çalışma yeni zorluklarla ekler.</span><span class="sxs-lookup"><span data-stu-id="41c68-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="41c68-113">İkili veriler uygulamada nasıl depolandığını karar vermelisiniz.</span><span class="sxs-lookup"><span data-stu-id="41c68-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="41c68-114">Kendi bilgisayarından bir dosyayı karşıya yüklemeyi izin vermek için güncelleştirilecek yeni kayıtları eklemek için kullanılan arabirimi var ve görüntülemek ya da ikili veri kaydı s karşıdan yüklemek için bir yol ilişkili sağlamak için ek adımlar izlenmelidir.</span><span class="sxs-lookup"><span data-stu-id="41c68-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="41c68-115">Bu öğretici ve sonraki üç Biz bu zorluklar hurdle nasıl ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="41c68-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="41c68-116">Bu öğreticiler sonunda bir resim ve PDF Broşürü her kategori ile ilişkilendirir tam olarak işlevsel bir uygulama oluşturduğumuz.</span><span class="sxs-lookup"><span data-stu-id="41c68-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="41c68-117">Belirli Bu öğreticide biz ikili veri depolamak için farklı teknikleri bakın ve kullanıcıların kendi bilgisayarından bir dosyayı karşıya yüklemek nasıl keşfetmek ve web sunucusu s dosya sisteminde kaydettiğiniz.</span><span class="sxs-lookup"><span data-stu-id="41c68-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="41c68-118">Bir uygulama s veri modelinin parçası olan ikili veri bazen olarak adlandırılır bir [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), ikili büyük nesne kısaltması.</span><span class="sxs-lookup"><span data-stu-id="41c68-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="41c68-119">Terim BLOB eşanlamlıdır rağmen bu öğreticileri ı terminolojisi ikili veri kullanmayı seçtiniz.</span><span class="sxs-lookup"><span data-stu-id="41c68-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>


## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="41c68-120">1. adım: ikili veri Web sayfalarıyla çalışan oluşturma</span><span class="sxs-lookup"><span data-stu-id="41c68-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="41c68-121">İkili veriler için desteği ekleme ile ilgili sorunları araştırmak başlamadan önce öncelikle Bu öğretici ve sonraki üç yapmamız gereken Web sitesi Projemizin ASP.NET sayfaları oluşturmak için bir dakikanızı ayırın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="41c68-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="41c68-122">Adlı yeni bir klasör eklemeye başlayın `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="41c68-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="41c68-123">Ardından, o klasördeki her sayfayla ilişkilendirilecek emin olmak için aşağıdaki ASP.NET sayfaları ekleme `Site.master` ana sayfa:</span><span class="sxs-lookup"><span data-stu-id="41c68-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`


![İkili veri ilişkili öğreticileri için ASP.NET sayfaları ekleme](uploading-files-vb/_static/image1.gif)

<span data-ttu-id="41c68-125">**Şekil 1**: ikili veri ilişkili öğreticileri için ASP.NET sayfaları ekleme</span><span class="sxs-lookup"><span data-stu-id="41c68-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>


<span data-ttu-id="41c68-126">Diğer klasörler gibi `Default.aspx` içinde `BinaryData` klasörü öğreticileri kendi bölümünde listeler.</span><span class="sxs-lookup"><span data-stu-id="41c68-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="41c68-127">Sözcüğünün `SectionLevelTutorialListing.ascx` kullanıcı denetimi bu işlevselliği sağlar.</span><span class="sxs-lookup"><span data-stu-id="41c68-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="41c68-128">Bu nedenle, bu kullanıcı denetimi Ekle `Default.aspx` s Tasarım görünümü sayfaya Çözüm Gezgini'nden sürükleyerek.</span><span class="sxs-lookup"><span data-stu-id="41c68-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="41c68-129">[![İçin Default.aspx SectionLevelTutorialListing.ascx kullanıcı denetimi Ekle](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span></span>

<span data-ttu-id="41c68-130">**Şekil 2**: eklemek `SectionLevelTutorialListing.ascx` kullanıcı denetimine `Default.aspx` ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-vb/_static/image2.png))</span></span>


<span data-ttu-id="41c68-131">Son olarak, bu sayfaları girişlere eklemek `Web.sitemap` dosya.</span><span class="sxs-lookup"><span data-stu-id="41c68-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="41c68-132">Özellikle, aşağıdaki biçimlendirme Enhancing sonra eklemeniz GridView `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="41c68-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>


[!code-xml[Main](uploading-files-vb/samples/sample1.xml)]

<span data-ttu-id="41c68-133">Güncelleştirdikten sonra `Web.sitemap`, bir tarayıcı aracılığıyla öğreticileri Web sitesini görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="41c68-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="41c68-134">Sol menü öğelerini ikili veri öğreticileri çalışmak için şimdi içerir.</span><span class="sxs-lookup"><span data-stu-id="41c68-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>


![Site Haritasını ikili veri öğreticileri çalışmak için girişleri şimdi içerir.](uploading-files-vb/_static/image3.gif)

<span data-ttu-id="41c68-136">**Şekil 3**: Site Haritası ikili veri öğreticileri çalışmak için girişleri şimdi içerir.</span><span class="sxs-lookup"><span data-stu-id="41c68-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>


## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="41c68-137">2. adım: ikili verileri depolanacağı karar verme</span><span class="sxs-lookup"><span data-stu-id="41c68-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="41c68-138">Uygulama s veri modeli ile ilişkili ikili verileri iki yerde birinde depolanabilir: veritabanında; depolanan dosyasına bir başvuru ile web sunucusu s dosya sisteminde veya doğrudan veritabanı içinde (Şekil 4'e bakın).</span><span class="sxs-lookup"><span data-stu-id="41c68-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="41c68-139">Her iki yaklaşımın Artıları ve eksileri kendi kümesine sahiptir ve daha ayrıntılı bir tartışma merits.</span><span class="sxs-lookup"><span data-stu-id="41c68-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>


<span data-ttu-id="41c68-140">[![İkili veriler dosya sisteminde veya doğrudan veritabanında depolanan](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span></span>

<span data-ttu-id="41c68-141">**Şekil 4**: ikili veriler, dosya sistemindeki veya doğrudan veritabanında depolanabilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-vb/_static/image4.png))</span></span>


<span data-ttu-id="41c68-142">Biz her ürünle birlikte bir resim ilişkilendirilecek Northwind veritabanı genişletmek istediğinizi düşünelim.</span><span class="sxs-lookup"><span data-stu-id="41c68-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="41c68-143">Bu görüntü dosyaları web sunucusu s dosya sisteminde depolayın ve yolu kaydetmek için bir seçenek olacaktır `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="41c68-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="41c68-144">Bu yaklaşımda, d eklediğimiz bir `ImagePath` sütuna `Products` tablo türü `varchar(200)`, belki de.</span><span class="sxs-lookup"><span data-stu-id="41c68-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="41c68-145">Web sunucusu s dosya sistemi üzerinde bir kullanıcının bir resim ayrıntılarını karşıya olduğunda, o resmi depolanabilir `~/Images/Tea.jpg`, burada `~` uygulama s fiziksel yolu temsil eder.</span><span class="sxs-lookup"><span data-stu-id="41c68-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="41c68-146">Diğer bir deyişle, web sitesi fiziksel yolda kökü ise `C:\Websites\Northwind\`, `~/Images/Tea.jpg` eşdeğer olacaktır `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="41c68-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="41c68-147">Görüntü dosyasını karşıya yüklemeden sonra d Chai kaydında güncelleştiriyoruz `Products` tablo böylece kendi `ImagePath` sütununa başvuruda yeni resmin yolu.</span><span class="sxs-lookup"><span data-stu-id="41c68-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="41c68-148">Biz kullanabilirsiniz `~/Images/Tea.jpg` veya yalnızca `Tea.jpg` tüm ürün görüntüleri uygulama s konulabilir karar verirseniz `Images` klasör.</span><span class="sxs-lookup"><span data-stu-id="41c68-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="41c68-149">Dosya sisteminde ikili veri depolamanın ana avantajları şunlardır:</span><span class="sxs-lookup"><span data-stu-id="41c68-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="41c68-150">**Uygulama kolaylığı** kısa süre içinde anlatıldığı gibi doğrudan veritabanında depolanan ikili verileri alma ve depolamada dosya sistemi üzerinden verilerle zaman çalışma değerinden biraz daha fazla kod içerir.</span><span class="sxs-lookup"><span data-stu-id="41c68-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="41c68-151">Ayrıca, sırayla görüntülemek veya ikili veri yüklemek bir kullanıcı için bunlar bu verileri URL'yi sunulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="41c68-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="41c68-152">Verileri web sunucusu s dosya sisteminde bulunuyorsa, basit bir URL'dir.</span><span class="sxs-lookup"><span data-stu-id="41c68-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="41c68-153">Veriler veritabanında depolanır ancak, bir web sayfasında almak ve dönüş verileri veritabanından oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="41c68-154">**İkili veriler için daha geniş erişim** ikili verileri diğer hizmetler veya uygulamalar, veritabanından veri çekme olamaz olanları erişilebilir olması gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="41c68-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="41c68-155">Örneğin, her ürünle ilişkili görüntüleri de aracılığıyla kullanıcılara kullanılabilir olması gereken [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), bu durumda d dosya sisteminde ikili verileri depolamak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="41c68-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="41c68-156">**Performans** dosya sisteminde saklanan ikili verileri, veritabanı sunucusu ve web sunucusu arasında isteğe bağlı ve Ağ Tıkanıklığı ikili veriler doğrudan veritabanı içinden depolanıyorsa değerinden olacaktır.</span><span class="sxs-lookup"><span data-stu-id="41c68-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="41c68-157">Dosya sisteminde ikili veri depolamanın ana dezavantajı, veritabanındaki verileri ayrıştırır ' dir.</span><span class="sxs-lookup"><span data-stu-id="41c68-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="41c68-158">Uygulamasından bir kaydı silinirse `Products` tablo, web sunucusu s dosya sisteminde ilişkili dosya otomatik olarak silinmez.</span><span class="sxs-lookup"><span data-stu-id="41c68-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="41c68-159">Dosya veya dosya sistemi silmek için ek kod kullanılmayan, yalnız bırakılmış dosyalarıyla kalabalık hale yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="41c68-160">Ayrıca, veritabanını yedeklerken, biz dosya sistemine de ilişkili ikili veri yedeklemeleri yapmak emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="41c68-161">Veritabanını başka bir site veya sunucu üzerinden benzer zorluklar taşıma.</span><span class="sxs-lookup"><span data-stu-id="41c68-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="41c68-162">Alternatif olarak, ikili veriler doğrudan bir Microsoft SQL Server 2005 veritabanında türünde bir sütun oluşturarak depolanabilir `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="41c68-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="41c68-163">Gibi diğer değişken uzunlukta veri türleriyle, maksimum uzunluktaki tutulabilir ikili veriler bu sütunda belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="41c68-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="41c68-164">Örneğin, en çok ayrılacak 5.000 bayt kullanmak `varbinary(5000)`; `varbinary(MAX)` en fazla depolama boyutunu için yaklaşık 2 GB sağlar.</span><span class="sxs-lookup"><span data-stu-id="41c68-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="41c68-165">İkili veriler doğrudan veritabanında saklamak ana avantajı ikili verileri ve veritabanı kaydını arasında sıkı bağ olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="41c68-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="41c68-166">Bu büyük ölçüde veritabanı yedeklemeleri veya farklı bir siteye veya sunucu için veritabanını taşıma gibi yönetim görevlerini basitleştirir.</span><span class="sxs-lookup"><span data-stu-id="41c68-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="41c68-167">Ayrıca, otomatik olarak kayıt silme karşılık gelen ikili verileri siler.</span><span class="sxs-lookup"><span data-stu-id="41c68-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="41c68-168">İkili veriler veritabanında saklamak daha fazla Zarif avantajları vardır.</span><span class="sxs-lookup"><span data-stu-id="41c68-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="41c68-169">Bkz: [depolama ikili dosyaları doğrudan veritabanı kullanarak ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) daha ayrıntılı bir tartışma için.</span><span class="sxs-lookup"><span data-stu-id="41c68-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="41c68-170">Microsoft SQL Server 2000 ve önceki sürümlerde, `varbinary` veri türüne sahip bir üst sınır 8.000 bayt.</span><span class="sxs-lookup"><span data-stu-id="41c68-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="41c68-171">2 GB ikili veri depolamak için [ `image` veri türü](https://msdn.microsoft.com/library/ms187993.aspx) yerine kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="41c68-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="41c68-172">Eklenmesi ile `MAX` SQL Server 2005, ancak `image` veri türü kullanım dışı bırakıldı.</span><span class="sxs-lookup"><span data-stu-id="41c68-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="41c68-173">Bu s hala desteklenmektedir için geriye dönük uyumluluk, ancak Microsoft, duyurdu `image` veri türü SQL Server'ın gelecek bir sürümünde kaldırılacak.</span><span class="sxs-lookup"><span data-stu-id="41c68-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>


<span data-ttu-id="41c68-174">Eski bir veri modeli ile çalışıyorsanız, görebilirsiniz `image` veri türü.</span><span class="sxs-lookup"><span data-stu-id="41c68-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="41c68-175">Northwind veritabanı s `Categories` tablolu bir `Picture` kategorisi için bir görüntü dosyasının ikili verileri depolamak için kullanılan sütun.</span><span class="sxs-lookup"><span data-stu-id="41c68-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="41c68-176">Northwind veritabanı, Microsoft Access ve SQL Server'ın önceki sürümlerinde, kökleri olduğundan, bu sütun türünde `image`.</span><span class="sxs-lookup"><span data-stu-id="41c68-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="41c68-177">Bu öğretici ve sonraki üç için her iki yaklaşımın kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="41c68-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="41c68-178">`Categories` Tablosu zaten bir `Picture` kategorisi için görüntü ikili içeriğini depolamak için sütun.</span><span class="sxs-lookup"><span data-stu-id="41c68-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="41c68-179">Ek bir sütun ekleyeceğiz `BrochurePath`, kategori yazdırma kalitesi, zarif bir bakış sağlamak için kullanılan web sunucusu s dosya sisteminde bir PDF yoluna depolamak için.</span><span class="sxs-lookup"><span data-stu-id="41c68-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="41c68-180">3. adım: Ekleme`BrochurePath`sütuna`Categories`tablosu</span><span class="sxs-lookup"><span data-stu-id="41c68-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="41c68-181">Şu anda yalnızca dört sütun kategorileri tablo yok: `CategoryID`, `CategoryName`, `Description`, ve `Picture`.</span><span class="sxs-lookup"><span data-stu-id="41c68-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="41c68-182">Bu alanların yanı sıra, biz (varsa), kategori s Broşürü işaret edecek yeni bir tane eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="41c68-183">Bu sütun eklemek için Sunucu Gezgini tablolara detaya, sağ tıklayın gidin `Categories` tablo ve açık tablo tanımı seçin (bkz. Şekil 5).</span><span class="sxs-lookup"><span data-stu-id="41c68-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="41c68-184">Sunucu Gezgini görmüyorsanız, Görünüm menüsünden Sunucu Gezgini seçeneği belirleyerek kutusunu açın veya Ctrl + Alt + S ulaştı.</span><span class="sxs-lookup"><span data-stu-id="41c68-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="41c68-185">Yeni bir ekleme `varchar(200)` sütuna `Categories` adlı tablo `BrochurePath` ve verir `NULL` s ve Kaydet simgesine tıklayın (veya Ctrl + S isabet).</span><span class="sxs-lookup"><span data-stu-id="41c68-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>


<span data-ttu-id="41c68-186">[![Kategoriler tabloya BrochurePath sütun ekleme](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span></span>

<span data-ttu-id="41c68-187">**Şekil 5**: ekleme bir `BrochurePath` sütuna `Categories` tablosu ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-vb/_static/image6.png))</span></span>


## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="41c68-188">4. adım: mimarisi kullanımı için güncelleştirme`Picture`ve`BrochurePath`sütunlar</span><span class="sxs-lookup"><span data-stu-id="41c68-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="41c68-189">`CategoriesDataTable` Veri erişim düzeyi (DAL) şu anda dört sahip `DataColumn` tanımlanan s: `CategoryID`, `CategoryName`, `Description`, ve `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="41c68-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="41c68-190">Ne zaman biz ilk olarak tasarlanan bu DataTable [veri erişim katmanı oluşturma](../introduction/creating-a-data-access-layer-vb.md) öğretici, `CategoriesDataTable` yalnızca ilk üç sütun içeriyor; `NumberOfProducts` sütun eklenen [ana/ayrıntı kullanarak bir madde işaretli Ana Ayrıntılar DataList kayıtlarıyla listesi](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="41c68-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial.</span></span>

<span data-ttu-id="41c68-191">' Da anlatıldığı gibi *veri erişim katmanı oluşturma*, iş nesneleri yazılan veri kümesinde DataTables olun.</span><span class="sxs-lookup"><span data-stu-id="41c68-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="41c68-192">TableAdapters ile iletişim kurmak ve sorgu sonuçlarının iş nesnelerle doldurmak için sorumludur.</span><span class="sxs-lookup"><span data-stu-id="41c68-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="41c68-193">`CategoriesDataTable` Tarafından doldurulur `CategoriesTableAdapter`, üç veri alma yöntemleri vardır:</span><span class="sxs-lookup"><span data-stu-id="41c68-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="41c68-194">`GetCategories()`TableAdapter s ana sorgu yürütür ve döndürür `CategoryID`, `CategoryName`, ve `Description` tüm kayıtları alanlarının `Categories` tablo.</span><span class="sxs-lookup"><span data-stu-id="41c68-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="41c68-195">Ana sorgu ne otomatik olarak oluşturulan tarafından kullanılır `Insert` ve `Update` yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="41c68-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="41c68-196">`GetCategoryByCategoryID(categoryID)`döndürür `CategoryID`, `CategoryName`, ve `Description` kategori alanlarını, `CategoryID` eşittir *adlı kullanıcı, Categoryıd'si*.</span><span class="sxs-lookup"><span data-stu-id="41c68-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="41c68-197">`GetCategoriesAndNumberOfProducts()`-döndürür `CategoryID`, `CategoryName`, ve `Description` tüm kayıtlar için alanları `Categories` tablo.</span><span class="sxs-lookup"><span data-stu-id="41c68-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="41c68-198">Ayrıca her kategoriyle ilişkili ürünleri sayısını döndürmek için bir alt sorgu kullanır.</span><span class="sxs-lookup"><span data-stu-id="41c68-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="41c68-199">Hiçbiri return sorgular bildirimi `Categories` s tablosu `Picture` veya `BrochurePath` sütunların; ya da mu `CategoriesDataTable` sağlamak `DataColumn` bu alanlar için s.</span><span class="sxs-lookup"><span data-stu-id="41c68-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="41c68-200">Resimle çalışması için ve `BrochurePath` özelliklerini ihtiyacımız ilk için düzenli olarak eklemek `CategoriesDataTable` ve ardından güncelleştirme `CategoriesTableAdapter` bu sütunları döndürülecek sınıfı.</span><span class="sxs-lookup"><span data-stu-id="41c68-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="41c68-201">Ekleme`Picture`ve`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="41c68-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="41c68-202">Bu iki sütun eklemeye başlayın `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="41c68-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="41c68-203">Sağ `CategoriesDataTable` s üstbilgi bağlam menüsünden Ekle'yi seçin ve ardından sütun seçeneği belirtin.</span><span class="sxs-lookup"><span data-stu-id="41c68-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="41c68-204">Bu yeni bir oluşturacak `DataColumn` adlı DataTable tablosundaki `Column1`.</span><span class="sxs-lookup"><span data-stu-id="41c68-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="41c68-205">Bu sütunu yeniden adlandırmak `Picture`.</span><span class="sxs-lookup"><span data-stu-id="41c68-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="41c68-206">Özellikler penceresinden ayarlamak `DataColumn` s `DataType` özelliğine `System.Byte[]` (Bu aşağı açılan listesinde bir seçenek değil; yazmanız gerekir).</span><span class="sxs-lookup"><span data-stu-id="41c68-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>


<span data-ttu-id="41c68-207">[![Veri türü olan System.Byte [] DataColumn adlı resim oluşturma](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span></span>

<span data-ttu-id="41c68-208">**Şekil 6**: oluşturmak bir `DataColumn` adlandırılmış `Picture` , `DataType` olan `System.Byte[]` ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-vb/_static/image8.png))</span></span>


<span data-ttu-id="41c68-209">Başka bir tane eklemek `DataColumn` DataTable tablosuna adlandırma `BrochurePath` varsayılan kullanılarak `DataType` değeri (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="41c68-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="41c68-210">Döndürme`Picture`ve`BrochurePath`TableAdapter değerleri</span><span class="sxs-lookup"><span data-stu-id="41c68-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="41c68-211">Bu iki ile `DataColumn` eklenen s `CategoriesDataTable`, biz güncelleştirmek için hazır re `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="41c68-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="41c68-212">Biz bu sütun değerleri ana TableAdapter sorgusunda döndürülen her ikisi de olabilir, ancak bu geri her zaman ikili veri sunacağı `GetCategories()` yöntem çağrıldığı.</span><span class="sxs-lookup"><span data-stu-id="41c68-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="41c68-213">Bunun yerine, let s güncelleştirin geri getirmek için ana TableAdapter sorgu `BrochurePath` ve belirli bir kategoriye s döndüren bir ek veri alma yöntemi oluşturma `Picture` sütun.</span><span class="sxs-lookup"><span data-stu-id="41c68-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="41c68-214">Ana TableAdapter sorgu güncelleştirmek için sağ `CategoriesTableAdapter` s üstbilgi ve bağlam menüsünden yapılandırma seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="41c68-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="41c68-215">Bu tablo bağdaştırıcısı Yapılandırma Sihirbazı'nı, hangi biz getirir ve geçmiş öğreticileri sayısında görülen.</span><span class="sxs-lookup"><span data-stu-id="41c68-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="41c68-216">Geri getirmek için sorguyu güncelleştirmek `BrochurePath` ve Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="41c68-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>


<span data-ttu-id="41c68-217">[![Güncelleştirme ayrıca BrochurePath dönmek için SELECT deyiminde sütun listesi](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span></span>

<span data-ttu-id="41c68-218">**Şekil 7**: sütun listesinde güncelleştirmek `SELECT` aynı zamanda sonuç ifadesine `BrochurePath` ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-vb/_static/image10.png))</span></span>


<span data-ttu-id="41c68-219">Geçici SQL deyimleri için TableAdapter kullanırken, ana sorgu sütun listesinde güncelleştirme sütun listesi için tüm güncelleştirmeleri `SELECT` sorgu TableAdapter yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="41c68-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="41c68-220">Anlamına `GetCategoryByCategoryID(categoryID)` yöntemi, geri dönmek için güncelleştirilmiştir `BrochurePath` biz hedeflenen olabilir sütun.</span><span class="sxs-lookup"><span data-stu-id="41c68-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="41c68-221">Ancak, sütun listesinde de güncelleştirilmiş `GetCategoriesAndNumberOfProducts()` yöntemi, her kategori için ürünleri sayısı döndüren kaldırmayı!</span><span class="sxs-lookup"><span data-stu-id="41c68-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="41c68-222">Bu nedenle, bu yöntem s güncelleştirmek ihtiyacımız `SELECT` sorgu.</span><span class="sxs-lookup"><span data-stu-id="41c68-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="41c68-223">Sağ `GetCategoriesAndNumberOfProducts()` yöntemi Yapılandır'ı seçin ve geri `SELECT` özgün değeri geri sorguya:</span><span class="sxs-lookup"><span data-stu-id="41c68-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>


[!code-sql[Main](uploading-files-vb/samples/sample2.sql)]

<span data-ttu-id="41c68-224">Ardından, belirli bir kategoriye s döndürür yeni bir TableAdapter yöntemi oluşturun `Picture` sütun değeri.</span><span class="sxs-lookup"><span data-stu-id="41c68-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="41c68-225">Sağ `CategoriesTableAdapter` s üstbilgi ve TableAdapter sorgu Yapılandırma Sihirbazı'nı başlatmak için Sorgu Ekle seçeneği seçin.</span><span class="sxs-lookup"><span data-stu-id="41c68-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="41c68-226">Bu sihirbaz ilk adımı bize biz geçici SQL deyimi kullanarak verileri sorgulamak istiyorsanız, yeni bir saklı yordam veya mevcut bir sorar.</span><span class="sxs-lookup"><span data-stu-id="41c68-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="41c68-227">Use SQL deyimleri seçin ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="41c68-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="41c68-228">Biz bir satır döndüren olduğundan, satır seçeneği ikinci adımdan döndüren Seç.</span><span class="sxs-lookup"><span data-stu-id="41c68-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>


<span data-ttu-id="41c68-229">[![Use SQL deyimleri seçeneği seçin](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-229">[![Select the Use SQL statements Option](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span></span>

<span data-ttu-id="41c68-230">**Şekil 8**: Use SQL deyimleri seçeneği seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-vb/_static/image12.png))</span></span>


<span data-ttu-id="41c68-231">[![Sorgu kategoriler tablosundan bir kayıt döndürür olduğundan, Seç seçin, satırları döndürür](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span></span>

<span data-ttu-id="41c68-232">**Şekil 9**: Sorgu kategoriler tablosundan seçin satırlar döndüren seçin bir kaydı döndürür bu yana ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-vb/_static/image14.png))</span></span>


<span data-ttu-id="41c68-233">Üçüncü adım, aşağıdaki SQL sorgusunu girin ve İleri'yi tıklatın:</span><span class="sxs-lookup"><span data-stu-id="41c68-233">In the third step, enter the following SQL query and click Next:</span></span>


[!code-sql[Main](uploading-files-vb/samples/sample3.sql)]

<span data-ttu-id="41c68-234">Son adım, yeni yöntemin adını seçmektir.</span><span class="sxs-lookup"><span data-stu-id="41c68-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="41c68-235">Kullanım `FillCategoryWithBinaryDataByCategoryID` ve `GetCategoryWithBinaryDataByCategoryID` dolgu DataTable ve Return DataTable, sırasıyla düzenleri.</span><span class="sxs-lookup"><span data-stu-id="41c68-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="41c68-236">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="41c68-236">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="41c68-237">[![TableAdapter s yöntemleri için adlar seçin](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span></span>

<span data-ttu-id="41c68-238">**Şekil 10**: TableAdapter s yöntemleri için adlar seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-vb/_static/image16.png))</span></span>


> [!NOTE]
> <span data-ttu-id="41c68-239">Tablo bağdaştırıcısı sorgu Yapılandırma Sihirbazı'nı tamamladıktan sonra yeni komut metni ile şema ana sorgu şemasından farklı döndürüldüğünü bildiren bir iletişim kutusu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="41c68-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="41c68-240">Sihirbaz, kısa, belirtmeye TableAdapter s ana sorgu `GetCategories()` yeni oluşturduğumuz olandan farklı bir şema döndürür.</span><span class="sxs-lookup"><span data-stu-id="41c68-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="41c68-241">Ancak bu iletiyi göz ardı edebilirsiniz şekilde ne istiyoruz, budur.</span><span class="sxs-lookup"><span data-stu-id="41c68-241">But this is what we want, so you can disregard this message.</span></span>


<span data-ttu-id="41c68-242">Ayrıca, göz önünde bulundurmanız geçici SQL deyimlerini kullanarak ve sihirbazın sonraki bir noktada TableAdapter s ana sorgu zamanında değiştirmek için kullanıyorsanız, bunu değiştirecek `GetCategoryWithBinaryDataByCategoryID` s yöntemi `SELECT` yalnızca bu sütunları içerecek şekilde deyimi s sütun listesi ana sorgu (diğer bir deyişle, kaldıracak `Picture` sorgu sütundan).</span><span class="sxs-lookup"><span data-stu-id="41c68-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="41c68-243">Döndürülecek sütun listesi el ile güncelleştirmeniz gerekecektir `Picture` sütun, ne ile yaptığımız için benzer `GetCategoriesAndNumberOfProducts()` Bu adımda yöntemi.</span><span class="sxs-lookup"><span data-stu-id="41c68-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="41c68-244">İki ekledikten sonra `DataColumn` s `CategoriesDataTable` ve `GetCategoryWithBinaryDataByCategoryID` yönteme `CategoriesTableAdapter`, bu sınıfları yazılan veri kümesi Tasarımcısı'nda Şekil 11 ekran görüntüsüne benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="41c68-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>


![Veri kümesi Tasarımcısı yöntemi ve yeni sütunlar içerir](uploading-files-vb/_static/image11.gif)

<span data-ttu-id="41c68-246">**Şekil 11**: veri kümesi Tasarımcısı yöntemi ve yeni sütunlar içerir</span><span class="sxs-lookup"><span data-stu-id="41c68-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>


## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="41c68-247">İş mantığı katmanı (BLL) güncelleştiriliyor</span><span class="sxs-lookup"><span data-stu-id="41c68-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="41c68-248">Güncelleştirilmiş DAL ile kalan tek şey bir yöntem için yeni dahil etmek için iş mantığı katmanı (BLL) büyütmek üzere `CategoriesTableAdapter` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="41c68-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="41c68-249">Aşağıdaki yöntemi ekleyin `CategoriesBLL` sınıfı:</span><span class="sxs-lookup"><span data-stu-id="41c68-249">Add the following method to the `CategoriesBLL` class:</span></span>


[!code-vb[Main](uploading-files-vb/samples/sample4.vb)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="41c68-250">5. adım: istemci Web sunucusuna bir dosyanın karşıya yükleme</span><span class="sxs-lookup"><span data-stu-id="41c68-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="41c68-251">Görmemeleri ikili verileri toplarken, bu verileri bir son kullanıcı tarafından sağlanır.</span><span class="sxs-lookup"><span data-stu-id="41c68-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="41c68-252">Bu bilgileri yakalamak için kullanıcı kendi bilgisayarından bir dosyayı web sunucusuna yüklemek gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="41c68-253">Karşıya yüklenen veriler ardından web sunucusu s dosya sistemi ve veritabanı dosyasında bir yol ekleme veya ikili içeriği doğrudan veritabanına yazma dosyayı kaydetmeden olduğu anlamına gelebilir veri modeli ile tümleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="41c68-254">Bu adımda kendi bilgisayarından bir dosya sunucusuna yüklemek bir kullanıcı izin vermek nasıl inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="41c68-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="41c68-255">Sonraki öğreticide biz yüklenen dosya veri modeli ile tümleştirmek için uygulamamızla kapatmanız.</span><span class="sxs-lookup"><span data-stu-id="41c68-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="41c68-256">ASP.NET 2.0 yenilikler [dosya yükleme Web denetimi](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) kullanıcıların bir dosya bilgisayarlarından web sunucusuna göndermek bir mekanizma sağlar.</span><span class="sxs-lookup"><span data-stu-id="41c68-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="41c68-257">Dosya yükleme denetimi olarak işleyen bir `<input>` öğesi, `type` özniteliği bir Gözat düğmesi kutusuyla olarak tarayıcıları görüntüler dosya olarak ayarlanmış.</span><span class="sxs-lookup"><span data-stu-id="41c68-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="41c68-258">Gözat düğmesini tıklatarak kullanıcı bir dosyayı seçebileceğiniz bir iletişim kutusunu açar.</span><span class="sxs-lookup"><span data-stu-id="41c68-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="41c68-259">Formun geri gönderildiğinde, seçilen dosya s içeriği geri gönderme birlikte gönderilir.</span><span class="sxs-lookup"><span data-stu-id="41c68-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="41c68-260">Sunucu tarafında yüklenen dosya hakkında bilgi dosya yükleme denetim özelliklerinde erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="41c68-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="41c68-261">Karşıya yükleme dosyaları göstermek için açık `FileUpload.aspx` sayfasındaki `BinaryData` klasör, dosya yükleme denetimini tasarımcıya araç çubuğuna sürükleyin ve s denetimini ayarlama `ID` özelliğine `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="41c68-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="41c68-262">Ardından, ayarı düğmesi Web denetim ekleme kendi `ID` ve `Text` özelliklerine `UploadButton` ve seçilen dosya, sırasıyla yükleyin.</span><span class="sxs-lookup"><span data-stu-id="41c68-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="41c68-263">Son olarak, Temizle düğmesini altındaki bir etiket Web denetimi yerleştirin, `Text` özelliği ve kümesi kendi `ID` özelliğine `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="41c68-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>


<span data-ttu-id="41c68-264">[![Dosya Yükleme denetim ASP.NET sayfası ekleme](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span></span>

<span data-ttu-id="41c68-265">**Şekil 12**: ASP.NET sayfası dosya yükleme denetim ekleme ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-vb/_static/image18.png))</span></span>


<span data-ttu-id="41c68-266">Şekil 13 bir tarayıcıdan görüntülendiğinde bu sayfada görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="41c68-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="41c68-267">Gözat düğmesini tıklatarak bir dosya seçimi iletişim kutusunu, kullanıcının kendi bilgisayardan dosya çekme izin getirir unutmayın.</span><span class="sxs-lookup"><span data-stu-id="41c68-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="41c68-268">Bir dosya seçildiğinde seçilen dosyasını karşıya yükle düğmesi geri seçilen dosya s ikili içerik web sunucusuna gönderen gönderimin neden olur.</span><span class="sxs-lookup"><span data-stu-id="41c68-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>


<span data-ttu-id="41c68-269">[![Kullanıcı bilgisayarlarından sunucuya yüklemek için bir dosya seçebilirsiniz](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span></span>

<span data-ttu-id="41c68-270">**Şekil 13**: kullanıcı bir dosyayı karşıya yükleme için sunucu bilgisayarlarına seçebilirsiniz ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-vb/_static/image20.png))</span></span>


<span data-ttu-id="41c68-271">Geri yüklenen dosya için dosya sistemi kaydedilebilir veya ikili verileri ile doğrudan bir akış çalışılabilecek.</span><span class="sxs-lookup"><span data-stu-id="41c68-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="41c68-272">Bu örnekte, oluşturma s izin bir `~/Brochures` klasörü ve karşıya yüklenen dosyasını kaydedin.</span><span class="sxs-lookup"><span data-stu-id="41c68-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="41c68-273">Başlangıç ekleyerek `Brochures` kök dizinin bir alt site klasörüne.</span><span class="sxs-lookup"><span data-stu-id="41c68-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="41c68-274">Ardından, bir olay işleyicisi oluşturun `UploadButton` s `Click` olay ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="41c68-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>


[!code-vb[Main](uploading-files-vb/samples/sample5.vb)]

<span data-ttu-id="41c68-275">Dosya yükleme denetimi çeşitli karşıya yüklenen verilerle çalışmak için özellikler sunar.</span><span class="sxs-lookup"><span data-stu-id="41c68-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="41c68-276">Örneğin, [ `HasFile` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) bir dosyayı kullanıcı tarafından karşıya yüklenen olup olmadığını gösterir sırada [ `FileBytes` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) bir bayt dizisi karşıya yüklenen ikili verilere erişim sağlar.</span><span class="sxs-lookup"><span data-stu-id="41c68-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="41c68-277">`Click` Olay işleyicisini başlatır bir dosyayı karşıya sağlayarak.</span><span class="sxs-lookup"><span data-stu-id="41c68-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="41c68-278">Bir dosyayı karşıya yüklediyseniz, etiket karşıya yüklenen dosyanın, bayt boyutunda ve, içerik türü adını gösterir.</span><span class="sxs-lookup"><span data-stu-id="41c68-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="41c68-279">Kullanıcı kontrol edebilirsiniz bir dosya yükler emin olmak için `HasFile` özelliği ve bir uyarı görüntüler, s `False`, veya kullanabilirsiniz [RequiredFieldValidator denetimi](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) yerine.</span><span class="sxs-lookup"><span data-stu-id="41c68-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `False`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>


<span data-ttu-id="41c68-280">Dosya Yükleme s `SaveAs(filePath)` karşıya yüklenen dosyanın belirtilen kaydeder *filePath*.</span><span class="sxs-lookup"><span data-stu-id="41c68-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="41c68-281">*filePath* olmalıdır bir *fiziksel yolu* (`C:\Websites\Brochures\SomeFile.pdf`) yerine bir *sanal* *yolu* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="41c68-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="41c68-282">[ `Server.MapPath(virtPath)` Yöntemi](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) sanal yolu alır ve kendi karşılık gelen fiziksel yolu döndürür.</span><span class="sxs-lookup"><span data-stu-id="41c68-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="41c68-283">Sanal yol işte `~/Brochures/fileName`, burada *fileName* yüklenen dosya adıdır.</span><span class="sxs-lookup"><span data-stu-id="41c68-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="41c68-284">Bkz: [kullanarak Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) sanal ve fiziksel yollarını ve kullanma hakkında daha fazla bilgi için `Server.MapPath`.</span><span class="sxs-lookup"><span data-stu-id="41c68-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="41c68-285">Tamamladıktan sonra `Click` olay işleyicisi sayfasını bir tarayıcıda çıkışı test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="41c68-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="41c68-286">Gözat düğmesine tıklayın ve sabit sürücünüzden bir dosya seçin ve ardından seçili dosyasını karşıya yükle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="41c68-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="41c68-287">Geri gönderme seçilen dosyanın içeriğini ardından ona kaydetmeden önce dosya hakkındaki bilgileri görüntüler web sunucusuna Gönder `~/Brochures` klasör.</span><span class="sxs-lookup"><span data-stu-id="41c68-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="41c68-288">Dosyayı karşıya yükledikten sonra Visual Studio'ya geri dönün ve Çözüm Gezgini'nde Yenile düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="41c68-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="41c68-289">Yalnızca ~/Brochures klasöründe karşıya dosya görmeniz gerekir!</span><span class="sxs-lookup"><span data-stu-id="41c68-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>


<span data-ttu-id="41c68-290">[![Dosya EvolutionValley.jpg Web sunucusuna karşıya yüklendi](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="41c68-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span></span>

<span data-ttu-id="41c68-291">**Şekil 14**: File `EvolutionValley.jpg` edilmiş yükledi Web sunucusuna ([tam boyutlu görüntüyü görüntülemek için tıklatın](uploading-files-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="41c68-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-vb/_static/image22.png))</span></span>


![EvolutionValley.jpg ~/Brochures klasörüne kaydedildi](uploading-files-vb/_static/image15.gif)

<span data-ttu-id="41c68-293">**Şekil 15**: `EvolutionValley.jpg` konumuna kaydedildi `~/Brochures` klasörü</span><span class="sxs-lookup"><span data-stu-id="41c68-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>


## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="41c68-294">Karşıya yüklenen dosyaların dosya sistemine kaydetme ile subtleties</span><span class="sxs-lookup"><span data-stu-id="41c68-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="41c68-295">Dosyaları karşıya yükleme için web sunucusu s dosya sisteminde kaydedilirken ele alınması gereken birkaç subtleties vardır.</span><span class="sxs-lookup"><span data-stu-id="41c68-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="41c68-296">İlk olarak, burada s sorunu güvenlik.</span><span class="sxs-lookup"><span data-stu-id="41c68-296">First, there s the issue of security.</span></span> <span data-ttu-id="41c68-297">Bir dosyayı dosya sistemine kaydetmek için güvenlik bağlamı altında ASP.NET sayfası yürütüyor yazma izinlerine sahip olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="41c68-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="41c68-298">ASP.NET Geliştirme Web sunucusu, geçerli kullanıcı hesabının bağlamında çalışır.</span><span class="sxs-lookup"><span data-stu-id="41c68-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="41c68-299">Microsoft s Internet Information Services (IIS) web sunucusu olarak kullanıyorsanız, güvenlik bağlamı IIS ve yapılandırmasıyla sürümüne bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="41c68-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="41c68-300">Dosya adlandırma geçici dosyaları dosya sistemine kaydetme, başka bir güçlükle döner.</span><span class="sxs-lookup"><span data-stu-id="41c68-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="41c68-301">Şu anda sayfamızı karşıya yüklenen dosyaların tamamını kaydeder `~/Brochures` s istemci bilgisayardaki dosyası olarak aynı adı kullanarak dizin.</span><span class="sxs-lookup"><span data-stu-id="41c68-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="41c68-302">Kullanıcı bir ada sahip bir Broşürü yüklerse, `Brochure.pdf`, dosya olarak kaydedilmiş `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="41c68-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="41c68-303">Ancak ne süre sonraki kullanıcı B aynı filename sahip olan bir farklı Broşürü dosyayı yükler (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="41c68-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="41c68-304">Kodla Şimdi s dosyası kullanıcı B s karşıya yükleme ile geçersiz kılınır kullanıcı sahibiz.</span><span class="sxs-lookup"><span data-stu-id="41c68-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="41c68-305">Dosya adı çakışmalarını çözmek için teknikleri mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="41c68-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="41c68-306">Zaten var., varsa aynı ada sahip bir dosyayı karşıya yüklemeyi engelle bir seçenektir.</span><span class="sxs-lookup"><span data-stu-id="41c68-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="41c68-307">Kullanıcı B adlı bir dosyayı karşıya yüklemeyi denediğinde bu yaklaşımı `Brochure.pdf`, sistem değil, dosyayı kaydedin ve bunun yerine kullanıcı dosyayı yeniden adlandırın ve yeniden denemek için B bildiren bir ileti görüntüler.</span><span class="sxs-lookup"><span data-stu-id="41c68-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="41c68-308">Olabilir bir benzersiz dosya adını kullanarak dosyayı kaydetmek için başka bir yaklaşımdır bir [genel benzersiz tanıtıcısı (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) veya kayıt s birincil anahtar sütunları veritabanı karşılık gelen değerden (karşıya yükleme ilişkili olduğu varsayılarak bir belirli bir satır veri modelindeki).</span><span class="sxs-lookup"><span data-stu-id="41c68-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="41c68-309">Sonraki öğreticide Biz bu seçenekleri daha ayrıntılı ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="41c68-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="41c68-310">İkili veri çok büyük miktarlarda ile ilgili sorunları</span><span class="sxs-lookup"><span data-stu-id="41c68-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="41c68-311">Bu öğreticiler yakalanan ikili veri boyutu uygun olduğunu varsayın.</span><span class="sxs-lookup"><span data-stu-id="41c68-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="41c68-312">Çok büyük miktarda birkaç megabayt ikili veri dosyaları ile çalışma veya daha büyük bu öğreticileri kapsamı dışındaki yeni zorluklar getirir.</span><span class="sxs-lookup"><span data-stu-id="41c68-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="41c68-313">Bu aracılığıyla yapılandırılabilir olsa da örneğin, varsayılan ASP.NET 4 MB'den daha yüklemeleri reddeder [ `<httpRuntime>` öğesi](https://msdn.microsoft.com/library/e1f13641.aspx) içinde `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="41c68-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="41c68-314">IIS kendi dosya karşıya yükleme boyutu sınırlamaları çok uygular.</span><span class="sxs-lookup"><span data-stu-id="41c68-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="41c68-315">Bkz: [IIS karşıya dosya boyutu](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) daha fazla bilgi için.</span><span class="sxs-lookup"><span data-stu-id="41c68-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="41c68-316">Ayrıca, büyük dosyaları karşıya yükleme için geçen süre 110 ASP.NET isteği için bekleyeceği saniye varsayılan aşabilir.</span><span class="sxs-lookup"><span data-stu-id="41c68-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="41c68-317">Büyük dosyaları ile çalışırken ortaya çıkan bellek ve performans sorunları vardır.</span><span class="sxs-lookup"><span data-stu-id="41c68-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="41c68-318">Büyük dosya karşıya dosya yükleme denetimi zordur.</span><span class="sxs-lookup"><span data-stu-id="41c68-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="41c68-319">Sunucuya dosya s içeriğini gönderilen gibi son kullanıcı kendi karşıya yükleme işlendiğini tüm onaysız patiently beklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="41c68-320">Bu kadar çok sorun, birkaç saniye içinde yüklenebilir, ancak bir sorun karşıya yüklemek için dakika sürebilir büyük dosyalarla ilgilenirken olabilir daha küçük dosyalar ile ilgilenirken değildir.</span><span class="sxs-lookup"><span data-stu-id="41c68-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="41c68-321">Büyük yüklemeleri işlemek için daha uygundur karşıya yükleme denetimi üçüncü taraf dosya çeşitli vardır ve bu satıcılardan çoğunu İlerleme göstergesi ve ActiveX çok daha zarif bir kullanıcı deneyimi sunmak yöneticileri karşıya sağlayın.</span><span class="sxs-lookup"><span data-stu-id="41c68-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="41c68-322">Büyük dosyaları işlemek için uygulamanız gereken dikkatle sorunları araştırmak ve belirli gereksinimlerinize göre uygun çözüm bulmak gerekir.</span><span class="sxs-lookup"><span data-stu-id="41c68-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="41c68-323">Özet</span><span class="sxs-lookup"><span data-stu-id="41c68-323">Summary</span></span>

<span data-ttu-id="41c68-324">İkili verileri yakalamak için gereken uygulama oluşturma belirli zorluklar getirir.</span><span class="sxs-lookup"><span data-stu-id="41c68-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="41c68-325">Bu öğreticide biz ilk iki incelediniz: ikili verileri depolanacağı karar verme ve bir kullanıcının bir web sayfası aracılığıyla ikili içerik yüklemek için izin verme.</span><span class="sxs-lookup"><span data-stu-id="41c68-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="41c68-326">Sonraki üç öğreticileri kendi metin veri alanları yanında ikili verileri görüntülemek nasıl yanı sıra veritabanındaki bir kaydı karşıya yüklenen veriler ilişkilendirmek nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="41c68-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="41c68-327">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="41c68-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="41c68-328">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="41c68-328">Further Reading</span></span>

<span data-ttu-id="41c68-329">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="41c68-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="41c68-330">Değer büyük veri türlerini kullanma</span><span class="sxs-lookup"><span data-stu-id="41c68-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="41c68-331">Dosya yükleme denetimi QuickStarts</span><span class="sxs-lookup"><span data-stu-id="41c68-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="41c68-332">ASP.NET 2.0 dosya yükleme sunucu denetimi</span><span class="sxs-lookup"><span data-stu-id="41c68-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="41c68-333">Dosya koyu tarafında yükler</span><span class="sxs-lookup"><span data-stu-id="41c68-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="41c68-334">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="41c68-334">About the Author</span></span>

<span data-ttu-id="41c68-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="41c68-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="41c68-336">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="41c68-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="41c68-337">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="41c68-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="41c68-338">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="41c68-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="41c68-339">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="41c68-339">Special Thanks To</span></span>

<span data-ttu-id="41c68-340">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="41c68-340">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="41c68-341">Bu öğretici için sağlama gözden geçirenler Teresa Murphy ve Bernadette Leigh yoktu.</span><span class="sxs-lookup"><span data-stu-id="41c68-341">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="41c68-342">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="41c68-342">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="41c68-343">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="41c68-343">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="41c68-344">[Önceki](updating-and-deleting-existing-binary-data-cs.md)
[sonraki](displaying-binary-data-in-the-data-web-controls-vb.md)</span><span class="sxs-lookup"><span data-stu-id="41c68-344">[Previous](updating-and-deleting-existing-binary-data-cs.md)
[Next](displaying-binary-data-in-the-data-web-controls-vb.md)</span></span>

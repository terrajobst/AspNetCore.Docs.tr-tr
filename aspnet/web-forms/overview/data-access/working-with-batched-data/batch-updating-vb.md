---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
title: "Toplu güncelleştirme (VB) | Microsoft Docs"
author: rick-anderson
description: "Tek bir işlemde birden çok veritabanı kayıtlarını güncelleştirmek üzere öğrenin. Kullanıcı arabirimi katmanda her satır düzenlenebilir olduğu GridView oluşturun. Veri..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: d191a204-d7ea-458d-b81c-0b9049ecb55f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
msc.type: authoredcontent
ms.openlocfilehash: 02df858a7ad2ccefce4717e9bb7b08fc4c8d6ace
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/10/2017
---
<a name="batch-updating-vb"></a><span data-ttu-id="08d51-105">Toplu güncelleştirme (VB)</span><span class="sxs-lookup"><span data-stu-id="08d51-105">Batch Updating (VB)</span></span>
====================
<span data-ttu-id="08d51-106">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="08d51-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="08d51-107">[Kodu indirme](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) veya [PDF indirin](batch-updating-vb/_static/datatutorial64vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="08d51-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) or [Download PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span></span>

> <span data-ttu-id="08d51-108">Tek bir işlemde birden çok veritabanı kayıtlarını güncelleştirmek üzere öğrenin.</span><span class="sxs-lookup"><span data-stu-id="08d51-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="08d51-109">Kullanıcı arabirimi katmanda her satır düzenlenebilir olduğu GridView oluşturun.</span><span class="sxs-lookup"><span data-stu-id="08d51-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="08d51-110">Veri erişim katmanı'ndaki tüm güncelleştirmeleri başarılı veya tüm güncelleştirmeler geri emin olmak için bir işlem içinde birden çok güncelleştirme işlemleri alın.</span><span class="sxs-lookup"><span data-stu-id="08d51-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="08d51-111">Giriş</span><span class="sxs-lookup"><span data-stu-id="08d51-111">Introduction</span></span>

<span data-ttu-id="08d51-112">İçinde [önceki öğretici](wrapping-database-modifications-within-a-transaction-vb.md) veritabanı işlemleri için destek eklemek için veri erişim katmanı genişletmek nasıl gördük.</span><span class="sxs-lookup"><span data-stu-id="08d51-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="08d51-113">Veritabanı işlemleri güvence altına veri değişikliği deyimleri bir dizi değişikliklerden başarısız olur veya tüm başarılı olur sağlayan bir atomik işlem olarak kabul edilir.</span><span class="sxs-lookup"><span data-stu-id="08d51-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="08d51-114">Bu alt düzey DAL işlevleri ile göz önünden, biz re toplu veri değişikliği arabirimler oluşturma için uygulamamızla etkinleştirmek için hazır.</span><span class="sxs-lookup"><span data-stu-id="08d51-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="08d51-115">Bu öğreticide biz her satır düzenlenebilir (bkz: Şekil 1) olduğu GridView yapı.</span><span class="sxs-lookup"><span data-stu-id="08d51-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="08d51-116">Her satır bir sütunu Düzenle gerek yoktur düzenleme arabirimi içinde orada s işlenmeden olduğundan, Güncelleştir ve İptal düğmeleri.</span><span class="sxs-lookup"><span data-stu-id="08d51-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="08d51-117">Bunun yerine, iki güncelleştirme ürünleri düğme vardır sayfasında, tıklatıldığında GridView satırları numaralandırmak ve veritabanını güncelleyin.</span><span class="sxs-lookup"><span data-stu-id="08d51-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>


<span data-ttu-id="08d51-118">[![Her satırda bir GridView düzenlenebilir değil](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-118">[![Each Row in the GridView is Editable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span></span>

<span data-ttu-id="08d51-119">**Şekil 1**: GridView her satır olacak düzenlenebilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-vb/_static/image2.png))</span></span>


<span data-ttu-id="08d51-120">Let s başlayın!</span><span class="sxs-lookup"><span data-stu-id="08d51-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="08d51-121">İçinde [gerçekleştirme toplu güncelleştirmeler](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) oluşturduğumuz toplu düzenleme öğretici arabirim DataList denetimini kullanma.</span><span class="sxs-lookup"><span data-stu-id="08d51-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="08d51-122">Bu öğretici, birinde kullanımdır GridView farklıdır ve toplu güncelleştirme bir işlem kapsamı içinde gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="08d51-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="08d51-123">Bu öğreticiyi tamamladıktan sonra ı önceki öğreticiye geri dönün ve önceki öğreticide eklenen veritabanı işlem ilgili işlevselliğini kullanacak şekilde güncelleştirmek için öneririz.</span><span class="sxs-lookup"><span data-stu-id="08d51-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>


## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="08d51-124">Tüm GridView satırları düzenlenebilir yapma adımları inceleniyor</span><span class="sxs-lookup"><span data-stu-id="08d51-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="08d51-125">' Da anlatıldığı gibi [, bir genel bakış ekleme, güncelleştirme ve silme veri](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) öğretici, GridView, satır başına temelinde temel alınan verileri düzenleme için yerleşik destek sunar.</span><span class="sxs-lookup"><span data-stu-id="08d51-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="08d51-126">Dahili olarak, hangi satır aracılığıyla düzenlenebilir GridView Notlar kendi [ `EditIndex` özelliği](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="08d51-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="08d51-127">GridView kendi veri kaynağına bağlı olarak, her satır satırın dizini değerini eşitse görmek için denetler `EditIndex`.</span><span class="sxs-lookup"><span data-stu-id="08d51-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="08d51-128">Bu durumda, o satırdaki alanları kendi düzenleme kullanılarak işlenir s arabirimleri.</span><span class="sxs-lookup"><span data-stu-id="08d51-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="08d51-129">BoundFields için düzenleme TextBox arabirimidir olan `Text` özelliği BoundField s tarafından belirtilen veri alanının değeri atanan `DataField` özelliği.</span><span class="sxs-lookup"><span data-stu-id="08d51-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="08d51-130">TemplateFields için `EditItemTemplate` yerine kullanılan `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="08d51-131">Bir kullanıcı bir satır s Düzenle düğmesine tıkladığında düzenleme iş akışı başlayacağını geri çağırma.</span><span class="sxs-lookup"><span data-stu-id="08d51-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="08d51-132">Bu geri gönderimin neden olur, GridView s ayarlar `EditIndex` özelliğini tıklatılan satır s dizini ve rebinds kılavuza veri.</span><span class="sxs-lookup"><span data-stu-id="08d51-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="08d51-133">Ne zaman bir satır s iptal düğmesine tıklandığında, geri göndermede `EditIndex` değerine ayarlanmış `-1` kılavuza veri kira önce.</span><span class="sxs-lookup"><span data-stu-id="08d51-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="08d51-134">GridView s satırları sıfırda Dizinlemeyi Başlat olduğundan, ayar `EditIndex` için `-1` GridView salt okunur modda görüntüleme etkisi vardır.</span><span class="sxs-lookup"><span data-stu-id="08d51-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="08d51-135">`EditIndex` Özelliği satır içi düzenleme için iyi çalışır, ancak toplu düzenleme için tasarlanmamıştır.</span><span class="sxs-lookup"><span data-stu-id="08d51-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="08d51-136">Tüm GridView düzenlenebilir yapmak için kimliğinizi düzenleme arabirimini kullanarak işlemek her satır olması gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="08d51-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="08d51-137">Bunu yapmanın en kolay yolu TemplateField düzenleme arabirimi ile tanımlandığı şekilde her düzenlenebilir bir alanı burada uygulanan oluşturmaktır `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="08d51-138">Sonraki birkaç adım tamamen düzenlenebilir GridView oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="08d51-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="08d51-139">1. adımda biz GridView ve onun ObjectDataSource oluşturarak başlayın ve kendi BoundFields ve CheckBoxField TemplateFields dönüştürme.</span><span class="sxs-lookup"><span data-stu-id="08d51-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="08d51-140">Adım 2 ve 3'te biz düzenleme arabirimleri TemplateFields taşırsınız `EditItemTemplate` s kendi `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="08d51-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="08d51-141">1. adım: Ürün bilgilerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="08d51-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="08d51-142">GridView oluşturma hakkında endişelenmeniz önce satırları nerede düzenlenebilir, ürün bilgilerini görüntüleyerek Başlat s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="08d51-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="08d51-143">Açık `BatchUpdate.aspx` sayfasındaki `BatchData` klasörü ve araç tasarımcıya GridView sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="08d51-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="08d51-144">GridView s ayarlamak `ID` için `ProductsGrid` ve adlı yeni bir ObjectDataSource bağlamak akıllı etiketten seçin `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="08d51-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="08d51-145">Kendi verilerin alınacağı ObjectDataSource yapılandırma `ProductsBLL` s sınıfı `GetProducts` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>


<span data-ttu-id="08d51-146">[![ObjectDataSource ProductsBLL sınıfını kullanmak için yapılandırma](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span></span>

<span data-ttu-id="08d51-147">**Şekil 2**: ObjectDataSource kullanılacak yapılandırma `ProductsBLL` sınıfı ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image4.png))</span></span>


<span data-ttu-id="08d51-148">[![GetProducts yöntemini kullanarak ürün verilerini alma](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span></span>

<span data-ttu-id="08d51-149">**Şekil 3**: Ürün kullanarak verileri almak `GetProducts` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-vb/_static/image6.png))</span></span>


<span data-ttu-id="08d51-150">GridView gibi ObjectDataSource s değişiklik özelliklerini bir satır başına temelinde çalışmak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="08d51-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="08d51-151">Bir kayıt kümesini güncelleştirmek için şu verileri toplu işlemleri ve BLL aktaran ASP.NET sayfası s arka plandaki kod sınıfı biraz kod yazmaya gerekir.</span><span class="sxs-lookup"><span data-stu-id="08d51-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="08d51-152">Bu nedenle, açılan listeleri ObjectDataSource s güncelleştirme, ekleme ve silme sekmeler (hiçbiri) ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="08d51-153">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="08d51-153">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="08d51-154">[![Güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) silme](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span></span>

<span data-ttu-id="08d51-155">**Şekil 4**: aşağı açılan listeler güncelleştirme, ekleme ve silme sekmeler (hiçbiri) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image8.png))</span></span>


<span data-ttu-id="08d51-156">Veri Kaynağı Yapılandırma Sihirbazı'nı tamamladıktan sonra ObjectDataSource s bildirim temelli biçimlendirme aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="08d51-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample1.aspx)]

<span data-ttu-id="08d51-157">Veri Kaynağı Yapılandırma Sihirbazı Tamamlanıyor ayrıca BoundFields ve ürün veri alanları için CheckBoxField GridView oluşturmak Visual Studio neden olur.</span><span class="sxs-lookup"><span data-stu-id="08d51-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="08d51-158">Bu öğreticide, yalnızca ürün adı, kategori, fiyat ve devam etmeyen durumunu görüntüleyin ve düzenleyin kullanıcıya izin ver s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="08d51-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="08d51-159">Kaldırma dışındaki tüm `ProductName`, `CategoryName`, `UnitPrice`, ve `Discontinued` alanları ve yeniden adlandırma `HeaderText` ilk üç özelliklerini ürün, kategori ve fiyat, sırasıyla alanları.</span><span class="sxs-lookup"><span data-stu-id="08d51-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="08d51-160">Son olarak, GridView s akıllı etiket etkinleştirmek disk belleği ve etkinleştirme sıralama onay kutularını kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="08d51-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="08d51-161">Bu noktada GridView üç BoundFields sahip (`ProductName`, `CategoryName`, ve `UnitPrice`) ve bir CheckBoxField (`Discontinued`).</span><span class="sxs-lookup"><span data-stu-id="08d51-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="08d51-162">Bu dört alanları TemplateFields dönüştürün ve ardından düzenleme arabirimi TemplateField s'den taşımak ihtiyacımız `EditItemTemplate` için kendi `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="08d51-163">Biz oluşturma ve TemplateFields içinde özelleştirme incelediniz [veri değişikliği arabirimi özelleştirme](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="08d51-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span> <span data-ttu-id="08d51-164">Biz BoundFields ve CheckBoxField TemplateFields dönüştürme adımlarda size yol ve bunların düzenleme tanımlama arabirimleri kendi `ItemTemplate` s, ancak takılmış veya Yenileyici, tan t önceki Bu öğreticinin geri başvurmak için istemeyebilir.</span><span class="sxs-lookup"><span data-stu-id="08d51-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>


<span data-ttu-id="08d51-165">GridView s akıllı etiketten alanları iletişim kutusunu açmak için sütunları Düzenle bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="08d51-166">Ardından, her bir alan seçin ve bu alan dönüştürme TemplateField bağlantıya tıklayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>


![Varolan BoundFields ve CheckBoxField TemplateFields dönüştürme](batch-updating-vb/_static/image5.gif)

<span data-ttu-id="08d51-168">**Şekil 5**: Varolan BoundFields ve CheckBoxField TemplateFields dönüştürme</span><span class="sxs-lookup"><span data-stu-id="08d51-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateFields</span></span>


<span data-ttu-id="08d51-169">Her bir alan bir TemplateField eder, gelen biz düzenleme taşımak için hazır re arabirim `EditItemTemplate` s `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="08d51-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="08d51-170">2. adım: Oluşturma`ProductName`,`UnitPrice`, ve`Discontinued`arabirimleri düzenleme</span><span class="sxs-lookup"><span data-stu-id="08d51-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="08d51-171">Oluşturma `ProductName`, `UnitPrice`, ve `Discontinued` arabirimleri düzenleme bu adımın konu ve her bir arabirime zaten TemplateField s içinde tanımlanan oldukça basit `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="08d51-172">Oluşturma `CategoryName` arabirimini düzenleme biraz daha karmaşık DropDownList geçerli kategorilerin oluşturmak gerektiği.</span><span class="sxs-lookup"><span data-stu-id="08d51-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="08d51-173">Bu `CategoryName` arabirimini düzenleme adım 3'te tackled.</span><span class="sxs-lookup"><span data-stu-id="08d51-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="08d51-174">S başlamalı ve izin `ProductName` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="08d51-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="08d51-175">GridView s akıllı etiket Şablonları Düzenle bağlantısından tıklayın ve detayına gitmek `ProductName` TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="08d51-176">TextBox seçin, panoya kopyalayın ve yapıştırın kendisine `ProductName` TemplateField s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="08d51-177">TextBox s değiştirme `ID` özelliğine `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="08d51-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="08d51-178">Ardından, bir RequiredFieldValidator eklemek `ItemTemplate` kullanıcı her ürün s adı için bir değer sağlar emin olmak için.</span><span class="sxs-lookup"><span data-stu-id="08d51-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="08d51-179">Ayarlama `ControlToValidate` ProductName, özelliğine `ErrorMessage` size özelliği ürün adı sağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="08d51-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="08d51-180">ve `Text` özelliğine \*.</span><span class="sxs-lookup"><span data-stu-id="08d51-180">and the `Text` property to \*.</span></span> <span data-ttu-id="08d51-181">Bu eklemeler yaptıktan sonra `ItemTemplate`, ekranınızın Şekil 6 benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="08d51-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>


<span data-ttu-id="08d51-182">[![Metin kutusu ve bir RequiredFieldValidator ProductName TemplateField şimdi içerir](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span></span>

<span data-ttu-id="08d51-183">**Şekil 6**: `ProductName` TemplateField şimdi içeren bir metin kutusu ve RequiredFieldValidator bir ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-vb/_static/image10.png))</span></span>


<span data-ttu-id="08d51-184">İçin `UnitPrice` arabirimini düzenleme, metin kopyalayarak Başlat `EditItemTemplate` için `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="08d51-185">Ardından, $ TextBox ve kümesi önüne yerleştirin, `ID` UnitPrice özelliğine ve kendi `Columns` 8 özelliği.</span><span class="sxs-lookup"><span data-stu-id="08d51-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="08d51-186">Ayrıca bir CompareValidator ekleyin `UnitPrice` s `ItemTemplate` kullanıcı tarafından girilen değer geçerli para birimi değeri $0,00 eşit veya daha büyük olduğundan emin olmak için.</span><span class="sxs-lookup"><span data-stu-id="08d51-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="08d51-187">Doğrulayıcı s ayarlamak `ControlToValidate` UnitPrice, özelliğine kendi `ErrorMessage` , özelliğine geçerli para birimi değeri girmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="08d51-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="08d51-188">Lütfen atlayın. herhangi bir para birimi sembolleri, kendi `Text` özelliğine \*, kendi `Type` özelliğine `Currency`, kendi `Operator` özelliğine `GreaterThanEqual`ve kendi `ValueToCompare` özelliğinin 0.</span><span class="sxs-lookup"><span data-stu-id="08d51-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>


<span data-ttu-id="08d51-189">[![Negatif olmayan para birimi değeri fiyat girilen emin olmak için bir CompareValidator ekleyin](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span></span>

<span data-ttu-id="08d51-190">**Şekil 7**: girilen fiyat emin olmak için bir CompareValidator negatif olmayan para birimi değeri ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-vb/_static/image12.png))</span></span>


<span data-ttu-id="08d51-191">İçin `Discontinued` TemplateField kullanabileceğiniz zaten tanımlanmış onay kutusunu `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="08d51-192">Basitçe, `ID` Üretimi Durdurulmuş için ve kendi `Enabled` özelliğine `True`.</span><span class="sxs-lookup"><span data-stu-id="08d51-192">Simply set its `ID` to Discontinued and its `Enabled` property to `True`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="08d51-193">3. adım: Oluşturma`CategoryName`arabirimini düzenleme</span><span class="sxs-lookup"><span data-stu-id="08d51-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="08d51-194">Düzenleme arabiriminde `CategoryName` TemplateField s `EditItemTemplate` değerini gösteren bir metin kutusu içeren `CategoryName` veri alanı.</span><span class="sxs-lookup"><span data-stu-id="08d51-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="08d51-195">Bu olası kategorilerini listeler bir DropDownList ile değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="08d51-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="08d51-196">[Veri değişikliği arabirimi özelleştirme](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) öğretici içeren metin kutusu aksine DropDownList dahil etmek için bir şablonu özelleştirme hakkında daha kapsamlı ve eksiksiz bir tartışma.</span><span class="sxs-lookup"><span data-stu-id="08d51-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="08d51-197">Adımlar burada tam olsa da, bunlar tersely sunulur.</span><span class="sxs-lookup"><span data-stu-id="08d51-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="08d51-198">Oluşturma ve kategorilere DropDownList yapılandırma bir daha derinlemesine bakış için geri başvurmak [veri değişikliği arabirimi özelleştirme](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="08d51-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="08d51-199">Araç kutusu üzerine bir DropDownList sürükleyin `CategoryName` TemplateField s `ItemTemplate`, ayar kendi `ID` için `Categories`.</span><span class="sxs-lookup"><span data-stu-id="08d51-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="08d51-200">Bu noktada biz genellikle kendi akıllı etiket üzerinden DropDownLists s veri kaynağına yeni ObjectDataSource oluşturma tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="08d51-201">Ancak, bu içinde ObjectDataSource ekler `ItemTemplate`, her GridView satır için oluşturulan ObjectDataSource örneğindeki neden.</span><span class="sxs-lookup"><span data-stu-id="08d51-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="08d51-202">Bunun yerine, GridView s TemplateFields dışında ObjectDataSource oluşturmak s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="08d51-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="08d51-203">Şablon düzenleme sonlandırmak ve bir ObjectDataSource tasarımcıya araç çubuğuna sürükleyin `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="08d51-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="08d51-204">Yeni ObjectDataSource ad `CategoriesDataSource` ve kullanacak şekilde yapılandırın `CategoriesBLL` s sınıfı `GetCategories` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>


<span data-ttu-id="08d51-205">[![ObjectDataSource CategoriesBLL sınıfını kullanmak için yapılandırma](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span></span>

<span data-ttu-id="08d51-206">**Şekil 8**: ObjectDataSource kullanılacak yapılandırma `CategoriesBLL` sınıfı ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image14.png))</span></span>


<span data-ttu-id="08d51-207">[![GetCategories yöntemini kullanarak kategori verilerini alma](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span></span>

<span data-ttu-id="08d51-208">**Şekil 9**: Kategori kullanarak verileri almak `GetCategories` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-vb/_static/image16.png))</span></span>


<span data-ttu-id="08d51-209">Bu ObjectDataSource yalnızca verileri almak için kullanıldığından, aşağı açılır listeler UPDATE ve DELETE sekmeler (hiçbiri) olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="08d51-210">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="08d51-210">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="08d51-211">[![Ayarlama güncelleştirme ve silme sekmelerde (hiçbiri) aşağı açılır listeler](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span></span>

<span data-ttu-id="08d51-212">**Şekil 10**: aşağı açılan listeler güncelleştirme ve silme sekmeler (yok) olarak ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image18.png))</span></span>


<span data-ttu-id="08d51-213">Sihirbazı tamamladıktan sonra `CategoriesDataSource` s bildirim temelli biçimlendirme, aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="08d51-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample2.aspx)]

<span data-ttu-id="08d51-214">İle `CategoriesDataSource` oluşturduktan ve yapılandırdıktan, geri dönüp `CategoryName` TemplateField s `ItemTemplate` ve DropDownList s akıllı etiketten veri kaynağı Seç bağlantıyı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="08d51-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="08d51-215">Veri Kaynağı Yapılandırma Sihirbazı'nda seçin `CategoriesDataSource` seçeneğini ilk açılan listeden ve tercih `CategoryName` görüntülemek için kullanılan ve `CategoryID` değeri olarak.</span><span class="sxs-lookup"><span data-stu-id="08d51-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>


<span data-ttu-id="08d51-216">[![DropDownList CategoriesDataSource bağlama](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span></span>

<span data-ttu-id="08d51-217">**Şekil 11**: DropDownList bağlamak `CategoriesDataSource` ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-vb/_static/image20.png))</span></span>


<span data-ttu-id="08d51-218">Bu noktada `Categories` DropDownList tüm kategorilerini listeler, ancak değil henüz otomatik olarak GridView satıra bağlı ürün için uygun kategoriyi seçin.</span><span class="sxs-lookup"><span data-stu-id="08d51-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="08d51-219">Bunu ayarlamak için ihtiyacımız gerçekleştirmek için `Categories` DropDownList s `SelectedValue` s ürününe `CategoryID` değeri.</span><span class="sxs-lookup"><span data-stu-id="08d51-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="08d51-220">DropDownList s akıllı etiket veri bağlamaları Düzenle bağlantısından tıklayın ve ilişkilendirmek `SelectedValue` özelliğiyle `CategoryID` veri alan Şekil 12'de gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="08d51-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>


![Ürün s adlı kullanıcı, Categoryıd'si değeri DropDownList s SelectedValue özelliği Bağla](batch-updating-vb/_static/image12.gif)

<span data-ttu-id="08d51-222">**Şekil 12**: s ürün bağlamak `CategoryID` DropDownList s değerine `SelectedValue` özelliği</span><span class="sxs-lookup"><span data-stu-id="08d51-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>


<span data-ttu-id="08d51-223">Bir son sorun kalır: Ürün içermiyor t varsa bir `CategoryID` değeri belirtilen sonra Veri bağlamada bildirimi `SelectedValue` bir özel durum neden olur.</span><span class="sxs-lookup"><span data-stu-id="08d51-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="08d51-224">DropDownList yalnızca kategorileri öğelerini içerir ve bir seçenek olan bu ürünler için sunmaz Bunun nedeni bir `NULL` veritabanı için değer `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="08d51-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="08d51-225">Bu sorunu gidermek için DropDownList s ayarlamak `AppendDataBoundItems` özelliğine `True` ve DropDownList için yeni bir öğe eklemek atlama `Value` Tanımlayıcı Sözdizimi özelliğinden.</span><span class="sxs-lookup"><span data-stu-id="08d51-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `True` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="08d51-226">Diğer bir deyişle, olduğundan emin olun `Categories` DropDownList s tanımlayıcı sözdizimi aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="08d51-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample3.aspx)]

<span data-ttu-id="08d51-227">Not nasıl `<asp:ListItem Value="">` --seçin bir--sahip kendi `Value` özniteliğini açıkça boş bir dize olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="08d51-228">Geri başvurmak [veri değişikliği arabirimi özelleştirme](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) işlemek için bu ek DropDownList madde neden gerekli üzerinde daha kapsamlı bir tartışma için öğretici `NULL` çalışması ve neden atamasının `Value` boş bir dize özelliği gereklidir.</span><span class="sxs-lookup"><span data-stu-id="08d51-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="08d51-229">Tümleştirilmediği olan bir olası performans ve ölçeklenebilirlik sorunu burada yoktur.</span><span class="sxs-lookup"><span data-stu-id="08d51-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="08d51-230">Her satır kullanan bir DropDownList olduğundan `CategoriesDataSource` kendi veri kaynağı olarak `CategoriesBLL` s sınıfı `GetCategories` yöntemi çağrılabilir  *n*  sayfa başına kez ziyaret edin, burada  *n*  GridView satır sayısı.</span><span class="sxs-lookup"><span data-stu-id="08d51-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="08d51-231">Bunlar  *n*  çağrılar `GetCategories` neden  *n*  veritabanına sorgular.</span><span class="sxs-lookup"><span data-stu-id="08d51-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="08d51-232">İstek başına önbelleğinde veya bağımlılık veya çok kısa bir süre tabanlı bir sona erme önbelleğe alma SQL kullanarak önbelleğe alma katmanı ile döndürülen kategorilerde önbelleğe alarak Bu etkiyi veritabanında kısılmış.</span><span class="sxs-lookup"><span data-stu-id="08d51-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="08d51-233">İstek başına hakkında daha fazla bilgi için bkz, önbelleğe [ `HttpContext.Items` başına istek önbelleği deposu](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="08d51-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>


## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="08d51-234">4. adım: düzenleme arabirimi Tamamlanıyor</span><span class="sxs-lookup"><span data-stu-id="08d51-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="08d51-235">Biz ullanıcı yapılan değişiklik sayısı GridView s şablonların bizim ilerleme durumunu görüntülemek için duraklatmadan.</span><span class="sxs-lookup"><span data-stu-id="08d51-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="08d51-236">Bir tarayıcı aracılığıyla bizim ilerleme durumunu görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="08d51-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="08d51-237">Şekil 13 gösterildiği gibi her satır kullanılarak işlenir kendi `ItemTemplate`, arabirimini düzenleme hücre s içerir.</span><span class="sxs-lookup"><span data-stu-id="08d51-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>


<span data-ttu-id="08d51-238">[![Düzenlenebilir her GridView satırıdır](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-238">[![Each GridView Row is Editable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span></span>

<span data-ttu-id="08d51-239">**Şekil 13**: düzenlenebilir her GridView satırıdır ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-vb/_static/image22.png))</span></span>


<span data-ttu-id="08d51-240">Bu noktada ilgilenebilmek birkaç Önemsiz biçimlendirme sorunları vardır.</span><span class="sxs-lookup"><span data-stu-id="08d51-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="08d51-241">İlk olarak, unutmayın `UnitPrice` değeri dört ondalık basamak içerir.</span><span class="sxs-lookup"><span data-stu-id="08d51-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="08d51-242">Bu sorunu gidermek için dönmek `UnitPrice` TemplateField s `ItemTemplate` ve TextBox s akıllı etiketten veri bağlamaları Düzenle bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="08d51-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="08d51-243">Ardından, belirten `Text` özelliği bir sayı olarak biçimlendirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="08d51-243">Next, specify that the `Text` property should be formatted as a number.</span></span>


![Bir sayı olarak format metin özelliği](batch-updating-vb/_static/image14.gif)

<span data-ttu-id="08d51-245">**Şekil 14**: biçimi `Text` bir sayı olarak özelliği</span><span class="sxs-lookup"><span data-stu-id="08d51-245">**Figure 14**: Format the `Text` Property as a Number</span></span>


<span data-ttu-id="08d51-246">İkinci olarak, onay kutusuna merkezi let s `Discontinued` sütun (yerine onu sola hizalı).</span><span class="sxs-lookup"><span data-stu-id="08d51-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="08d51-247">GridView s akıllı etiketten Düzenle sütunlarda tıklayın ve `Discontinued` TemplateField sol alt köşedeki alanlarında listesinden.</span><span class="sxs-lookup"><span data-stu-id="08d51-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="08d51-248">İçinde ayrıntıya `ItemStyle` ve `HorizontalAlign` Şekil 15'te gösterildiği gibi Merkezi özelliğine.</span><span class="sxs-lookup"><span data-stu-id="08d51-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>


![Merkezi devam etmeyen onay kutusu](batch-updating-vb/_static/image15.gif)

<span data-ttu-id="08d51-250">**Şekil 15**: Merkezi `Discontinued` onay kutusu</span><span class="sxs-lookup"><span data-stu-id="08d51-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>


<span data-ttu-id="08d51-251">Ardından, bir ValidationSummary denetimi sayfasına ekleyin ve ayarlayın, `ShowMessageBox` özelliğine `True` ve kendi `ShowSummary` özelliğine `False`.</span><span class="sxs-lookup"><span data-stu-id="08d51-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="08d51-252">Ayrıca tıklatıldığında düğmesi Web, denetimleri ekleme, kullanıcı s değişiklikleri güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="08d51-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="08d51-253">Özellikle, iki düğmesi Web denetimleri, GridView yukarıdaki ve her iki denetimleri ayarlama bir altındaki eklemeniz `Text` güncelleştirme ürünleri özellikleri.</span><span class="sxs-lookup"><span data-stu-id="08d51-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="08d51-254">Bu yana GridView s arabirimini düzenleme kendi TemplateFields tanımlanan `ItemTemplate` s, `EditItemTemplate` s gereksiz ve silinmiş.</span><span class="sxs-lookup"><span data-stu-id="08d51-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="08d51-255">Yukarıdaki yapmadan biçimlendirme değişiklikleri bahsedilen sonra düğmesi denetimleri ekleme ve gereksiz kaldırma `EditItemTemplate` s, sayfa s bildirim temelli söz dizimini görünmelidir aşağıdakine benzer:</span><span class="sxs-lookup"><span data-stu-id="08d51-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample4.aspx)]

<span data-ttu-id="08d51-256">Şekil 16 düğmesi Web denetimleri ekledikten sonra bir tarayıcıdan görüntülendiğinde bu sayfayı ve biçimlendirme değişikliklerinin gösterir.</span><span class="sxs-lookup"><span data-stu-id="08d51-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>


<span data-ttu-id="08d51-257">[![Sayfa şimdi iki güncelleştirme ürünleri düğmelerini içerir](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="08d51-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span></span>

<span data-ttu-id="08d51-258">**Şekil 16**: sayfa şimdi içeren iki güncelleştirme ürünleri düğmelerini ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-updating-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="08d51-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-vb/_static/image24.png))</span></span>


## <a name="step-5-updating-the-products"></a><span data-ttu-id="08d51-259">5. adım: ürünleri güncelleştiriliyor</span><span class="sxs-lookup"><span data-stu-id="08d51-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="08d51-260">Bir kullanıcı bu sayfayı ziyaret ettiğinde bunlar kendi değişiklikleri yapın ve sonra iki güncelleştirme ürünleri düğmeleri birini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="08d51-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="08d51-261">Bu noktada şekilde her bir satır için kullanıcı tarafından girilen değerlerini kaydetmek ihtiyacımız bir `ProductsDataTable` örneği ve daha sonra, ardından geçer BLL yönteme geçirin `ProductsDataTable` DAL s örneğine `UpdateWithTransaction` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="08d51-262">`UpdateWithTransaction` İçinde oluşturduğumuz yöntemi [önceki öğretici](wrapping-database-modifications-within-a-transaction-vb.md), toplu değişiklikler atomik bir işlem olarak güncelleştirilecek sağlar.</span><span class="sxs-lookup"><span data-stu-id="08d51-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="08d51-263">Adlı bir yöntem oluşturma `BatchUpdate` içinde `BatchUpdate.aspx.vb` ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="08d51-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.vb` and add the following code:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample5.vb)]

<span data-ttu-id="08d51-264">Bu yöntem ürünlerin tamamı alarak başlar geri bir `ProductsDataTable` BLL s çağrısıyla `GetProducts` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="08d51-265">Ardından numaralandırır `ProductGrid` GridView s [ `Rows` koleksiyonu](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="08d51-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="08d51-266">`Rows` Koleksiyonu içeren bir [ `GridViewRow` örneği](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.aspx) GridView görüntülenen her satır için.</span><span class="sxs-lookup"><span data-stu-id="08d51-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="08d51-267">Biz sayfasında, GridView s başına en fazla on satır gösteren beri `Rows` koleksiyonu, en fazla on öğe olacaktır.</span><span class="sxs-lookup"><span data-stu-id="08d51-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="08d51-268">Her satır için `ProductID` gelen gerçekleşti `DataKeys` toplama ve uygun `ProductsRow` seçilir `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="08d51-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="08d51-269">Dört TemplateField giriş denetimlerini programlı olarak başvurulan ve değerlerine atandığı `ProductsRow` örnek s özellikleri.</span><span class="sxs-lookup"><span data-stu-id="08d51-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="08d51-270">Sonra her GridView satır s değerleri güncelleştirmek için kullanılan `ProductsDataTable`, onu s geçirilen BLL s `UpdateWithTransaction` önceki öğreticide gördüğümüz gibi sadece DAL s çağırır yöntemi `UpdateWithTransaction` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="08d51-271">Bu öğretici için toplu güncelleştirme algoritmadan her satır güncelleştirmeleri `ProductsDataTable` karşılık gelen ürün s bilgileri olup değişti bağımsız olarak GridView, bir satır.</span><span class="sxs-lookup"><span data-stu-id="08d51-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="08d51-272">Bu tür blind geçekleştirilen t genellikle bir performans sorunu güncelleştirirken, Denetim yapıldığı veritabanı tablosuna değişirse bunlar gereksiz kayıtları yol açabilir.</span><span class="sxs-lookup"><span data-stu-id="08d51-272">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="08d51-273">Geri [gerçekleştirme toplu güncelleştirmeler](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) arabirimi ile DataList güncelleştiriliyor bir batch incelediniz ve kullanıcı tarafından gerçekten değiştirilen kayıtları yalnızca güncelleştirecektir kod eklenen öğretici.</span><span class="sxs-lookup"><span data-stu-id="08d51-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="08d51-274">Teknikleri çekinmeyin [gerçekleştirme toplu güncelleştirmeler](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) isterseniz bu öğreticide, kod güncelleştirilecek.</span><span class="sxs-lookup"><span data-stu-id="08d51-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="08d51-275">GridView, akıllı etiket aracılığıyla veri kaynağına bağlanırken, Visual Studio veri kaynağı s birincil anahtar değerlerinin GridView s otomatik olarak atar. `DataKeyNames` özelliği.</span><span class="sxs-lookup"><span data-stu-id="08d51-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="08d51-276">ObjectDataSource GridView s akıllı etiket aracılığıyla GridView için 1. adımda özetlenen bağlanamadı sonra GridView s el ile ayarlamanız gerekir `DataKeyNames` erişmek için ProductID özelliğine `ProductID` her satır için değer `DataKeys` koleksiyonu.</span><span class="sxs-lookup"><span data-stu-id="08d51-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>


<span data-ttu-id="08d51-277">İçinde kullanılan kod `BatchUpdate` BLL s kullanılan benzer `UpdateProduct` yöntemleri, giriş olan temel fark `UpdateProduct` yöntemleri yalnızca tek bir `ProductRow` örneği mimarisinden alınır.</span><span class="sxs-lookup"><span data-stu-id="08d51-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="08d51-278">Özelliklerini atar kod `ProductRow` arasında aynı `UpdateProducts` yöntemler ve kod içinde `For Each` içinde döngü `BatchUpdate`genel deseni gibi.</span><span class="sxs-lookup"><span data-stu-id="08d51-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `For Each` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="08d51-279">Bu öğreticiyi tamamlamak için ihtiyacımız `BatchUpdate` yöntemi çağrıldıktan güncelleştirme ürünleri düğmelerin ya da tıklandığında.</span><span class="sxs-lookup"><span data-stu-id="08d51-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="08d51-280">Olay işleyicileri oluşturma `Click` bu iki olayları düğmesi denetimleri ve olay işleyicileri aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="08d51-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample6.vb)]

<span data-ttu-id="08d51-281">İlk için bir çağrı yapılır `BatchUpdate`.</span><span class="sxs-lookup"><span data-stu-id="08d51-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="08d51-282">Ardından, [ `ClientScript` özelliği](https://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript(VS.80).aspx) ürünlerin güncelleştirilmiş okuyan messagebox görüntüler JavaScript eklemesine kullanılır.</span><span class="sxs-lookup"><span data-stu-id="08d51-282">Next, the [`ClientScript` property](https://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript(VS.80).aspx) is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="08d51-283">Bu kodu test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="08d51-283">Take a minute to test out this code.</span></span> <span data-ttu-id="08d51-284">Ziyaret `BatchUpdate.aspx` bir tarayıcı aracılığıyla satır sayısını düzenleyin ve güncelleştirme ürünleri düğmelerden birini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="08d51-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="08d51-285">Giriş doğrulaması hatalar yoktur varsayıldığında, güncelleştirilen ürünler okuyan messagebox görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="08d51-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="08d51-286">Güncelleştirme kararlılık doğrulamak için bir rastgele eklemeyi düşünün `CHECK` gibi izin vermez bir kısıtlama `UnitPrice` 1234.56 değerleri.</span><span class="sxs-lookup"><span data-stu-id="08d51-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="08d51-287">Öğesinden sonra `BatchUpdate.aspx`, birkaç s ürün ayarlayın emin kayıtların Düzenle `UnitPrice` değerini yasaklanmış değerle (1234.56).</span><span class="sxs-lookup"><span data-stu-id="08d51-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="08d51-288">Bu toplu işlem sırasında diğer değişikliklerle güncelleştirme ürünleri tıklatarak özgün değerlerine döndürülmesine olduğunda bu hataya neden olur.</span><span class="sxs-lookup"><span data-stu-id="08d51-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="08d51-289">Alternatif`BatchUpdate`yöntemi</span><span class="sxs-lookup"><span data-stu-id="08d51-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="08d51-290">`BatchUpdate` Biz yalnızca yöntemi incelenmesi alır *tüm* BLL s ürünlerin `GetProducts` yöntemi ve GridView görünür yalnızca bu kayıtları güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="08d51-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="08d51-291">Bu yaklaşım GridView disk belleği kullanmaz, ancak aşması durumunda olabilir yüzlerce, binlerce ya da binlerce ürünleri, ancak yalnızca on satırlarda GridView idealdir.</span><span class="sxs-lookup"><span data-stu-id="08d51-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="08d51-292">Böyle bir durumda, tüm ürünleri yalnızca 10 bunları değiştirmek için veritabanından alma değerinden idealdir.</span><span class="sxs-lookup"><span data-stu-id="08d51-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="08d51-293">Bu durumlarda türleri için aşağıdaki kullanmayı `BatchUpdateAlternate` yöntemi bunun yerine:</span><span class="sxs-lookup"><span data-stu-id="08d51-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample7.vb)]

<span data-ttu-id="08d51-294">`BatchMethodAlternate`Yeni ve boş bir oluşturarak başlar `ProductsDataTable` adlı `products`.</span><span class="sxs-lookup"><span data-stu-id="08d51-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="08d51-295">Ardından GridView s adımlara `Rows` koleksiyonu ve her satırın BLL s kullanarak belirli bir ürün bilgilerini alır için `GetProductByProductID(productID)` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="08d51-296">Alınan `ProductsRow` örneği sahip aynı şekilde güncelleştirilmiş özelliklerini `BatchUpdate`, ancak alınan içine satır güncelleştirdikten sonra `products` `ProductsDataTable` DataTable s aracılığıyla [ `ImportRow(DataRow)` yöntemi](https://msdn.microsoft.com/en-us/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="08d51-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products` `ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/en-us/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="08d51-297">Sonra `For Each` döngüsü tamamlandıktan, `products` içeriyor `ProductsRow` GridView her satır için örneği.</span><span class="sxs-lookup"><span data-stu-id="08d51-297">After the `For Each` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="08d51-298">Her biri bu yana `ProductsRow` örnekleri eklenmiştir `products` (yerine güncelleştirilmiş), sizi doğrudan kendisine başarılı olursa `UpdateWithTransaction` yöntemi `ProductsTableAdatper` her kayıtlar veritabanına eklemek çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="08d51-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdatper` will try to insert each of the records into the database.</span></span> <span data-ttu-id="08d51-299">Bunun yerine, biz bu satırların her biri (eklenmedi) değiştirilmiş olduğunu belirtmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="08d51-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="08d51-300">Bu yeni bir yöntem adlı BLL ekleyerek gerçekleştirilebilir `UpdateProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="08d51-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="08d51-301">`UpdateProductsWithTransaction`, aşağıda gösterilen kümeleri `RowState` her birinin `ProductsRow` içinde örnekleri `ProductsDataTable` için `Modified` ve daha sonra geçirir `ProductsDataTable` DAL s `UpdateWithTransaction` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="08d51-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample8.vb)]

## <a name="summary"></a><span data-ttu-id="08d51-302">Özet</span><span class="sxs-lookup"><span data-stu-id="08d51-302">Summary</span></span>

<span data-ttu-id="08d51-303">GridView, satır başına yerleşik düzenleme yetenekleri sağlar ancak tam olarak düzenlenebilir arabirimler oluşturma desteği eksik.</span><span class="sxs-lookup"><span data-stu-id="08d51-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="08d51-304">Biz bu öğreticide gördüğünüz gibi bu tür arabirimleri mümkündür, ancak iş bir bit gerektirir.</span><span class="sxs-lookup"><span data-stu-id="08d51-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="08d51-305">Her satır olduğu düzenlenebilir GridView oluşturmak için GridView s alanları TemplateFields dönüştürmek ve düzenleme arabirimde tanımlamak ihtiyacımız `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="08d51-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="08d51-306">Ayrıca, güncelleştirme tüm - düğmesi Web denetimleri türü sayfasında, GridView ayrı eklenmelidir.</span><span class="sxs-lookup"><span data-stu-id="08d51-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="08d51-307">Bu düğme `Click` olay işleyicileri gereksinim GridView s Numaralandırılacak `Rows` koleksiyonu, değişiklikleri saklamak bir `ProductsDataTable`ve güncelleştirilmiş bilgileri uygun BLL yönteme geçirin.</span><span class="sxs-lookup"><span data-stu-id="08d51-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="08d51-308">Sonraki öğreticide toplu silme için bir arabirim oluşturma göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="08d51-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="08d51-309">Her GridView satır özellikle ve bir onay kutusu eklemek yerine Tümünü Güncelleştir-yazın düğmeleri, seçili satırları silme düğmeleri sahip olacaksınız.</span><span class="sxs-lookup"><span data-stu-id="08d51-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="08d51-310">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="08d51-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="08d51-311">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="08d51-311">About the Author</span></span>

<span data-ttu-id="08d51-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="08d51-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="08d51-313">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="08d51-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="08d51-314">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="08d51-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="08d51-315">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="08d51-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="08d51-316">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="08d51-316">Special Thanks To</span></span>

<span data-ttu-id="08d51-317">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="08d51-317">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="08d51-318">Bu öğretici için sağlama gözden geçirenler Teresa Murphy ve David Suru yoktu.</span><span class="sxs-lookup"><span data-stu-id="08d51-318">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="08d51-319">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="08d51-319">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="08d51-320">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="08d51-320">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="08d51-321">[Önceki](wrapping-database-modifications-within-a-transaction-vb.md)
[sonraki](batch-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="08d51-321">[Previous](wrapping-database-modifications-within-a-transaction-vb.md)
[Next](batch-deleting-vb.md)</span></span>

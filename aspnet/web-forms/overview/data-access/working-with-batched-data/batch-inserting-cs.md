---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
title: Toplu ekleme (C#) | Microsoft Docs
author: rick-anderson
description: Tek bir işlemde birden çok veritabanı kayıtları eklemek öğrenin. Kullanıcı arabirimi katmanında birden çok n girmesini izin vermek için GridView genişletmek...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: cf025e08-48fc-4385-b176-8610aa7b5565
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
msc.type: authoredcontent
ms.openlocfilehash: c8995592d9206fb17a7769414212369946304c54
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
---
<a name="batch-inserting-c"></a><span data-ttu-id="b8f9f-104">Toplu ekleme (C#)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-104">Batch Inserting (C#)</span></span>
====================
<span data-ttu-id="b8f9f-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b8f9f-106">[Kodu indirme](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) veya [PDF indirin](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) or [Download PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span></span>

> <span data-ttu-id="b8f9f-107">Tek bir işlemde birden çok veritabanı kayıtları eklemek öğrenin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="b8f9f-108">Kullanıcı arabirimi katmanında birden çok yeni kayıtları girmek izin vermek için GridView genişletir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="b8f9f-109">Veri erişim katmanı'ndaki tüm eklemeleri başarılı veya tüm eklemeleri geri emin olmak için bir işlem içinde birden çok ekleme işlemleri alın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="b8f9f-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="b8f9f-110">Introduction</span></span>

<span data-ttu-id="b8f9f-111">İçinde [toplu güncelleştirme](batch-updating-cs.md) Aranan burada birden çok kayıt düzenlenebilir bir arabirim sunmak için GridView denetimini özelleştirme adresindeki öğretici.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-111">In the [Batch Updating](batch-updating-cs.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="b8f9f-112">Sayfasını ziyaret kullanıcı, bir dizi değişikliği yapın ve sonra toplu güncelleştirme bir düğmeye tıklamayla gerçekleştirin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="b8f9f-113">Kullanıcıların yaygın olarak güncelleştirme tek bir seferde çok sayıda kayıt durumlarda, böyle bir arabirim sayısız tıklama kaydedebilir ve varsayılan karşılaştırıldığında klavye ve fare İçerik Geçişi başına satır ilk geri incelediniz düzenleme özellikleri [bir Ekleme, güncelleştirme ve silme veri genel bakış](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span></span>

<span data-ttu-id="b8f9f-114">Bu kavram kayıtları eklerken uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="b8f9f-115">Düşünün burada Northwind Traders yaygın olarak sevkiyat belirli bir kategorideki ürünleri bir sayı içermesi sağlayıcılardan gelen aldığımız.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="b8f9f-116">Örnek olarak, biz sevkiyat altı farklı Çay ve kahve ürünleri Tokyo Traders ' alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="b8f9f-117">Bir kullanıcı aynı anda DetailsView denetimi ile altı ürünleri bir girerse, bunlar aynı değerlere çoğunu tekrar tekrar seçin gerekecektir: aynı kategori (Meşrubat) aynı üretici (Tokyo Traders) seçmeniz gerekir, aynı dönüştürülmesine değeri () False) ve aynı sıra değeri (0) birimlerde.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="b8f9f-118">Bu yinelenen veri girişi yalnızca zaman alıcıdır değildir, ancak hatalara açıktır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="b8f9f-119">Küçük bir iş ile kullanıcının tedarikçi kategori kez, bir dizi ürün adları ve birim fiyatları girin ve yeni ürünler veritabanına eklemek için düğmeyi tıklatın seçmesini sağlayan arabirim ekleme toplu iş oluşturabilir (bkz: Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="b8f9f-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="b8f9f-120">Her ürünün eklendikçe kendi `ProductName` ve `UnitPrice` veri alanları metin kutularına, girilen değerler atanır sırada kendi `CategoryID` ve `SupplierID` değerler değerleri üst fo formun en DropDownLists'ndan atanır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="b8f9f-121">`Discontinued` Ve `UnitsOnOrder` değerler sabit kodlanmış değerler ayarlanır `false` ve 0, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `false` and 0, respectively.</span></span>


<span data-ttu-id="b8f9f-122">[![Toplu ekleme arabirimi](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-122">[![The Batch Inserting Interface](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span></span>

<span data-ttu-id="b8f9f-123">**Şekil 1**: toplu ekleme arabirimi ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-cs/_static/image3.png))</span></span>


<span data-ttu-id="b8f9f-124">Bu öğreticide Şekil 1'de gösterilen arabirimi ekleme toplu uygulayan bir sayfa oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="b8f9f-125">Olarak önceki iki öğreticileri ile biz eklemeleri kararlılık sağlamak için bir işlem kapsamı içinde kaydırılır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="b8f9f-126">Let s başlayın!</span><span class="sxs-lookup"><span data-stu-id="b8f9f-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="b8f9f-127">1. adım: görüntü arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="b8f9f-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="b8f9f-128">Bu öğretici iki bölgelere ayrılmış tek bir sayfayla oluşur: bir görüntü bölgesi ve bir ekleme bölgesi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="b8f9f-129">Bu adımda oluşturacağız, görüntü arabirimi bir GridView ürünlerini gösterir ve işlem ürün sevkiyat başlıklı bir düğme içerir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="b8f9f-130">Bu düğmeye tıklandığında, görüntü arabirimi Şekil 1'de gösterilen ekleme arabirimi ile değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="b8f9f-131">Görüntü arabirimi sonra ürün ekleme yapılan sevkiyat döndürür veya İptal düğmeleri tıklattınız.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="b8f9f-132">2. adımda ekleme arabirimi oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="b8f9f-133">Bir sayfa oluşturma yalnızca biri aynı anda görünür, iki arabirim olduğunda her bir arabirime içinde genellikle yerleştirilir bir [Masası Web denetimi](http://www.w3schools.com/aspnet/control_panel.asp), diğer denetimler için bir kapsayıcı olarak sunar.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="b8f9f-134">Bu nedenle, sayfamızı iki Panel denetimleri bir her arabirim için olacaktır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="b8f9f-135">Başlangıç açarak `BatchInsert.aspx` sayfasındaki `BatchData` klasörü ve araç tasarımcıya sürükleyin bir Panel (bkz: Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="b8f9f-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="b8f9f-136">S Masası belirlenen `ID` özelliğine `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="b8f9f-137">Bölmenin Designer'a eklerken, `Height` ve `Width` özellikler ayarlanır 50px ve 125px, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="b8f9f-138">Bu özellik değerlerini Özellikler penceresinde Temizle.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-138">Clear out these property values from the Properties window.</span></span>


<span data-ttu-id="b8f9f-139">[![Bir Panel tasarımcıya araç çubuğuna sürükleyin](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span></span>

<span data-ttu-id="b8f9f-140">**Şekil 2**: bir panelin tasarımcıya araç çubuğuna sürükleyin ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-cs/_static/image6.png))</span></span>


<span data-ttu-id="b8f9f-141">Ardından, bir düğmeyi ve GridView denetimi paneline sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="b8f9f-142">S düğmesi ayarlamak `ID` özelliğine `ProcessShipment` ve kendi `Text` işlem ürün sevkiyat özelliğine.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="b8f9f-143">GridView s ayarlamak `ID` özelliğine `ProductsGrid` ve akıllı etiketten adlı yeni bir ObjectDataSource bağlayın `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="b8f9f-144">ObjectDataSource kendi verisinden isteyecek şekilde yapılandırma `ProductsBLL` s sınıfı `GetProducts` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="b8f9f-145">Bu GridView, yalnızca verileri görüntülemek için kullanıldığından, güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) SİLİN.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="b8f9f-146">Veri Kaynağı Yapılandırma Sihirbazı'nı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-146">Click Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="b8f9f-147">[![S ProductsBLL sınıfı GetProducts yönteminden döndürülen verileri görüntüleme](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span></span>

<span data-ttu-id="b8f9f-148">**Şekil 3**: döndürülen veriler görüntülemek `ProductsBLL` s sınıfı `GetProducts` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-cs/_static/image9.png))</span></span>


<span data-ttu-id="b8f9f-149">[![Güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) silme](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span></span>

<span data-ttu-id="b8f9f-150">**Şekil 4**: aşağı açılan listeler güncelleştirme, ekleme ve silme sekmeler (hiçbiri) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-cs/_static/image12.png))</span></span>


<span data-ttu-id="b8f9f-151">ObjectDataSource Sihirbazı'nı tamamladıktan sonra Visual Studio BoundFields ve ürün veri alanları için CheckBoxField ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="b8f9f-152">Kaldırma dışındaki tüm `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, ve `Discontinued` alanları.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="b8f9f-153">Estetik tüm özelleştirmeler çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="b8f9f-154">Biçimlendirme karar `UnitPrice` alan bir para birimi değeri olarak alanları kaldırılmasında ve bazı alanlar yeniden adlandırıldı `HeaderText` değerleri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="b8f9f-155">Ayrıca disk belleği ve Destek GridView s akıllı etiket etkinleştirmek disk belleği ve etkinleştirme sıralama onay kutularını işaretleyerek sıralama dahil olmak üzere GridView yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="b8f9f-156">Paneli, düğmesi, GridView ve ObjectDataSource denetimler ekleme ve GridView s alanlarını özelleştirme sonra sayfa s bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="b8f9f-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](batch-inserting-cs/samples/sample1.aspx)]

<span data-ttu-id="b8f9f-157">Düğmesini ve GridView için biçimlendirme görünür ve açma ve kapatma içinde Not `<asp:Panel>` etiketler.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="b8f9f-158">Bu denetimler içinde olduğundan `DisplayInterface` paneli, biz Gizle bunları s paneli ayarlayarak `Visible` özelliğine `false`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `false`.</span></span> <span data-ttu-id="b8f9f-159">3. adım arar s paneli programlı adresindeki `Visible` düğmesine yanıtında özelliği diğer gizleme çalışırken bir arabirim göster için tıklayın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="b8f9f-160">Bir tarayıcı aracılığıyla bizim ilerleme durumunu görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="b8f9f-161">Şekil 5 gösterildiği gibi aynı anda on ürünleri listeler GridView işlem ürün sevkiyat düğmesini görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>


<span data-ttu-id="b8f9f-162">[![GridView ürünleri listeler ve sıralama ve yetenekleri disk belleği sunar](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span></span>

<span data-ttu-id="b8f9f-163">**Şekil 5**: GridView ürünleri ve sunar sıralama ve disk belleği özellikleri listelenmektedir ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-cs/_static/image15.png))</span></span>


## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="b8f9f-164">2. adım: ekleme arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="b8f9f-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="b8f9f-165">Tam ekran arabirimiyle biz ekleme oluşturmak için hazır re arabirim.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="b8f9f-166">Bu öğretici için bir üretici ve kategori için tek bir değer ister ve en fazla beş ürün adları ve birim fiyat değerleri girmesini sağlayan bir ekleme arabirim oluşturmak s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="b8f9f-167">Bu arabirim, kullanıcının tüm aynı kategoriye ve tedarikçi paylaşır, ancak benzersiz ürün adları ve fiyatlarını içeren bir ile beş yeni ürünler ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="b8f9f-168">Araç kutusu varolan altındaki yerleştirme tasarımcıya'ndan bir Panel sürükleyerek başlangıç `DisplayInterface` paneli.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="b8f9f-169">Ayarlama `ID` bu özelliği yeni eklenen paneline `InsertingInterface` ve kendi `Visible` özelliğine `false`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `false`.</span></span> <span data-ttu-id="b8f9f-170">Ayarlar kodu ekleyeceğiz `InsertingInterface` Masası s `Visible` özelliğine `true` adım 3'te.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `true` in Step 3.</span></span> <span data-ttu-id="b8f9f-171">Ayrıca s panelini dışarı temizleyin `Height` ve `Width` özellik değerleri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="b8f9f-172">Ardından, biz Şekil 1'de gösterilen ekleme arabirimi oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="b8f9f-173">Bu arabirim HTML teknikleri çeşitli oluşturulabilir ancak oldukça basit bir kullanacağız: dört sütunlu, yedi satır bir tablo.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="b8f9f-174">İşaretleme için HTML girerken `<table>` öğeleri tercih ediyorum kaynak görünümü kullanmak.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="b8f9f-175">Visual Studio Araçları eklemek için varken `<table>` öğelerini Tasarımcısı aracılığıyla Tasarımcı görünüyor eklemesine tüm çok istekli için sorulmamış `style` işaretleme içine ayarları.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="b8f9f-176">I oluşturduktan sonra `<table>` biçimlendirme, ı genellikle dönüş Web denetimleri ekleme ve bunların özelliklerini ayarlamak için Designer'a.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="b8f9f-177">Önceden belirlenen sütunları ve satırları tablo oluştururken, statik HTML kullanarak tercih ediyorum yerine [Tablo Web denetimi](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) yerleştirilmiş bir tablo Web denetimi tüm Web denetimleri yalnızca kullanılarak erişilebilir olduğundan `FindControl("controlID")` düzeni.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="b8f9f-178">Ancak, Tablo Web denetimleri tablolar için (yalnızca satır veya sütun bazı veritabanı veya kullanıcı tarafından belirtilen ölçütleri temel olanları), dinamik olarak ölçekli tablo denetim programlı olarak oluşturulabilir Web itibaren kullanabilirim.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>


<span data-ttu-id="b8f9f-179">İçinde aşağıdaki biçimlendirme girin `<asp:Panel>` etiketlerinin `InsertingInterface` paneli:</span><span class="sxs-lookup"><span data-stu-id="b8f9f-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>


[!code-html[Main](batch-inserting-cs/samples/sample2.html)]

<span data-ttu-id="b8f9f-180">Bu `<table>` biçimlendirme herhangi bir Web denetim içermez henüz bu bir anlık olarak ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="b8f9f-181">Unutmayın, her `<tr>` öğe belirli bir CSS sınıfı ayarı içeriyor: `BatchInsertHeaderRow` burada Tedarikçi ve kategori DropDownLists çıkar; üstbilgisi satır için `BatchInsertFooterRow` burada sevkiyat ve İptal düğmeleri ekleme ürünleri çıkar; altbilgi satır ve değişen `BatchInsertRow` ve `BatchInsertAlternatingRow` ürünü ve birimi içeren satırları değerlerini fiyat TextBox denetimleri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="b8f9f-182">T ve karşılık gelen CSS sınıfları oluşturulan `Styles.css` ekleme arabirimi GridView ve DetailsView benzer bir görünüm vermek için dosya Biz bu öğreticileri kullanılan ve denetler.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="b8f9f-183">Bu CSS sınıfları aşağıda verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-183">These CSS classes are shown below.</span></span>


[!code-css[Main](batch-inserting-cs/samples/sample3.css)]

<span data-ttu-id="b8f9f-184">Girilen bu biçimlendirme ile Tasarım görünümüne dönün.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="b8f9f-185">Bu `<table>` Şekil 6 gösterildiği gibi dört sütunlu, yedi satır bir Tablo Tasarımcısı'nda olarak göstermesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>


<span data-ttu-id="b8f9f-186">[![Ekleme arabirimi oluşan bir dört sütunlu, yedi satırlı bir tablo,](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span></span>

<span data-ttu-id="b8f9f-187">**Şekil 6**: ekleme arabirimi oluşur bir dört sütunlu, yedi satırlı bir tablo, ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-cs/_static/image18.png))</span></span>


<span data-ttu-id="b8f9f-188">Şu anda yeniden Web denetimleri ekleme arabirimi eklemek için hazır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="b8f9f-189">İki DropDownLists Araç Kutusu'ndan tablosundaki bir üretici ve kategori için uygun hücrelere sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="b8f9f-190">DropDownList s sağlayıcısına ayarlamak `ID` özelliğine `Suppliers` ve adlı yeni bir ObjectDataSource bağlama `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="b8f9f-191">Kendi verileri almak için yeni ObjectDataSource yapılandırma `SuppliersBLL` s sınıfı `GetSuppliers` yöntemi ve küme güncelleştirme sekmesinde s aşağı açılan listesi (hiçbiri).</span><span class="sxs-lookup"><span data-stu-id="b8f9f-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="b8f9f-192">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-192">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="b8f9f-193">[![ObjectDataSource s SuppliersBLL sınıfı GetSuppliers yöntemi kullanmak üzere yapılandırma](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span></span>

<span data-ttu-id="b8f9f-194">**Şekil 7**: ObjectDataSource kullanılacak yapılandırma `SuppliersBLL` s sınıfı `GetSuppliers` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-cs/_static/image21.png))</span></span>


<span data-ttu-id="b8f9f-195">Sahip `Suppliers` DropDownList görüntü `CompanyName` veri alan ve kullanım `SupplierID` veri alanı olarak kendi `ListItem` s değerleri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>


<span data-ttu-id="b8f9f-196">[![ŞirketAdı veri alanını görüntüler ve SupplierID değeri olarak kullanır.](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span></span>

<span data-ttu-id="b8f9f-197">**Şekil 8**: görüntü `CompanyName` veri alan ve kullanım `SupplierID` değeri olarak ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-cs/_static/image24.png))</span></span>


<span data-ttu-id="b8f9f-198">İkinci DropDownList ad `Categories` ve adlı yeni bir ObjectDataSource bağlama `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="b8f9f-199">Yapılandırma `CategoriesDataSource` kullanılacak ObjectDataSource `CategoriesBLL` s sınıfı `GetCategories` yöntemi; aşağı açılan listeler UPDATE ve DELETE sekmeler (hiçbiri) ve tıklatın kümesi son Sihirbazı tamamlayın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="b8f9f-200">Son olarak, DropDownList görüntü olması `CategoryName` veri alan ve kullanım `CategoryID` değeri olarak.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="b8f9f-201">Bu iki DropDownLists eklenir ve uygun şekilde yapılandırılmış ObjectDataSources bağlı sonra ekranınızın Şekil 9'a benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>


<span data-ttu-id="b8f9f-202">[![Üstbilgi satırındaki şimdi üreticiler ve kategorileri DropDownLists içerir](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span></span>

<span data-ttu-id="b8f9f-203">**Şekil 9**: üstbilgisi satır şimdi içerir `Suppliers` ve `Categories` DropDownLists ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-cs/_static/image27.png))</span></span>


<span data-ttu-id="b8f9f-204">Biz şimdi adı ve yeni her ürün için fiyat toplamak için metin kutuları oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="b8f9f-205">TextBox denetimi tasarımcıya araç her beş ürün adı ve fiyat satır sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="b8f9f-206">Ayarlama `ID` kutularındaki özelliklerini `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="b8f9f-207">Her birim fiyat ayarı metin kutuları, sonra bir CompareValidator ekleyin `ControlToValidate` özelliğine uygun `ID`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="b8f9f-208">Ayrıca `Operator` özelliğine `GreaterThanEqual`, `ValueToCompare` 0 olarak ve `Type` için `Currency`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="b8f9f-209">Bu ayarları fiyat girdiyseniz, büyük veya sıfıra eşit bir geçerli para birimi değeri olduğundan emin olmak için CompareValidator isteyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="b8f9f-210">Ayarlama `Text` özelliğine \*, ve `ErrorMessage` fiyata değerinden büyük veya sıfıra eşit olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="b8f9f-211">Ayrıca, lütfen hiçbir para birimi simgesini yok sayın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="b8f9f-212">Ekleme arabirimi tüm RequiredFieldValidator denetimlerinin rağmen içermeyen `ProductName` alanındaki `Products` veritabanı tablosu izin verme `NULL` değerleri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="b8f9f-213">En fazla beş ürünleri girmesine olanak istiyoruz olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="b8f9f-214">Kullanıcı için ilk üç satır ürün adı ve birim fiyat sağlamak için olsaydı, örneğin, son iki satırını boş bırakarak d şu üç yeni ürünler sisteme eklemeniz yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="b8f9f-215">Bu yana `ProductName` olan gerekli, ancak biz olması durumunda bir birim fiyat emin olmak için girilen karşılık gelen bir ürün adı değeri sağladığınız programlı olarak denetlemek gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="b8f9f-216">Biz bu onay adım 4'te üstesinden gelmek.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-216">We'll tackle this check in Step 4.</span></span>


<span data-ttu-id="b8f9f-217">Değer bir para birimi simgesini içeriyorsa s kullanıcı girişini doğrulama olduğunda CompareValidator geçersiz veri bildirir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="b8f9f-218">Her birim fiyat para birimi simgesini fiyatı girerken atlamak için kullanıcı yönlendiren bir görsel ipucu hizmet vermek için metin kutuları önünde $ ekleyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="b8f9f-219">Son olarak, içinde bir ValidationSummary denetimi ekleme `InsertingInterface` paneli, ayarları kendi `ShowMessageBox` özelliğine `true` ve kendi `ShowSummary` özelliğine `false`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="b8f9f-220">Bu ayarlara sahip kullanıcı geçersiz birim fiyat değeri girerse, soruna neden olan TextBox denetimleri yanında bir yıldız işareti görünür ve daha önce belirtilen hata iletisini gösteren bir istemci-tarafı messagebox ValidationSummary görüntüler.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="b8f9f-221">Bu noktada, ekranınızın Şekil 10'a benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-221">At this point, your screen should look similar to Figure 10.</span></span>


<span data-ttu-id="b8f9f-222">[![Ekleme arabirim, ürünler için metin kutuları içerir adları ve fiyatlarını](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span></span>

<span data-ttu-id="b8f9f-223">**Şekil 10**: ekleme arabirimi şimdi içeren metin kutuları fiyatları ve ürün adları için ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-cs/_static/image30.png))</span></span>


<span data-ttu-id="b8f9f-224">Sonraki biz altbilgi satırın sevkiyat ve İptal düğmeleri ürün ekleme eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="b8f9f-225">Sürükleme iki düğmesi denetimleri Araç Kutusu'ndan ekleme arabirimi altbilgi ayarlama düğmeleri `ID` özelliklerine `AddProducts` ve `CancelButton` ve `Text` ürünler sevkiyat ve iptal, sırasıyla eklemek için özellikler.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="b8f9f-226">Buna ek olarak, `CancelButton` denetim s `CausesValidation` özelliğine `false`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="b8f9f-227">Son olarak, size iki arabirimleri için durum iletilerini görüntüler bir etiket Web denetimi eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="b8f9f-228">Kullanıcı başarıyla ürünlerin yeni bir sevkiyat eklediğinde, örneğin, görüntü arabirimine döner ve bir onay iletisi görüntüler istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="b8f9f-229">Ancak, ürün adı devre dışı bırakır, ancak yeni bir ürün için bir fiyat kullanıcı sağlarsa, bu yana bir uyarı iletisi görüntülenecek ihtiyacımız `ProductName` alan gereklidir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="b8f9f-230">Bu ileti için her iki arabirimde görüntülemek için ihtiyacımız olduğundan, sayfanın üst kısmındaki panelleri dışında yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="b8f9f-231">Bir etiket Web denetimi sayfanın üst kısmındaki Tasarımcısı'nda Araç Kutusu'ndan sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="b8f9f-232">Ayarlama `ID` özelliğine `StatusLabel`, kullanıma açık `Text` özelliği ve kümesi `Visible` ve `EnableViewState` özelliklerine `false`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `false`.</span></span> <span data-ttu-id="b8f9f-233">Önceki eğitimlerine anlatıldığı gibi ayarı `EnableViewState` özelliğine `false` bize programlı olarak etiket s özellik değerlerini değiştirmek ve bunları otomatik olarak geri sonraki geri gönderme kendi varsayılanlarına geri dönmek izin verir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `false` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="b8f9f-234">Bu yanıt sonraki geri göndermede kaybolur bazı kullanıcı eylemi olarak bir durum iletisi gösteren kodunu kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="b8f9f-235">Son olarak, ayarlamak `StatusLabel` denetim s `CssClass` bir CSS sınıfı adı uyarı özelliğine tanımlanan `Styles.css` büyük, italik, kalın, kırmızı yazı tipiyle metni görüntüler.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="b8f9f-236">Şekil 11 etiketi ekledikten ve yapılandırılmış sonra Visual Studio tasarımcısı gösterir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>


<span data-ttu-id="b8f9f-237">[![İki Panel denetimleri yukarıda StatusLabel'i denetimi yerleştirin](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span></span>

<span data-ttu-id="b8f9f-238">**Şekil 11**: yer `StatusLabel` denetim Yukarıdaki iki Panel denetimleri ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-cs/_static/image33.png))</span></span>


## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="b8f9f-239">3. adım: görüntü arasında geçiş yapma ve arabirimleri ekleme</span><span class="sxs-lookup"><span data-stu-id="b8f9f-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="b8f9f-240">Bu noktada biz bizim görüntüleme ve ekleme arabirimleri, ancak biz re hala iki görevlerle sol işaretleme tamamladınız:</span><span class="sxs-lookup"><span data-stu-id="b8f9f-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="b8f9f-241">Görüntü arasında geçiş yapma ve arabirimleri ekleme</span><span class="sxs-lookup"><span data-stu-id="b8f9f-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="b8f9f-242">Veritabanı sevkiyata ürünleri ekleme</span><span class="sxs-lookup"><span data-stu-id="b8f9f-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="b8f9f-243">Şu anda, görüntü arabirimdir görünür, ancak ekleme arabirimi gizlenir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="b8f9f-244">Bunun nedeni, `DisplayInterface` Masası s `Visible` özelliği ayarlanmış `true` (varsayılan değer) sırada `InsertingInterface` Masası s `Visible` özelliği ayarlanmış `false`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `true` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `false`.</span></span> <span data-ttu-id="b8f9f-245">Yalnızca ihtiyacımız her denetim s geçiş yapmak için iki arabirim arasında geçiş yapmak için `Visible` özellik değeri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="b8f9f-246">İşlem ürün sevkiyat düğmesine tıklandığında görüntü arabiriminden ekleme arabirimine taşımak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="b8f9f-247">Bu nedenle, bu düğme s'için bir olay işleyicisi oluşturun `Click` aşağıdaki kodu içeren olay:</span><span class="sxs-lookup"><span data-stu-id="b8f9f-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample4.cs)]

<span data-ttu-id="b8f9f-248">Bu kod yalnızca gizler `DisplayInterface` paneli ve gösterir `InsertingInterface` paneli.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="b8f9f-249">Ardından, olay işleyicileri ekleme arabiriminde sevkiyat ve iptal düğmesi denetimleri ekleme ürünlerinden oluşturun.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="b8f9f-250">Bu düğmeleri birini tıklandığında, görüntü arabirimi geri gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="b8f9f-251">Oluşturma `Click` her ikisi için olay işleyicileri düğmesi denetler çağrıda buldukları `ReturnToDisplayInterface`, kısa bir süre içinde eklenecektir bir yöntem.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="b8f9f-252">Gizleme yanı sıra `InsertingInterface` paneli ve gösteren `DisplayInterface` paneli, `ReturnToDisplayInterface` yöntemi gereken Web denetimleri önceden düzenleme durumlarına geri dönün.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="b8f9f-253">Bu DropDownLists ayarı içerir `SelectedIndex` 0 ve temizleme özelliklerine `Text` TextBox denetimleri özelliklerini.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="b8f9f-254">Ne gerçekleşebilir düşünün, biz etmedi t dönüş denetimleri önceden düzenleme durumlarına görüntü arabirimine döndürmeden önce.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-254">Consider what might happen if we didn t return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="b8f9f-255">Bir kullanıcı, işlem ürün sevkiyat düğmesini tıklatın, ürünleri yapılan sevkiyat girin ve ürünleri sevkiyat Ekle'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="b8f9f-256">Bu ürünleri ekleyin ve kullanıcının görünen arabirimine döndürür.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="b8f9f-257">Bu noktada kullanıcı başka bir sevkiyat eklemek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="b8f9f-258">Ekleme arabirimi ancak DropDownList döndürecektir işlem ürün sevkiyat düğme tıklatıldığında seçim ve metin değerleri hala önceki değerlerine ile doldurulması.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample5.cs)]

<span data-ttu-id="b8f9f-259">Her ikisi de `Click` olay işleyicileri yalnızca çağrısı `ReturnToDisplayInterface` yöntemi, ürün ekleme yapılan sevkiyat getireceğiz rağmen `Click` olay işleyicisini adım 4 ve ürünleri kaydetmek için kodu ekleyin.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="b8f9f-260">`ReturnToDisplayInterface` döndürerek başlatır `Suppliers` ve `Categories` DropDownLists kendi ilk seçenekleri.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="b8f9f-261">İki sabit `firstControlID` ve `lastControlID` işareti başlangıç ve bitiş ekleme içinde kutularındaki arayüzü ve sınırları içinde kullanılan ürün adı ve birim fiyat adlandırma kullanılan denetim dizin değerlerini `for` Ayarlardöngü`Text`TextBox denetimleri özelliklerini geri boş bir dize.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `for` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="b8f9f-262">Son olarak, paneller `Visible` Özellikler ekleme arabirimi gizlenmesi ve gösterilen görüntü arabirimi sıfırlanır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="b8f9f-263">Bu sayfayı bir tarayıcıda çıkışı test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="b8f9f-264">İlk sitesini ziyaret ettiğinde görüntü arabirimi Şekil 5'te gösterildiği gibi görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="b8f9f-265">İşlem ürün sevkiyat düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="b8f9f-266">Sayfaya geri gönderilir ve şimdi ekleme arabirimi Şekil 12'de gösterildiği gibi görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="b8f9f-267">Her iki eklemek ürünlerinden sevkiyat veya İptal düğmeleri tıklatarak görüntü arabirimine döndürür.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="b8f9f-268">Ekleme arabirimi görüntülerken, birim fiyat kutularındaki CompareValidators çıkışı test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="b8f9f-269">Ürün ekleme sevkiyat düğmesi geçersiz para birimi değerleri ile veya bir değer sıfırdan fiyatlarıyla tıklatıldığında uyarı istemci-tarafı messagebox görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>


<span data-ttu-id="b8f9f-270">[![İşlem ürün sevkiyat düğmesine tıkladıktan sonra ekleme arabirimi görüntülenir](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span></span>

<span data-ttu-id="b8f9f-271">**Şekil 12**: ekleme arabirimi işlem ürün sevkiyat düğmesine tıkladıktan sonra görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-cs/_static/image36.png))</span></span>


## <a name="step-4-adding-the-products"></a><span data-ttu-id="b8f9f-272">4. adım: ürün ekleme</span><span class="sxs-lookup"><span data-stu-id="b8f9f-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="b8f9f-273">Bu öğretici ürünleri ürün ekleme veritabanında sevkiyat düğmesi s'den kaydetmek için kalan tüm `Click` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="b8f9f-274">Bu oluşturarak gerçekleştirilebilir bir `ProductsDataTable` ve ekleyerek bir `ProductsRow` sağlanan ürün adlarının her biri için örneği.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="b8f9f-275">Bir kez bunlar `ProductsRow` s biz yapılan bir çağrı yapacak eklenmiştir `ProductsBLL` s sınıfı `UpdateWithTransaction` tümleştirilmesidir yöntemi `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="b8f9f-276">Sözcüğünün `UpdateWithTransaction` geri oluşturulan yöntemi [kaydırma veritabanı değişiklikleri bir işlem içinde](wrapping-database-modifications-within-a-transaction-cs.md) Öğreticisi, geçişleri `ProductsDataTable` için `ProductsTableAdapter` s `UpdateWithTransaction` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="b8f9f-277">Buradan, bir ADO.NET hareket başlatıldığından ve TableAdatper sorunları bir `INSERT` her eklenen için veritabanı deyimi `ProductsRow` DataTable tablosundaki.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-277">From there, an ADO.NET transaction is started and the TableAdatper issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="b8f9f-278">İşlem hata eklenen tüm ürünleri varsayıldığında, aksi takdirde, geri alınır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="b8f9f-279">Sevkiyat düğmesi s ürün ekleme kodunu `Click` olay işleyicisi biraz hata denetimi gerçekleştirmek de gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="b8f9f-280">Ekleme arabiriminde kullanılan hiçbir RequiredFieldValidators olduğundan, bir kullanıcı adı içermeden bir ürün için bir fiyat girebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="b8f9f-281">Ürün s adı gerektiğinden bir koşul açılan biz kullanıcıyı uyarmak ve ile ekler devam değil gerekir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="b8f9f-282">Tam `Click` olay işleyici kod izler:</span><span class="sxs-lookup"><span data-stu-id="b8f9f-282">The complete `Click` event handler code follows:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample6.cs)]

<span data-ttu-id="b8f9f-283">Olay işleyicisi, sağlayarak başlatır `Page.IsValid` özellik değeri döndürür `true`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `true`.</span></span> <span data-ttu-id="b8f9f-284">Döndürürse `false`, ardından bir anlamına CompareValidators birkaçını geçersiz veri raporlama; böyle bir durumda biz girilen Ürün eklemeye çalışırsanız istemiyorsanız veya şu özel durumla kullanıcı tarafından girilen birim fiyat atamak çalışırken elde edersiniz değerin `ProductsRow` s `UnitPrice` özelliği.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-284">If it returns `false`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="b8f9f-285">Sonraki, yeni bir `ProductsDataTable` örneği oluşturulur (`products`).</span><span class="sxs-lookup"><span data-stu-id="b8f9f-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="b8f9f-286">A `for` döngü, ürün adı ve birim fiyat kutularındaki yinelemek için kullanılır ve `Text` özelliklerini yerel değişkenler okuma `productName` ve `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-286">A `for` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="b8f9f-287">Birim Fiyat ancak karşılık gelen ürün adı için bir değer kullanıcının girdiği varsa `StatusLabel` bir birim fiyat sağlarsanız, ileti gerekir de içerir ürünün adını ve olay işleyicisi çıkıldı.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="b8f9f-288">Bir ürün adı, yeni bir belirtildiyse `ProductsRow` örneği kullanılarak oluşturulan `ProductsDataTable` s `NewProductsRow` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="b8f9f-289">Bu yeni `ProductsRow` örneği s `ProductName` özelliği için geçerli ürün ayarlanmış TextBox sırasında ad `SupplierID` ve `CategoryID` özellikleri atanır `SelectedValue` ekleme arabirimi s üstbilgisinde DropDownLists özelliklerini.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="b8f9f-290">Kullanıcı için ürün s Fiyat değeri girdiyseniz, atandığı `ProductsRow` örneği s `UnitPrice` özellik; Aksi takdirde özelliğidir sonuçlanır atanmamış, sol bir `NULL` değerini `UnitPrice` veritabanındaki.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="b8f9f-291">Son olarak, `Discontinued` ve `UnitsOnOrder` özellikler için sabit kodlanmış değerler atanır `false` ve 0, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `false` and 0, respectively.</span></span>

<span data-ttu-id="b8f9f-292">Özellikler için atandıktan sonra `ProductsRow` eklenir örneği `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="b8f9f-293">Tamamlandığında `for` döngü, biz denetleyin ürünlerden eklenip eklenmediğini.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-293">At the completion of the `for` loop, we check whether any products have been added.</span></span> <span data-ttu-id="b8f9f-294">Kullanıcı tüm ürün adlarını veya fiyatları girmeden önce sevkiyat eklemek ürünlerinden tıklattınız olabilir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="b8f9f-295">En az bir üründe olduğunda `ProductsDataTable`, `ProductsBLL` s sınıfı `UpdateWithTransaction` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="b8f9f-296">Ardından, veriler için DataSet'e `ProductsGrid` GridView böylece yeni eklenen ürünleri görüntü arabiriminde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="b8f9f-297">`StatusLabel` Bir onay iletisi görüntülenecek güncelleştirilir ve `ReturnToDisplayInterface` , arabirim ekleme ve görüntüleme arabirimi gösteren gizleme çağrılır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="b8f9f-298">Hiç ürün girilirse, ekleme arabirimi hiç ürün eklenen ileti görüntülenmeye devam eder.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="b8f9f-299">Lütfen ürün adlarını girin ve birim fiyatları kutularındaki görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="b8f9f-300">Şekil s 13, 14 ve 15 ekleme Göster ve arabirimleri eylemi görüntüler.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="b8f9f-301">Şekil 13'te kullanıcı karşılık gelen bir ürün adı olmayan bir birim fiyat değer girmiştir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="b8f9f-302">Şekil 14 görüntü arabirim üç sonra yeni Şekil 15 iki yeni eklenen ürünlerin (üçüncü bir önceki sayfada) GridView içinde gösterirken ürünler başarıyla eklendi gösterir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>


<span data-ttu-id="b8f9f-303">[![Bir ürün adı gerekli olduğunda girilmesi birim fiyat olur](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span></span>

<span data-ttu-id="b8f9f-304">**Şekil 13**: bir ürün adı olan gerekli olduğunda girerek bir birim fiyat ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-cs/_static/image39.png))</span></span>


<span data-ttu-id="b8f9f-305">[![Üç yeni Veggies tedarikçi için eklenmiştir Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span></span>

<span data-ttu-id="b8f9f-306">**Şekil 14**: üç yeni Veggies eklenmiştir tedarikçi Mayumi s ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-cs/_static/image42.png))</span></span>


<span data-ttu-id="b8f9f-307">[![Yeni ürünler GridView son sayfasında bulunabilir.](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span></span>

<span data-ttu-id="b8f9f-308">**Şekil 15**: yeni ürünler bulunabilir GridView son sayfasına ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="b8f9f-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-cs/_static/image45.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b8f9f-309">Bu öğreticide kullanılan mantık ekleme toplu işlem kapsamı içinde ekler sarmalar.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="b8f9f-310">Bunu doğrulamak için bir veritabanı düzeyi hatası var tanıtır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="b8f9f-311">Örneğin, yeni atama yerine `ProductsRow` örneği s `CategoryID` seçili değerine özellik `Categories` DropDownList, bir değere ister Ata `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="b8f9f-312">Burada `i` döngü dizin oluşturucu olup 1 ile 5 arasında değişen değerler içerir.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="b8f9f-313">Bu nedenle, ne zaman iki veya daha fazla ürün toplu işlemindeki ilk Ürün Ekle ekleme olacaktır geçerli bir `CategoryID` değeri (5), ancak sonraki ürünleri olacaktır `CategoryID` en fazla ile eşleşmiyor değerleri `CategoryID` değerler `Categories` tablo.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="b8f9f-314">Net etkisi olan sırasında ilk `INSERT` başarılı olur, sonraki olanları bir yabancı anahtar kısıtlaması ihlali ile başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="b8f9f-315">Toplu yerleştirme atomik, olduğundan ilk `INSERT` toplu eklemeden önce işlem durumu veritabanına başlangıcından döndürme geri alınacak.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>


## <a name="summary"></a><span data-ttu-id="b8f9f-316">Özet</span><span class="sxs-lookup"><span data-stu-id="b8f9f-316">Summary</span></span>

<span data-ttu-id="b8f9f-317">Bu ve önceki iki öğreticileri güncelleştirmek için silme, izin arabirimleri oluşturduk ve toplu veri ekleme, her biri için veri erişim katmanı'ndaki eklediğimiz işlem desteği kullanılan [veritabanı değişiklikleri sarmalama bir işlem içinde](wrapping-database-modifications-within-a-transaction-cs.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span></span> <span data-ttu-id="b8f9f-318">Belirli senaryolar, bu tür toplu işleme kullanıcı arabirimleri büyük ölçüde son kullanıcı verimliliğini keserek temel alınan veri bütünlüğünü de koruyarak tıklama, Geri göndermeler ve klavye ve fare içerik geçişi sayısını artırmak.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="b8f9f-319">Bu öğretici toplu verileri ile çalışma bizim göz tamamlar.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="b8f9f-320">Öğreticiler bir sonraki kümesini DAL, şifreleme bağlantı dizeleri ve daha fazla bağlantı ve komut düzeyi ayarlarını yapılandırma TableAdapter s yöntemler saklı yordamları kullanma dahil olmak üzere, Gelişmiş Veri erişim katmanı senaryoları çeşitli araştırır!</span><span class="sxs-lookup"><span data-stu-id="b8f9f-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="b8f9f-321">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="b8f9f-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b8f9f-322">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="b8f9f-322">About the Author</span></span>

<span data-ttu-id="b8f9f-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b8f9f-324">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b8f9f-325">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b8f9f-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b8f9f-326">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b8f9f-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b8f9f-327">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="b8f9f-327">Special Thanks To</span></span>

<span data-ttu-id="b8f9f-328">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-328">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b8f9f-329">Gözden geçirenler Hilton Giesenow ve S ren Jacob Lauritsen olan Bu öğretici için yol açar.</span><span class="sxs-lookup"><span data-stu-id="b8f9f-329">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="b8f9f-330">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="b8f9f-330">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b8f9f-331">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-331">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b8f9f-332">[Önceki](batch-deleting-cs.md)
> [sonraki](wrapping-database-modifications-within-a-transaction-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b8f9f-332">[Previous](batch-deleting-cs.md)
[Next](wrapping-database-modifications-within-a-transaction-vb.md)</span></span>

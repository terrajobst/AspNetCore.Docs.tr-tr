---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
title: SqlDataSource denetimi (VB) ile veri sorgulama | Microsoft Docs
author: rick-anderson
description: Önceki eğitimlerine sunu katmanı veri erişim katmanı tam olarak ayırmak için ObjectDataSource Denetimi kullanılır. Bu tutor ile başlatılıyor...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: b12f752d-3502-40a4-b695-fc7b7d08cfd3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 6f886ca85a2a4dea5daeff109370bedc1a3f7265
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876572"
---
<a name="querying-data-with-the-sqldatasource-control-vb"></a><span data-ttu-id="78b4b-104">SqlDataSource denetimi (VB) ile veri sorgulama</span><span class="sxs-lookup"><span data-stu-id="78b4b-104">Querying Data with the SqlDataSource Control (VB)</span></span>
====================
<span data-ttu-id="78b4b-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="78b4b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="78b4b-106">[Örnek uygulamayı indirin](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) veya [PDF indirin](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="78b4b-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span></span>

> <span data-ttu-id="78b4b-107">Önceki eğitimlerine sunu katmanı veri erişim katmanı tam olarak ayırmak için ObjectDataSource Denetimi kullanılır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="78b4b-108">Bu öğretici ile başlayarak, biz SqlDataSource denetimi sunu ve veri erişimi katı ayırma gerektirmeyen basit uygulamalar için nasıl kullanılacağını öğrenin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>


## <a name="introduction"></a><span data-ttu-id="78b4b-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="78b4b-109">Introduction</span></span>

<span data-ttu-id="78b4b-110">Tüm öğreticileri biz kadarki incelenmesi ve sunu, iş mantığı ve verileri erişim katmanları oluşan bir katmanlı mimarisi kullanmış.</span><span class="sxs-lookup"><span data-stu-id="78b4b-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="78b4b-111">Veri erişim düzeyi (DAL) ilk öğreticide hazırlanmış ([veri erişim katmanı oluşturma](../introduction/creating-a-data-access-layer-vb.md)) ve iş mantığı katmanı ikinci ([bir iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md)).</span><span class="sxs-lookup"><span data-stu-id="78b4b-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md)).</span></span> <span data-ttu-id="78b4b-112">İle başlayarak [veri ObjectDataSource ile görüntüleme](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) Öğreticisi, ASP.NET 2.0 s yeni ObjectDataSource Denetimi sunu katmanı mimarisinden ile bildirimli olarak arabirim için nasıl kullanılacağını gördük.</span><span class="sxs-lookup"><span data-stu-id="78b4b-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="78b4b-113">Mimari öğreticileri kadarki tüm verilerle çalışmak için kullanılan olsa da, aynı zamanda erişim, Ekle, Güncelleştir ve mimarisi atlayarak doğrudan bir ASP.NET sayfasından, veritabanı verilerini silmek mümkündür.</span><span class="sxs-lookup"><span data-stu-id="78b4b-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="78b4b-114">Bunun yapılması belirli bir veritabanını sorgular ve iş mantığı doğrudan web sayfasındaki yerleştirir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="78b4b-115">Yeterince büyük veya karmaşık uygulamalar için katmanlı bir mimari kullanarak tasarlama ve uygulama oldukça başarı, Güncelleştirilebilirlik ve uygulama bakımı için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="78b4b-116">Sağlam bir mimari geliştirme, ancak verebilmesine basit, tek seferlik uygulamaları oluştururken gereksiz olabilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="78b4b-117">ASP.NET 2.0 sağlar beş yerleşik veri kaynağı denetimleri [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), ve [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="78b4b-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="78b4b-118">SqlDataSource erişme ve Microsoft SQL Server, Microsoft Access, Oracle, MySQL ve diğerleri de dahil olmak üzere doğrudan bir ilişkisel veritabanı, verileri değiştirmek için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="78b4b-119">Bu öğretici ve sonraki üç, biz SqlDataSource denetimi ile çalışmak üzere, SqlDataSource kullanma yanı sıra sorgulama ve filtre veritabanı veri araştırma, ekleme, güncelleştirme ve verileri silme inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="78b4b-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>


![ASP.NET 2.0 beş yerleşik veri kaynağı denetimleri içerir](querying-data-with-the-sqldatasource-control-vb/_static/image1.gif)

<span data-ttu-id="78b4b-121">**Şekil 1**: ASP.NET 2.0, beş yerleşik veri kaynağı denetimleri içerir</span><span class="sxs-lookup"><span data-stu-id="78b4b-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>


## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="78b4b-122">ObjectDataSource ve SqlDataSource karşılaştırma</span><span class="sxs-lookup"><span data-stu-id="78b4b-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="78b4b-123">Kavramsal olarak, ObjectDataSource ve SqlDataSource denetimleri yalnızca proxy'leri verilere bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="78b4b-124">' Da anlatıldığı gibi [veri ObjectDataSource ile görüntüleme](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) öğretici, ObjectDataSource sahip veri ve seçmek için çağrılacak yöntemleri eklemek, güncelleştirme ve verileri silme sağlayan nesne türü belirtmek özellikleri temel alınan nesnenin türü.</span><span class="sxs-lookup"><span data-stu-id="78b4b-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="78b4b-125">ObjectDataSource özelliklerinde yapılandırdıktan sonra bir veri GridView, DetailsView veya DataList gibi Web denetimi ObjectDataSource s kullanarak denetimine bağlı olabilir `Select()`, `Insert()`, `Delete()`, ve `Update()` yöntemleri temel alınan mimarisinde ile etkileşim.</span><span class="sxs-lookup"><span data-stu-id="78b4b-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="78b4b-126">SqlDataSource aynı işlevselliği sunar, ancak Nesne Kitaplığı yerine ilişkisel bir veritabanına karşı çalışır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="78b4b-127">SqlDataSource ile veritabanı bağlantı dizesi ve geçici SQL sorguları belirtmeniz gerekir veya saklı yordamları ekleme, güncelleştirme, silme ve verileri almak için çalıştırılacak.</span><span class="sxs-lookup"><span data-stu-id="78b4b-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="78b4b-128">SqlDataSource s `Select()`, `Insert()`, `Update()`, ve `Delete()` çağrıldığında, yöntem, belirtilen veritabanına bağlanmak ve uygun SQL sorgusu yayınlanacak.</span><span class="sxs-lookup"><span data-stu-id="78b4b-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="78b4b-129">Aşağıdaki diyagramda gösterildiği gibi bu yöntemleri bir veritabanına bağlanma, bir sorgu verme ve sonuçları döndüren grunt çalışma yapın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>


![SqlDataSource veritabanı için bir Proxy olarak görev yapar](querying-data-with-the-sqldatasource-control-vb/_static/image2.gif)

<span data-ttu-id="78b4b-131">**Şekil 2**: SqlDataSource veritabanı için bir Proxy olarak görev yapar</span><span class="sxs-lookup"><span data-stu-id="78b4b-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>


> [!NOTE]
> <span data-ttu-id="78b4b-132">Bu öğreticide biz veritabanından veri alınırken odak.</span><span class="sxs-lookup"><span data-stu-id="78b4b-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="78b4b-133">İçinde [ekleme, güncelleştirme ve SqlDataSource denetimi silinirken verilerle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) Öğreticisi, biz SqlDataSource ekleme, güncelleştirme ve silme destekleyecek şekilde yapılandırmak nasıl göreceksiniz.</span><span class="sxs-lookup"><span data-stu-id="78b4b-133">In the [Inserting, Updating, and Deleteing Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>


## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="78b4b-134">SqlDataSource ve AccessDataSource denetimleri</span><span class="sxs-lookup"><span data-stu-id="78b4b-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="78b4b-135">SqlDataSource denetimi ek olarak, ASP.NET 2.0 bir AccessDataSource denetimi de içerir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="78b4b-136">Bu iki farklı denetim çoğu geliştiricinin ASP.NET 2.0 AccessDataSource denetimi yalnızca Microsoft SQL Server ile birlikte çalışmak üzere tasarlanmış SqlDataSource denetimi yalnızca Microsoft Access ile çalışmak üzere tasarlanmıştır şüpheleniyorsanız yeni yol açar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="78b4b-137">AccessDataSource özellikle Microsoft Access ile çalışmak için tasarlanmış olsa da, SqlDataSource denetimi ile çalışır *herhangi* .NET erişilebilen ilişkisel veritabanı.</span><span class="sxs-lookup"><span data-stu-id="78b4b-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="78b4b-138">Bu, tüm OleDb veya ODBC uyumlu veri depoları, Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL ve PostgreSQL, gibi diğer birçok arasında içerir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="78b4b-139">AccessDataSource ve SqlDataSource denetimleri arasındaki tek fark, veritabanı bağlantı bilgilerini nasıl belirtildiğinden ' dir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="78b4b-140">AccessDataSource denetimi yalnızca Access veritabanı dosyasının dosya yolu gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="78b4b-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="78b4b-141">SqlDataSource Öte yandan, bir tam bağlantı dizesi gerektirir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="78b4b-142">1. adım: SqlDataSource Web sayfaları oluşturma</span><span class="sxs-lookup"><span data-stu-id="78b4b-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="78b4b-143">SqlDataSource denetimi kullanarak doğrudan veritabanını verilerle çalışmak nasıl keşfetme başlamadan önce öncelikle Bu öğretici ve sonraki üç yapmamız gereken Web sitesi Projemizin ASP.NET sayfaları oluşturmak için bir dakikanızı ayırın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="78b4b-144">Adlı yeni bir klasör eklemeye başlayın `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="78b4b-145">Ardından, o klasördeki her sayfayla ilişkilendirilecek emin olmak için aşağıdaki ASP.NET sayfaları ekleme `Site.master` ana sayfa:</span><span class="sxs-lookup"><span data-stu-id="78b4b-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`


![ASP.NET sayfaları için SqlDataSource ile ilgili öğreticiler ekleme](querying-data-with-the-sqldatasource-control-vb/_static/image3.gif)

<span data-ttu-id="78b4b-147">**Şekil 3**: SqlDataSource ilgili öğreticileri için ASP.NET sayfaları ekleme</span><span class="sxs-lookup"><span data-stu-id="78b4b-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>


<span data-ttu-id="78b4b-148">Diğer klasörler gibi `Default.aspx` içinde `SqlDataSource` klasörü öğreticileri kendi bölümünde listeler.</span><span class="sxs-lookup"><span data-stu-id="78b4b-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="78b4b-149">Sözcüğünün `SectionLevelTutorialListing.ascx` kullanıcı denetimi bu işlevselliği sağlar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="78b4b-150">Bu nedenle, bu kullanıcı denetimi Ekle `Default.aspx` s Tasarım görünümü sayfaya Çözüm Gezgini'nden sürükleyerek.</span><span class="sxs-lookup"><span data-stu-id="78b4b-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="78b4b-151">[![İçin Default.aspx SectionLevelTutorialListing.ascx kullanıcı denetimi Ekle](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="78b4b-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span></span>

<span data-ttu-id="78b4b-152">**Şekil 4**: eklemek `SectionLevelTutorialListing.ascx` kullanıcı denetimine `Default.aspx` ([tam boyutlu görüntüyü görüntülemek için tıklatın](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="78b4b-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span></span>


<span data-ttu-id="78b4b-153">Son olarak, bu dört sayfaları girişlere ekleyin `Web.sitemap` dosya.</span><span class="sxs-lookup"><span data-stu-id="78b4b-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="78b4b-154">Özellikle, aşağıdaki biçimlendirme sonra ekleme özel düğmeler DataList yineleyici ekleyin ve `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="78b4b-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample1.sql)]

<span data-ttu-id="78b4b-155">Güncelleştirdikten sonra `Web.sitemap`, bir tarayıcı aracılığıyla öğreticileri Web sitesini görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="78b4b-156">Soldaki menüde artık düzenleme, ekleme ve öğreticiler silmek için öğeler içerir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![Site Haritasını girişleri SqlDataSource öğreticileri için şimdi içerir.](querying-data-with-the-sqldatasource-control-vb/_static/image7.gif)

<span data-ttu-id="78b4b-158">**Şekil 5**: Site Haritası girişleri SqlDataSource öğreticileri için şimdi içerir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>


## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="78b4b-159">2. adım: Ekleme ve SqlDataSource denetimi yapılandırma</span><span class="sxs-lookup"><span data-stu-id="78b4b-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="78b4b-160">Başlangıç açarak `Querying.aspx` sayfasındaki `SqlDataSource` klasörü ve Tasarım görünümüne geçin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="78b4b-161">Araç kutusu Tasarımcısı ve kümesi üzerine SqlDataSource denetimini sürükleyin kendi `ID` için `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="78b4b-162">ObjectDataSource olduğu gibi SqlDataSource işlenmiş herhangi bir çıktı üretmez ve bu nedenle tasarım yüzeyine gri kutu olarak görünür.</span><span class="sxs-lookup"><span data-stu-id="78b4b-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="78b4b-163">SqlDataSource yapılandırmak için SqlDataSource s akıllı etiket yapılandırma veri kaynağı bağlantısını tıklayın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>


![Tıklayın SqlDataSource s akıllı etiket veri kaynağı bağlantısını yapılandırın](querying-data-with-the-sqldatasource-control-vb/_static/image8.gif)

<span data-ttu-id="78b4b-165">**Şekil 6**: tıklayın SqlDataSource s akıllı etiket veri kaynağı bağlantısını yapılandırın</span><span class="sxs-lookup"><span data-stu-id="78b4b-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>


<span data-ttu-id="78b4b-166">Bu SqlDataSource denetim s veri kaynağı Yapılandırma Sihirbazı'nı getirir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="78b4b-167">ObjectDataSource Denetimi s Sihirbazı s adımları farklılık gösterir, ancak son hedef almak, Ekle, Güncelleştir ve veri kaynağı üzerinden verileri silmek nasıl ayrıntılarını sağlamak için aynıdır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="78b4b-168">SqlDataSource için bu, temel alınan veritabanının kullanılacağını belirtme ve saklı yordamları veya geçici SQL deyimleri sağlayarak kapsar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="78b4b-169">İlk sihirbaz adımı bize veritabanı için ister.</span><span class="sxs-lookup"><span data-stu-id="78b4b-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="78b4b-170">Bu veritabanı web uygulaması s bulunamadı aşağı açılan listeyi içeren `App_Data` klasörü ve Sunucu Gezgininde veri bağlantıları için eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="78b4b-171">Bu yana ullanıcı zaten bir bağlantı dizesi eklediğimiz `NORTHWIND.MDF` veritabanını `App_Data` Projemizin s klasörüne `Web.config` dosyası, açılan listesinden, bu bağlantı dizesi için bir başvuru içerir `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="78b4b-172">Bu öğeyi aşağı açılan listeden seçin ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-172">Choose this item from the drop-down list and click Next.</span></span>


![NORTHWINDConnectionString aşağı açılan listeden seçin](querying-data-with-the-sqldatasource-control-vb/_static/image9.gif)

<span data-ttu-id="78b4b-174">**Şekil 7**: seçin `NORTHWINDConnectionString` aşağı açılan listeden</span><span class="sxs-lookup"><span data-stu-id="78b4b-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>


<span data-ttu-id="78b4b-175">Veritabanını seçtikten sonra sihirbaz sorgu verileri döndürmek sorar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="78b4b-176">Şu tablo veya Görünüm dönün veya özel bir SQL deyimi girebilir veya saklı yordam belirtmek için sütunlarının ya da belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="78b4b-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="78b4b-177">Bu seçeneği belirtin aracılığıyla arasında özel bir SQL deyimi veya saklı yordam ve bir tablo belirtin sütunlarından geçiş veya radyo düğmeleri görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="78b4b-178">Bu ilk Örneğin, bir tablo veya görünüm seçeneği belirtin sütunlarından kullanmak s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="78b4b-179">Biz, daha sonra Bu öğreticide sihirbaza geri dönün ve özel bir SQL deyimi veya saklı yordam seçeneği belirtin keşfedin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>


<span data-ttu-id="78b4b-180">Bir tablo veya Görünüm radyo düğmesi belirt sütunlarından seçildiğinde Şekil 8 yapılandırma Select deyimi ekran gösterir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="78b4b-181">Aşağı açılan liste tabloları ve görünümleri Northwind veritabanındaki seçili tabloyu veya görünümü s sütunları onay kutusu listesinde görüntülenen kümesini içerir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="78b4b-182">Bu örnekte, let s dönmek `ProductID`, `ProductName`, ve `UnitPrice` sütunlarından `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="78b4b-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="78b4b-183">Sihirbazın bu seçim yapmadan elde edilen SQL deyimini gösterir sonra Şekil 8 gösterildiği gibi `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>


![Veri ürünleri bir tablo döndürür](querying-data-with-the-sqldatasource-control-vb/_static/image10.gif)

<span data-ttu-id="78b4b-185">**Şekil 8**: dönüş verileri `Products` tablosu</span><span class="sxs-lookup"><span data-stu-id="78b4b-185">**Figure 8**: Return Data from the `Products` Table</span></span>


<span data-ttu-id="78b4b-186">Döndürülecek Sihirbazı'nı yapılandırdıktan sonra `ProductID`, `ProductName`, ve `UnitPrice` sütunlarından `Products` tablo, İleri düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="78b4b-187">Bu son ekran önceki adımda yapılandırılmış sorgu sonuçlarını İnceleme fırsatı sağlar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="78b4b-188">Test Query düğmesini tıklatarak yürütür yapılandırılmış `SELECT` deyimi ve kılavuzda sonuçları görüntüler.</span><span class="sxs-lookup"><span data-stu-id="78b4b-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>


![SEÇME sorgusu gözden geçirmek için Test sorgu düğmesini tıklatın](querying-data-with-the-sqldatasource-control-vb/_static/image11.gif)

<span data-ttu-id="78b4b-190">**Şekil 9**: gözden geçirme Test sorgu düğmesine tıklayın, `SELECT` sorgu</span><span class="sxs-lookup"><span data-stu-id="78b4b-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>


<span data-ttu-id="78b4b-191">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="78b4b-192">ObjectDataSource ile SqlDataSource s Sihirbazı'nı yalnızca değerleri denetim s, yani özelliklerine gibi [ `ConnectionString` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) ve [ `SelectCommand` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) özellikleri.</span><span class="sxs-lookup"><span data-stu-id="78b4b-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="78b4b-193">Sihirbazı tamamladıktan sonra SqlDataSource denetimi s bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="78b4b-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample2.aspx)]

<span data-ttu-id="78b4b-194">`ConnectionString` Özelliği veritabanına bağlanma hakkında bilgi sağlar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="78b4b-195">Bu özellik bir tam, sabit kodlanmış bağlantı dizesi değer atanabilir veya bir bağlantı dizesinde işaret edebilir `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="78b4b-196">Web.config bağlantı dizesi değerindeki başvurmak için söz dizimini kullanın `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="78b4b-197">Genellikle, *expressionPrefix* ConnectionStrings olduğu ve *expressionValue* bağlantı dizesinde adıdır `Web.config` [ `<connectionStrings>` bölüm](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="78b4b-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="78b4b-198">Ancak, sözdizimi kullanılabilir başvuru `<appSettings>` öğeleri veya içerik kaynak dosyalarından.</span><span class="sxs-lookup"><span data-stu-id="78b4b-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="78b4b-199">Bkz: [ASP.NET ifadeleri genel bakış](https://msdn.microsoft.com/library/d5bd1tad.aspx) Bu sözdizimi hakkında daha fazla bilgi için.</span><span class="sxs-lookup"><span data-stu-id="78b4b-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="78b4b-200">`SelectCommand` Özelliği, geçici SQL deyimi veya verileri döndürmek için saklı yordam belirtir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="78b4b-201">3. adım: veri Web denetim ekleme ve SqlDataSource bağlama</span><span class="sxs-lookup"><span data-stu-id="78b4b-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="78b4b-202">SqlDataSource yapılandırıldıktan sonra bir veri GridView veya DetailsView gibi Web denetimi bağlanabilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="78b4b-203">Bu öğreticide, verileri bir GridView görüntülemek s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="78b4b-204">Araç Kutusu'ndan GridView sayfaya sürükleyin ve onu bağladıktan `ProductsDataSource` GridView s akıllı etiket aşağı açılan listeden veri kaynağını seçerek SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="78b4b-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>


<span data-ttu-id="78b4b-205">[![GridView ekleyin ve SqlDataSource denetimine bağlama](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="78b4b-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span></span>

<span data-ttu-id="78b4b-206">**Şekil 10**: GridView ekleyin ve SqlDataSource denetimi bağlamak ([tam boyutlu görüntüyü görüntülemek için tıklatın](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="78b4b-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span></span>


<span data-ttu-id="78b4b-207">GridView s akıllı etiket aşağı açılan listeden SqlDataSource denetimi önceden seçildikten sonra Visual Studio otomatik olarak bir BoundField veya CheckBoxField GridView için veri kaynağı denetimi tarafından döndürülen sütunların her biri için ekler.</span><span class="sxs-lookup"><span data-stu-id="78b4b-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="78b4b-208">SqlDataSource üç veritabanı sütunları döndürdüğünden `ProductID`, `ProductName`, ve `UnitPrice` GridView üç alan vardır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="78b4b-209">GridView s üç yapılandırmak için bir dakikanızı ayırın BoundFields.</span><span class="sxs-lookup"><span data-stu-id="78b4b-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="78b4b-210">Değişiklik `ProductName` alan s `HeaderText` Product Name özelliğine ve `UnitPrice` fiyat alan s.</span><span class="sxs-lookup"><span data-stu-id="78b4b-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="78b4b-211">Ayrıca biçimlendirmek `UnitPrice` bir para birimi olarak alan.</span><span class="sxs-lookup"><span data-stu-id="78b4b-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="78b4b-212">Bu değişiklikleri yaptıktan sonra GridView s bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="78b4b-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample3.aspx)]

<span data-ttu-id="78b4b-213">Bir tarayıcı aracılığıyla bu sayfasını ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-213">Visit this page through a browser.</span></span> <span data-ttu-id="78b4b-214">Şekil 11 gösterildiği gibi her ürünün s GridView listeler `ProductID`, `ProductName`, ve `UnitPrice` değerleri.</span><span class="sxs-lookup"><span data-stu-id="78b4b-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>


<span data-ttu-id="78b4b-215">[![GridView, her ürün s ProductID, ProductName ve UnitPrice değerleri görüntüler](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="78b4b-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span></span>

<span data-ttu-id="78b4b-216">**Şekil 11**: GridView görüntüler her ürün s `ProductID`, `ProductName`, ve `UnitPrice` değerleri ([tam boyutlu görüntüyü görüntülemek için tıklatın](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="78b4b-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span></span>


<span data-ttu-id="78b4b-217">Sayfasını ziyaret kendi veri kaynağı denetimi s GridView çağırır `Select()` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="78b4b-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="78b4b-218">ObjectDataSource Denetimi kullanmakta olduğunuz olduğunda bu çağrılır `ProductsBLL` s sınıfı `GetProducts()` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="78b4b-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="78b4b-219">SqlDataSource, ancak ile `Select()` yöntemi belirtilen veritabanı ve sorunları için bir bağlantı kurar `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, bu örnekte).</span><span class="sxs-lookup"><span data-stu-id="78b4b-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="78b4b-220">SqlDataSource GridView ardından, döndürülen her veritabanı kaydı için GridView, bir satır oluşturmayı numaralandırır sonuçlarını döndürür.</span><span class="sxs-lookup"><span data-stu-id="78b4b-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="78b4b-221">Yerleşik veri Web denetimi özellikleri ve SqlDataSource denetimi</span><span class="sxs-lookup"><span data-stu-id="78b4b-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="78b4b-222">Genel olarak, Web denetimleri disk belleği, sıralama, düzenleme, verileri devralınmış özellikler silme, ekleme ve benzeri veri Web denetimine özeldir ve kullanılan veri kaynağı denetimi bağımlı değildir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="78b4b-223">Diğer bir deyişle, GridView, disk belleği, sıralama, düzenleme ve bir ObjectDataSource veya bir SqlDataSource bağlı olup olmadığını silme yerleşik kullanabilirler.</span><span class="sxs-lookup"><span data-stu-id="78b4b-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="78b4b-224">Ancak, belirli veri Web denetimi özellikleri kullanılan veri kaynağı denetimi veya veri kaynağı denetim s yapılandırması duyarlıdır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="78b4b-225">Örneğin, [verimli bir şekilde disk belleği üzerinden büyük miktarlarda veri](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) ele nasıl, varsayılan olarak, Web veriler için disk belleği mantığı naively döndürür denetimleri öğretici *tüm* temeldeki kayıtları veri kaynağı ve yalnızca uygun kayıtların alt kümesini verilen geçerli sayfa dizini ve sayfa başına görüntülenecek kayıt sayısını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="78b4b-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="78b4b-226">Bu model, yeterli büyüklükte sonuç kümeleri sayfalama yüksek oranda verimli değildir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="78b4b-227">Neyse ki, ObjectDataSource görüntülenecek kayıt yalnızca kesin kısmı döndürür özel sayfalama destekleyecek şekilde yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="78b4b-228">SqlDataSource denetimi ancak, özel sayfalama uygulamak için özellikler eksik.</span><span class="sxs-lookup"><span data-stu-id="78b4b-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="78b4b-229">Disk belleği ve sıralama ile başka bir subtlety SqlDataSource ile ortaya çıkar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="78b4b-230">Varsayılan olarak, SqlDataSource döndürülen verilerin disk belleği veya GridView sıralanır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="78b4b-231">Bunu göstermek için GridView s akıllı etiket etkinleştirmek disk belleği ve etkinleştirme sıralama seçeneklerinde denetleyin `Querying.aspx` ve beklendiği gibi çalıştığını doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="78b4b-232">SqlDataSource geniş yazılmış bir veri kümesine ilişkin Veritabanı verilerinin getireceğinden sıralama ve disk belleği çalışır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="78b4b-233">Toplam disk belleği uygulama için temel bir yönü sorgu tarafından döndürülen kayıt sayısı kümesinden saptanabilen.</span><span class="sxs-lookup"><span data-stu-id="78b4b-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="78b4b-234">Ayrıca, veri kümesi s sonuçları DataView ile sıralanabilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="78b4b-235">GridView istekleri disk belleğine alınan ya da veri sıralanmış olduğunda bu özellikler otomatik olarak SqlDataSource tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="78b4b-236">SqlDataSource değiştirerek DataReader bir veri kümesi yerine döndürülecek yapılandırılabilir kendi [ `DataSourceMode` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) gelen `DataSet` (varsayılan) için `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="78b4b-237">DataReader kullanarak durumlarda SqlDataSource s sonuçları DataReader beklediği var olan kodu geçirilirken tercih edilen.</span><span class="sxs-lookup"><span data-stu-id="78b4b-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="78b4b-238">Ayrıca, DataReader veri kümeleri daha önemli ölçüde daha basit nesne olduğundan, daha iyi performans sunar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="78b4b-239">Bu değişiklik yaparsanız, ancak veri Web denetimi, sıralayabilirsiniz veya SqlDataSource kaç kayıtları sorgu tarafından döndürülen onaylaması veya DataReader olmadığından bu yana sayfa döndürülen verileri sıralamak için tüm teknikler sunar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="78b4b-240">4. adım: özel SQL deyimi kullanarak veya saklı yordam</span><span class="sxs-lookup"><span data-stu-id="78b4b-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="78b4b-241">SqlDataSource denetimi yapılandırırken, veri döndürmek için kullanılan sorgu iki yaklaşım birinde özel bir SQL deyimi veya saklı yordam veya varolan bir tablo veya Görünüm sütunlarından olarak belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="78b4b-242">Biz incelenmesi 2. adımda sütunlarından seçerek `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="78b4b-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="78b4b-243">Özel bir SQL deyimi kullanarak ara s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="78b4b-244">Başka bir GridView denetimine ekleme `Querying.aspx` sayfasında ve akıllı etiket aşağı açılan listeden yeni bir veri kaynağı oluşturmak için seçin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="78b4b-245">Ardından, belirtmek verileri veritabanından bu çekebilir, yeni bir SqlDataSource denetim oluşturur.</span><span class="sxs-lookup"><span data-stu-id="78b4b-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="78b4b-246">Denetim adı `ProductsWithCategoryInfoDataSource`.</span><span class="sxs-lookup"><span data-stu-id="78b4b-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>


![ProductsWithCategoryInfoDataSource adlı yeni bir SqlDataSource denetimi oluşturma](querying-data-with-the-sqldatasource-control-vb/_static/image18.gif)

<span data-ttu-id="78b4b-248">**Şekil 12**: adlı yeni bir SqlDataSource denetimi oluşturma `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="78b4b-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>


<span data-ttu-id="78b4b-249">Sonraki ekranda bize veritabanını belirtmek için sorar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="78b4b-250">Şekil 7'de yaptığımız gibi seçin `NORTHWINDConnectionString` açılan dan listesinde ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="78b4b-251">Select deyimi ekran yapılandırma, belirt özel bir SQL deyimi veya saklı yordam radyo düğmesini seçin ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="78b4b-252">Bu seçim, güncelleştirme, ekleme ve silme etiketli sekmeleri sağlayan özel deyimleri tanımlayın veya saklı yordamlar ekranını, getirir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="78b4b-253">Her bir sekmede özel bir SQL deyimi aşağıdaki metin kutusuna girin ya da aşağı açılan listeden bir saklı yordam seçin.</span><span class="sxs-lookup"><span data-stu-id="78b4b-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="78b4b-254">Bu öğreticide özel bir SQL deyimi girme adresindeki arar; sonraki öğretici bir saklı yordam kullanan bir örnek içerir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>


![Özel SQL deyimi girin ya da bir saklı yordam seçin](querying-data-with-the-sqldatasource-control-vb/_static/image19.gif)

<span data-ttu-id="78b4b-256">**Şekil 13**: özel SQL deyimi girin ya da bir saklı yordam seçin</span><span class="sxs-lookup"><span data-stu-id="78b4b-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>


<span data-ttu-id="78b4b-257">Özel bir SQL deyimi aşağıdaki metin kutusuna elle girilebilir veya Sorgu Oluşturucusu düğmesine tıklayarak grafik oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="78b4b-258">Sorgu Oluşturucusu'nu veya metin kutusu altından döndürmek için aşağıdaki sorguyu kullanın `ProductID` ve `ProductName` alanlarını `Products` kullanarak tablo bir `JOIN` s ürün almak için `CategoryName` gelen `Categories` tablosu:</span><span class="sxs-lookup"><span data-stu-id="78b4b-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample4.sql)]


![Grafik sorgu kullanarak Sorgu Oluşturucusu oluşturabileceğiniz](querying-data-with-the-sqldatasource-control-vb/_static/image20.gif)

<span data-ttu-id="78b4b-260">**Şekil 14**: Sorgu Oluşturucusu'nu kullanarak sorgu grafik oluşturmak için</span><span class="sxs-lookup"><span data-stu-id="78b4b-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>


<span data-ttu-id="78b4b-261">Sorgu belirttikten sonra Test sorgusu ekranına devam etmek için İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="78b4b-262">SqlDataSource Sihirbazı'nı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="78b4b-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="78b4b-263">Sihirbazı tamamladıktan sonra GridView üç BoundFields görüntüleme kendisine eklenmiş olacaktır `ProductID`, `ProductName`, ve `CategoryName` sorgudan döndürülen ve aşağıdaki bildirim temelli biçimlendirmede kaynaklanan sütunlar:</span><span class="sxs-lookup"><span data-stu-id="78b4b-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample5.aspx)]


<span data-ttu-id="78b4b-264">[![Her ürün s Kimliğini, adını ve ilişkili kategori adı GridView gösterir](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="78b4b-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span></span>

<span data-ttu-id="78b4b-265">**Şekil 15**: GridView gösterir her ürün s kimliği, ad ve ilişkili kategori adı ([tam boyutlu görüntüyü görüntülemek için tıklatın](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="78b4b-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span></span>


## <a name="summary"></a><span data-ttu-id="78b4b-266">Özet</span><span class="sxs-lookup"><span data-stu-id="78b4b-266">Summary</span></span>

<span data-ttu-id="78b4b-267">Bu öğreticide sorgulamak ve SqlDataSource denetimi kullanarak verileri görüntülemek nasıl gördük.</span><span class="sxs-lookup"><span data-stu-id="78b4b-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="78b4b-268">ObjectDataSource gibi SqlDataSource verilere erişmek için bildirim temelli bir yaklaşım sağlayan bir proxy olarak görev yapar.</span><span class="sxs-lookup"><span data-stu-id="78b4b-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="78b4b-269">Bağlanmak için veritabanı ve SQL özelliklerini belirtin `SELECT` yürütülecek sorgu; Özellikler penceresini aracılığıyla veya veri kaynağı Yapılandırma Sihirbazı kullanılarak belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="78b4b-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="78b4b-270">`SELECT` Biz Bu öğreticide incelenmesi sorgu örnekler tüm kayıtlar belirtilen sorgudan döndürülen.</span><span class="sxs-lookup"><span data-stu-id="78b4b-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="78b4b-271">SqlDataSource denetimi ancak içerebilir bir `WHERE` değerleri programlı olarak atanmış veya otomatik olarak belirtilen bir kaynaktan çekilen parametreleriyle yan tümcesi.</span><span class="sxs-lookup"><span data-stu-id="78b4b-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="78b4b-272">Oluşturma ve sonraki öğreticide parametreli sorgular kullanmak inceleyeceğiz!</span><span class="sxs-lookup"><span data-stu-id="78b4b-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="78b4b-273">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="78b4b-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="78b4b-274">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="78b4b-274">Further Reading</span></span>

<span data-ttu-id="78b4b-275">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="78b4b-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="78b4b-276">İlişkisel veritabanı verilerine erişme</span><span class="sxs-lookup"><span data-stu-id="78b4b-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="78b4b-277">SqlDataSource denetimine genel bakış</span><span class="sxs-lookup"><span data-stu-id="78b4b-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="78b4b-278">ASP.NET Quickstart öğreticiler: SqlDataSource denetimi</span><span class="sxs-lookup"><span data-stu-id="78b4b-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="78b4b-279">Web.config `<connectionStrings>` öğesi</span><span class="sxs-lookup"><span data-stu-id="78b4b-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="78b4b-280">Veritabanı bağlantı dizesi başvurusu</span><span class="sxs-lookup"><span data-stu-id="78b4b-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="78b4b-281">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="78b4b-281">About the Author</span></span>

<span data-ttu-id="78b4b-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="78b4b-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="78b4b-283">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="78b4b-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="78b4b-284">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="78b4b-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="78b4b-285">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="78b4b-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="78b4b-286">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="78b4b-286">Special Thanks To</span></span>

<span data-ttu-id="78b4b-287">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="78b4b-287">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="78b4b-288">Bu öğretici için sağlama gözden geçirenler Çiğdem Connery, Bernadette Leigh ve David Suru yoktu.</span><span class="sxs-lookup"><span data-stu-id="78b4b-288">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="78b4b-289">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="78b4b-289">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="78b4b-290">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="78b4b-290">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="78b4b-291">[Önceki](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
> [sonraki](using-parameterized-queries-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="78b4b-291">[Previous](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Next](using-parameterized-queries-with-the-sqldatasource-vb.md)</span></span>

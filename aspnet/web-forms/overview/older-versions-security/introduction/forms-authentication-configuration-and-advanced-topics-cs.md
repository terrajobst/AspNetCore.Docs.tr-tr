---
uid: web-forms/overview/older-versions-security/introduction/forms-authentication-configuration-and-advanced-topics-cs
title: "Forms kimlik doğrulaması yapılandırması ve Gelişmiş konular (C#) | Microsoft Docs"
author: rick-anderson
description: "Bu öğreticide biz çeşitli forms kimlik doğrulaması ayarlarını incelemek ve form öğesi aracılığıyla değiştirme konusuna bakın. Bu bir ayrıntılı oluşturulmasını gerektirir..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/14/2008
ms.topic: article
ms.assetid: b9c29865-a34e-48bb-92c0-c443a72cb860
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/introduction/forms-authentication-configuration-and-advanced-topics-cs
msc.type: authoredcontent
ms.openlocfilehash: c57722965b510ac4f5cf0c06c7c01c8cea26384f
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2018
---
<a name="forms-authentication-configuration-and-advanced-topics-c"></a><span data-ttu-id="00d7b-104">Forms kimlik doğrulaması yapılandırması ve Gelişmiş konular (C#)</span><span class="sxs-lookup"><span data-stu-id="00d7b-104">Forms Authentication Configuration and Advanced Topics (C#)</span></span>
====================
<span data-ttu-id="00d7b-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="00d7b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="00d7b-106">[Kodu indirme](http://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/ASPNET_Security_Tutorial_03_CS.zip) veya [PDF indirin](http://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/aspnet_tutorial03_AuthAdvanced_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="00d7b-106">[Download Code](http://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/ASPNET_Security_Tutorial_03_CS.zip) or [Download PDF](http://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/aspnet_tutorial03_AuthAdvanced_cs.pdf)</span></span>

> <span data-ttu-id="00d7b-107">Bu öğreticide biz çeşitli forms kimlik doğrulaması ayarlarını incelemek ve form öğesi aracılığıyla değiştirme konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-107">In this tutorial we will examine the various forms authentication settings and see how to modify them through the forms element.</span></span> <span data-ttu-id="00d7b-108">Forms kimlik doğrulaması bileti 's zaman aşımı değeri, bir oturum açma sayfası kullanarak özel bir URL (örneğin, SignIn.aspx Login.aspx yerine) ve cookieless form kimlik doğrulama biletlerini özelleştirme ayrıntılı bir bakış bu oluşturulmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-108">This will entail a detailed look at customizing the forms authentication ticket's timeout value, using a login page with a custom URL (like SignIn.aspx instead of Login.aspx), and cookieless forms authentication tickets.</span></span>


## <a name="introduction"></a><span data-ttu-id="00d7b-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="00d7b-109">Introduction</span></span>

<span data-ttu-id="00d7b-110">İçinde [önceki öğretici](an-overview-of-forms-authentication-cs.md) bir günlük görüntüleme için sayfasında farklı oluşturmak için Web.config dosyasında yapılandırma ayarlarını belirtme gelen bir ASP.NET uygulamasında form kimlik doğrulaması gerçekleştirmek için gerekli adımları inceledik İçerik kimliği doğrulanmış ve anonim kullanıcılar için.</span><span class="sxs-lookup"><span data-stu-id="00d7b-110">In the [previous tutorial](an-overview-of-forms-authentication-cs.md) we looked at the steps necessary for implementing forms authentication in an ASP.NET application, from specifying configuration settings in Web.config to creating a log in page to displaying different content for authenticated and anonymous users.</span></span> <span data-ttu-id="00d7b-111">Web sitesi modu özniteliğini ayarlayarak forms kimlik doğrulaması kullanacak şekilde yapılandırılmış olduğunu geri çağırma &lt;kimlik doğrulaması&gt; formlara öğesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-111">Recall that we configured the website to use forms authentication by setting the mode attribute of the &lt;authentication&gt; element to Forms.</span></span> <span data-ttu-id="00d7b-112">&lt;Kimlik doğrulaması&gt; öğesi isteğe bağlı olarak içerebilir bir &lt;forms&gt; alt öğe üzerinden bir form kimlik doğrulama ayarlarını çeşitli belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-112">The &lt;authentication&gt; element may optionally include a &lt;forms&gt; child element, through which an assortment of forms authentication settings may be specified.</span></span>

<span data-ttu-id="00d7b-113">Bu öğreticide biz çeşitli forms kimlik doğrulaması ayarlarını incelemek ve bunları aracılığıyla değiştirme konusuna bakın &lt;forms&gt; öğesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-113">In this tutorial we will examine the various forms authentication settings and see how to modify them through the &lt;forms&gt; element.</span></span> <span data-ttu-id="00d7b-114">Forms kimlik doğrulaması bileti 's zaman aşımı değeri, bir oturum açma sayfası kullanarak özel bir URL (örneğin, SignIn.aspx Login.aspx yerine) ve cookieless form kimlik doğrulama biletlerini özelleştirme ayrıntılı bir bakış bu oluşturulmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-114">This will entail a detailed look at customizing the forms authentication ticket's timeout value, using a login page with a custom URL (like SignIn.aspx instead of Login.aspx), and cookieless forms authentication tickets.</span></span> <span data-ttu-id="00d7b-115">Biz ayrıca forms kimlik doğrulaması bileti yapısıyla daha yakından inceleyin ve bilet ait verileri denetleme ve izinsiz güvenli olduğundan emin olmak için ASP.NET alır önlemleri bakın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-115">We will also examine the makeup of the forms authentication ticket more closely and see the precautions ASP.NET takes to ensure that the ticket's data is secure from inspection and tampering.</span></span> <span data-ttu-id="00d7b-116">Son olarak, forms kimlik doğrulaması bileti ek kullanıcı verilerini depolamak ve bu verilerine özel bir asıl nesne modeli ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="00d7b-116">Finally, we will look at how to store extra user data in the forms authentication ticket and how to model this data through a custom principal object.</span></span>

## <a name="step-1-examining-the-ltformsgt-configuration-settings"></a><span data-ttu-id="00d7b-117">1. adım: İnceleniyor &lt;forms&gt; yapılandırma ayarları</span><span class="sxs-lookup"><span data-stu-id="00d7b-117">Step 1: Examining the &lt;forms&gt; Configuration Settings</span></span>

<span data-ttu-id="00d7b-118">ASP.NET formları kimlik doğrulama sisteminde bir uygulama tarafından uygulama temelinde özelleştirilebilir yapılandırma ayarları sayısı sunar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-118">The forms authentication system in ASP.NET offers a number of configuration settings that can be customized on an application-by-application basis.</span></span> <span data-ttu-id="00d7b-119">Bu gibi ayarları içerir: form kimlik doğrulaması ömrü bilet; ne tür bir koruma bilet uygulanır; altında hangi koşullar cookieless kimlik doğrulama biletlerini kullanılır; oturum açma sayfasının yolu; ve diğer bilgileri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-119">This includes settings like: the lifetime of the forms authentication ticket; what sort of protection is applied to the ticket; under what conditions cookieless authentication tickets are used; the path to the login page; and other information.</span></span> <span data-ttu-id="00d7b-120">Varsayılan değerleri değiştirmek için add bir [ &lt;forms&gt; öğesi](https://msdn.microsoft.com/library/1d3t3c61.aspx) bir alt öğesi olarak [ &lt;kimlik doğrulaması&gt; öğesi](https://msdn.microsoft.com/library/532aee0e.aspx), bu özellik belirtme XML özniteliği özelleştirmek istediğiniz değerleri bunu ister:</span><span class="sxs-lookup"><span data-stu-id="00d7b-120">To modify the default values, add a [&lt;forms&gt; element](https://msdn.microsoft.com/library/1d3t3c61.aspx) as a child of the [&lt;authentication&gt; element](https://msdn.microsoft.com/library/532aee0e.aspx), specifying those property values you want to customize as XML attributes like so:</span></span>

[!code-xml[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample1.xml)]

<span data-ttu-id="00d7b-121">Tablo 1 aracılığıyla özelleştirilmiş özellikleri özetler &lt;forms&gt; öğesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-121">Table 1 summarizes the properties that can be customized through the &lt;forms&gt; element.</span></span> <span data-ttu-id="00d7b-122">Web.config bir XML dosyası olduğundan, sol sütunda öznitelik adları büyük küçük harfe duyarlıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-122">Since Web.config is an XML file, the attribute names in the left column are case-sensitive.</span></span>

| <span data-ttu-id="00d7b-123">**Özniteliği**</span><span class="sxs-lookup"><span data-stu-id="00d7b-123">**Attribute**</span></span> | <span data-ttu-id="00d7b-124">**Açıklama**</span><span class="sxs-lookup"><span data-stu-id="00d7b-124">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="00d7b-125">cookieless</span><span class="sxs-lookup"><span data-stu-id="00d7b-125">cookieless</span></span> | <span data-ttu-id="00d7b-126">Bu öznitelik, hangi koşullarda URL'de katıştırılmış karşı bir tanımlama bilgisi kimlik doğrulaması bileti depolanır belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-126">This attribute specifies under what conditions the authentication ticket is stored in a cookie versus being embedded in the URL.</span></span> <span data-ttu-id="00d7b-127">İzin verilen değerler: UseCookies; UseUri; Otomatik Algıla; ve UseDeviceProfile (varsayılan).</span><span class="sxs-lookup"><span data-stu-id="00d7b-127">Allowable values are: UseCookies; UseUri; AutoDetect; and UseDeviceProfile (the default).</span></span> <span data-ttu-id="00d7b-128">2. adım, bu ayar daha ayrıntılı inceler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-128">Step 2 examines this setting in more detail.</span></span> |
| <span data-ttu-id="00d7b-129">defaultUrl</span><span class="sxs-lookup"><span data-stu-id="00d7b-129">defaultUrl</span></span> | <span data-ttu-id="00d7b-130">Kullanıcılar sorgu dizesinde belirtilen Redirecturl'yi değer yoksa oturum açma sayfasından oturum açtıktan sonra yeniden yönlendirileceği URL'yi belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-130">Indicates the URL that users are redirected to after signing in from the login page if there is no RedirectUrl value specified in the querystring.</span></span> <span data-ttu-id="00d7b-131">Default.aspx varsayılan değerdir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-131">The default value is default.aspx.</span></span> |
| <span data-ttu-id="00d7b-132">etki alanı</span><span class="sxs-lookup"><span data-stu-id="00d7b-132">domain</span></span> | <span data-ttu-id="00d7b-133">Tanımlama bilgisi tabanlı kimlik doğrulama biletlerini kullanırken, bu ayar tanımlama bilgisinin etki alanı değeri belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-133">When using cookie-based authentication tickets, this setting specifies the cookie's domain value.</span></span> <span data-ttu-id="00d7b-134">Varsayılan değer tarayıcının içinden (www.yourdomain.com gibi) verilmiş etki alanını kullanmak boş bir dizedir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-134">The default value is an empty string, which causes the browser to use the domain from which it was issued (such as www.yourdomain.com).</span></span> <span data-ttu-id="00d7b-135">Bu durumda, tanımlama bilgisi olur **değil** yapma admin.yourdomain.com gibi alt etki alanları için istediğinde gönderilmeyecek. Tüm alt etki alanları için geçirilecek tanımlama bilgisi istiyorsanız justanotherxiodec11.BLOB.Core.Windows.NET ayarı etki alanı özniteliği özelleştirmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-135">In this case, the cookie will **not** be sent when making requests to subdomains, such as admin.yourdomain.com. If you want the cookie to be passed to all subdomains you need to customize the domain attribute setting it to yourdomain.com.</span></span> |
| <span data-ttu-id="00d7b-136">enableCrossAppRedirects</span><span class="sxs-lookup"><span data-stu-id="00d7b-136">enableCrossAppRedirects</span></span> | <span data-ttu-id="00d7b-137">Kimliği doğrulanmış kullanıcılar aynı sunucuda diğer web uygulamalarında URL'lere yeniden yönlendirilen zaman hatırlanan gösteren bir Boole değeri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-137">A Boolean value indicating whether authenticated users are remembered when redirected to URLs in other web applications on the same server.</span></span> <span data-ttu-id="00d7b-138">Varsayılan olarak yanlıştır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-138">The default is false.</span></span> |
| <span data-ttu-id="00d7b-139">loginUrl</span><span class="sxs-lookup"><span data-stu-id="00d7b-139">loginUrl</span></span> | <span data-ttu-id="00d7b-140">Oturum açma sayfası URL'si.</span><span class="sxs-lookup"><span data-stu-id="00d7b-140">The URL of the login page.</span></span> <span data-ttu-id="00d7b-141">Varsayılan değer, Login.aspx'tir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-141">The default value is login.aspx.</span></span> |
| <span data-ttu-id="00d7b-142">name</span><span class="sxs-lookup"><span data-stu-id="00d7b-142">name</span></span> | <span data-ttu-id="00d7b-143">Tanımlama bilgisi tabanlı kimlik doğrulama biletlerini, tanımlama bilgisinin adını kullanırken.</span><span class="sxs-lookup"><span data-stu-id="00d7b-143">When using cookie-based authentication tickets, the name of the cookie.</span></span> <span data-ttu-id="00d7b-144">Varsayılandır. ASPXAUTH.</span><span class="sxs-lookup"><span data-stu-id="00d7b-144">The default is .ASPXAUTH.</span></span> |
| <span data-ttu-id="00d7b-145">yol</span><span class="sxs-lookup"><span data-stu-id="00d7b-145">path</span></span> | <span data-ttu-id="00d7b-146">Tanımlama bilgisi tabanlı kimlik doğrulama biletlerini kullanırken, bu ayar tanımlama bilgisinin yolu özniteliği belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-146">When using cookie-based authentication tickets, this setting specifies the cookie's path attribute.</span></span> <span data-ttu-id="00d7b-147">Yol özniteliği bir tanımlama bilgisi belirli dizin hiyerarşiye kapsamını sınırlandırmak bir geliştirici sağlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-147">The path attribute enables a developer to limit the scope of a cookie to a particular directory hierarchy.</span></span> <span data-ttu-id="00d7b-148">Varsayılan değer / hangi kimlik doğrulama bileti tanımlama etki alanında yapılan herhangi bir istek göndermek için tarayıcı bildirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-148">The default value is /, which informs the browser to send the authentication ticket cookie to any request made to the domain.</span></span> |
| <span data-ttu-id="00d7b-149">koruma</span><span class="sxs-lookup"><span data-stu-id="00d7b-149">protection</span></span> | <span data-ttu-id="00d7b-150">Forms kimlik doğrulaması bileti korumak için hangi teknikleri kullanıldığını belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-150">Indicates what techniques are used to protect the forms authentication ticket.</span></span> <span data-ttu-id="00d7b-151">İzin verilen değerler: tüm (varsayılan); Şifreleme; Yok; ve doğrulama.</span><span class="sxs-lookup"><span data-stu-id="00d7b-151">The allowable values are: All (the default); Encryption; None; and Validation.</span></span> <span data-ttu-id="00d7b-152">Bu ayarlar, adım 3'te ayrıntılı ele alınmıştır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-152">These settings are discussed in detail in Step 3.</span></span> |
| <span data-ttu-id="00d7b-153">requireSSL</span><span class="sxs-lookup"><span data-stu-id="00d7b-153">requireSSL</span></span> | <span data-ttu-id="00d7b-154">Kimlik doğrulama tanımlama bilgisini iletmek için bir SSL bağlantısının gerekli olup olmadığını gösteren bir Boole değeri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-154">A Boolean value that indicates whether an SSL connection is required to transmit the authentication cookie.</span></span> <span data-ttu-id="00d7b-155">Varsayılan değer false'tur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-155">The default value is false.</span></span> |
| <span data-ttu-id="00d7b-156">SlidingExpiration değeri</span><span class="sxs-lookup"><span data-stu-id="00d7b-156">slidingExpiration</span></span> | <span data-ttu-id="00d7b-157">Kullanıcı kimlik doğrulama tanımlama bilgisinin zaman aşımı her erişimde sıfırlanacağını olup olmadığını tek bir oturum sırasındaki site ziyaret gösteren bir Boole değeri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-157">A Boolean value that indicates whether the authentication cookie's timeout is reset each time the user visits the site during a single session.</span></span> <span data-ttu-id="00d7b-158">Varsayılan değer true olur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-158">The default value is true.</span></span> <span data-ttu-id="00d7b-159">Kimlik doğrulama bileti zaman aşımı ilkesini belirtme bölümlerinde daha ayrıntılı ele alınmıştır anahtarı'nın zaman aşımı değeri bölümü.</span><span class="sxs-lookup"><span data-stu-id="00d7b-159">The authentication ticket timeout policy is discussed in more detail in the Specifying the Ticket's Timeout Value section.</span></span> |
| <span data-ttu-id="00d7b-160">Zaman aşımı</span><span class="sxs-lookup"><span data-stu-id="00d7b-160">timeout</span></span> | <span data-ttu-id="00d7b-161">Saat geçtikten sonra kimlik doğrulama bileti tanımlama bilgisinin süresinin dakika cinsinden belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-161">Specifies the time, in minutes, after which the authentication ticket cookie expires.</span></span> <span data-ttu-id="00d7b-162">Varsayılan değer 30'dur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-162">The default value is 30.</span></span> <span data-ttu-id="00d7b-163">Kimlik doğrulama bileti zaman aşımı ilkesini belirtme bölümlerinde daha ayrıntılı ele alınmıştır anahtarı'nın zaman aşımı değeri bölümü.</span><span class="sxs-lookup"><span data-stu-id="00d7b-163">The authentication ticket timeout policy is discussed in more detail in the Specifying the Ticket's Timeout Value section.</span></span> |

<span data-ttu-id="00d7b-164">**Tablo 1**: bir özetini &lt;forms&gt; öğenin öznitelikleri</span><span class="sxs-lookup"><span data-stu-id="00d7b-164">**Table 1**: A Summary of the &lt;forms&gt; Element's Attributes</span></span>

<span data-ttu-id="00d7b-165">ASP.NET 2.0 ve sonrasındaki, varsayılan formlar kimlik doğrulaması .NET Framework FormsAuthenticationConfiguration sınıfında sabit kodlanmış değerlerdir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-165">In ASP.NET 2.0 and beyond, the default forms authentication values are hard-coded in the FormsAuthenticationConfiguration class in the .NET Framework.</span></span> <span data-ttu-id="00d7b-166">Web.config dosyasındaki bir uygulama tarafından uygulama temelinde değişiklikleri uygulanmış olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-166">Any modifications must be applied on an application-by-application basis in the Web.config file.</span></span> <span data-ttu-id="00d7b-167">Bu ASP.NET tarafından farklıdır 1.x burada varsayılan formlar kimlik doğrulaması değerleri machine.config dosyasında saklanıyordu (ve bu nedenle machine.config düzenleme aracılığıyla değiştirilmiş).</span><span class="sxs-lookup"><span data-stu-id="00d7b-167">This differs from ASP.NET 1.x, where the default forms authentication values were stored in the machine.config file (and could therefore be modified via editing machine.config).</span></span> <span data-ttu-id="00d7b-168">ASP.NET konu üzerinde while 1.x, bunu belirtmeyi faydalı forms kimlik doğrulaması sistem ayarlarını sayısı ASP.NET 2. 0 ' farklı bir varsayılan değerlere sahip ve ASP.NET daha ötesine 1.x.</span><span class="sxs-lookup"><span data-stu-id="00d7b-168">While on the topic of ASP.NET 1.x, it is worthwhile to mention that a number of the forms authentication system settings have different default values in ASP.NET 2.0 and beyond than in ASP.NET 1.x.</span></span> <span data-ttu-id="00d7b-169">Bir ASP.NET 1.x ortamından uygulamanızın geçiriyorsanız, bu farkların bilincinde olmak önemlidir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-169">If you are migrating your application from an ASP.NET 1.x environment, it is important to be aware of these differences.</span></span> <span data-ttu-id="00d7b-170">Başvurun [ &lt;forms&gt; öğesi teknik belgeler](https://msdn.microsoft.com/library/1d3t3c61.aspx) farklar listesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-170">Consult [the &lt;forms&gt; element technical documentation](https://msdn.microsoft.com/library/1d3t3c61.aspx) for a list of the differences.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-171">Zaman aşımı, etki alanı ve yol gibi birkaç forms kimlik doğrulaması ayarlarını elde edilen forms kimlik doğrulaması bileti tanımlama bilgisi için ayrıntıları belirtin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-171">Several forms authentication settings, such as the timeout, domain, and path, specify details for the resulting forms authentication ticket cookie.</span></span> <span data-ttu-id="00d7b-172">Tanımlama bilgileri, nasıl çalıştığını ve çeşitli özellikleri hakkında daha fazla bilgi için okuma [bu tanımlama bilgileri öğretici](http://www.quirksmode.org/js/cookies.html).</span><span class="sxs-lookup"><span data-stu-id="00d7b-172">For more information on cookies, how they work, and their various properties, read [this Cookies tutorial](http://www.quirksmode.org/js/cookies.html).</span></span>


### <a name="specifying-the-tickets-timeout-value"></a><span data-ttu-id="00d7b-173">Bilet 's zaman aşımı değeri belirterek</span><span class="sxs-lookup"><span data-stu-id="00d7b-173">Specifying the Ticket's Timeout Value</span></span>

<span data-ttu-id="00d7b-174">Forms kimlik doğrulaması bileti Kimlikteki temsil eden bir belirteçtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-174">The forms authentication ticket is a token that represents an identity.</span></span> <span data-ttu-id="00d7b-175">Tanımlama bilgisi tabanlı kimlik doğrulama biletlerini ile bu belirteç bir tanımlama bilgisi biçiminde tutulur ve her isteğin web sunucusuna gönderilen.</span><span class="sxs-lookup"><span data-stu-id="00d7b-175">With cookie-based authentication tickets, this token is held in the form of a cookie and sent to the web server on each request.</span></span> <span data-ttu-id="00d7b-176">Esas olarak, bir belirteç elinde bildirir, ben *kullanıcıadı*, t zaten oturum açtıysanız ve böylece bir kullanıcının kimliğini sayfa ziyareti arasında anımsanabileceğini kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-176">Possession of the token, in essence, declares, I am *username*, I have already logged in, and is used so that a user's identity can be remembered across page visits.</span></span>

<span data-ttu-id="00d7b-177">Forms kimlik doğrulaması bileti yalnızca kullanıcının kimliğini içerir, ancak ayrıca bütünlük ve belirteç güvenliğini sağlamaya yardımcı olmak için bilgiler içerir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-177">The forms authentication ticket not only includes the user's identity, but also contains information to help ensure the integrity and security of the token.</span></span> <span data-ttu-id="00d7b-178">Sonuçta, biz sahte bir belirteç oluşturmak veya bir LEGIT belirteci bazı underhanded şekilde değiştirmek için kullanabilmek için alınan kullanıcı istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-178">After all, we don't want a nefarious user to be able to create a counterfeit token, or to modify a legit token in some underhanded way.</span></span>

<span data-ttu-id="00d7b-179">Bu tür bir bit bilet dahil bilgilerin bir *süre sonu*, tarih ve saat fırsattır artık geçerli değil.</span><span class="sxs-lookup"><span data-stu-id="00d7b-179">One such bit of information included in the ticket is an *expiry*, which is the date and time the ticket is no longer valid.</span></span> <span data-ttu-id="00d7b-180">Bir kimlik doğrulaması bileti FormsAuthenticationModule inceler her zaman anahtar kişinin süre sonu olmayan henüz geçti sağlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-180">Each time the FormsAuthenticationModule inspects an authentication ticket, it ensures that the ticket's expiry has not yet passed.</span></span> <span data-ttu-id="00d7b-181">Varsa, anahtar yoksayar ve kullanıcının anonim olarak tanımlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-181">If it has, it disregards the ticket and identifies the user as being anonymous.</span></span> <span data-ttu-id="00d7b-182">Bu korumayı yeniden yürütme saldırılarına karşı korumaya yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-182">This safeguard helps protect against replay attacks.</span></span> <span data-ttu-id="00d7b-183">Bir bilgisayar korsanının ellerini kullanıcının geçerli kimlik doğrulaması biletinin üzerinde-kendi bilgisayara fiziksel erişim sağlamasını ve tanımlama bilgilerine kök dizini değiştirme belki de alabilirsiniz. - Bu çalınan kimlik doğrulaması bileti sunucusuna bir istek gönderebilir, geçerlilik süresi, olmadan ve Giriş elde edilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-183">Without an expiry, if a hacker was able to get her hands on a user's valid authentication ticket - perhaps by gaining physical access to their computer and rooting through their cookies - they could send a request to the server with this stolen authentication ticket and gain entry.</span></span> <span data-ttu-id="00d7b-184">Süre sonu bu senaryo engellemez, ancak hangi sırasında bu tür bir saldırının başarılı olabilmesi için pencere sınırlayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-184">While the expiry doesn't prevent this scenario, it does limit the window during which such an attack can succeed.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-185">Forms kimlik doğrulaması sistem tarafından kimlik doğrulaması bileti korumak için kullanılan 3. adım ayrıntıları ek teknikler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-185">Step 3 details additional techniques used by the forms authentication system to protect the authentication ticket.</span></span>


<span data-ttu-id="00d7b-186">Kimlik doğrulaması bileti oluştururken, forms kimlik doğrulaması sistem zaman aşımı ayarını bakarak, sona erme belirler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-186">When creating the authentication ticket, the forms authentication system determines its expiry by consulting the timeout setting.</span></span> <span data-ttu-id="00d7b-187">Tablo 1 ' 30 dakika, varsayılan ayarı zaman aşımı belirtildiği gibi forms kimlik doğrulaması bileti oluşturulduğunda, sona erme bir tarih ve saat 30 dakika sonra ayarlanır anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-187">As noted in Table 1, the timeout setting defaults to 30 minutes, meaning that when the forms authentication ticket is created its expiry is set to a date and time 30 minutes in the future.</span></span>

<span data-ttu-id="00d7b-188">Süre sonu mutlak süreye form kimlik doğrulama anahtarının süresi dolduğunda bir gelecekte tanımlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-188">The expiry defines an absolute time in the future when the forms authentication ticket expires.</span></span> <span data-ttu-id="00d7b-189">Ancak, geliştiriciler genellikle bir kayan bitiş, bir kullanıcının site revisits her zaman sıfırlanır uygulamak istiyor.</span><span class="sxs-lookup"><span data-stu-id="00d7b-189">But usually developers want to implement a sliding expiry, one that is reset every time the user revisits the site.</span></span> <span data-ttu-id="00d7b-190">Bu davranış slidingExpiration ayarları tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-190">This behavior is determined by the slidingExpiration settings.</span></span> <span data-ttu-id="00d7b-191">FormsAuthenticationModule bir kullanıcı kimlik doğrulaması her zaman (varsayılan) true olarak ayarlanırsa, anahtar kişinin süre sonu güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-191">If set to true (the default), each time the FormsAuthenticationModule authenticates a user, it updates the ticket's expiry.</span></span> <span data-ttu-id="00d7b-192">Süre sonu false olarak ayarlanırsa, her istekte güncelleştirilmezse, böylelikle tam olarak zaman aşımı zaman bilet ilk geçen dakika sayısı süresi dolacak şekilde bilet yol oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-192">If set to false, the expiry is not updated on each request, thereby causing the ticket to expire exactly timeout number of minutes past when the ticket was first created.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-193">Kimlik doğrulaması bileti depolanan süre sonu mutlak tarih ve saat değeri 2 Ağustos 2008 11:34 AM gibi ' dir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-193">The expiry stored in the authentication ticket is an absolute date and time value, like August 2, 2008 11:34 AM.</span></span> <span data-ttu-id="00d7b-194">Ayrıca, tarih ve saat web sunucusunun yerel saate göre var.</span><span class="sxs-lookup"><span data-stu-id="00d7b-194">Moreover, the date and time are relative to the web server's local time.</span></span> <span data-ttu-id="00d7b-195">Bu tasarım kararına geçici gün ışığından yararlanma saati (Amerika Birleşik Devletleri'nde saatler şimdi bir (web sunucusu Yaz Saati burada gözlenir yerel ayarda barındırılan varsayılarak) saat taşındığında olan DST), ilginç bazı yan etkileri olabilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-195">This design decision can have some interesting side effects around Daylight Saving Time (DST), which is when clocks in the United States are moved ahead one hour (assuming the web server is hosted in a locale where Daylight Saving Time is observed).</span></span> <span data-ttu-id="00d7b-196">Bir 30 dakikalık süresi dolmak üzere DST başladığı saati ile ASP.NET Web sitesi için ne olacağını düşünün (2: 00'da olmayan).</span><span class="sxs-lookup"><span data-stu-id="00d7b-196">Consider what would happen for an ASP.NET website with a 30 minute expiry near the time that DST begins (which is at 2:00 AM).</span></span> <span data-ttu-id="00d7b-197">Bir ziyaretçi siteye 11 Mart 2008'de 1: 55'da oturum açtığı düşünün.</span><span class="sxs-lookup"><span data-stu-id="00d7b-197">Imagine a visitor signs on to the site on March 11, 2008 at 1:55 AM.</span></span> <span data-ttu-id="00d7b-198">Bu 2:25 AM (gelecekte 30 dakika) 11 Mart 2008 süresi bir form kimlik doğrulama anahtarının oluşturur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-198">This would generate a forms authentication ticket that expires at March 11, 2008 at 2:25 AM (30 minutes in the future).</span></span> <span data-ttu-id="00d7b-199">Ancak, geçici bir çözüm 2: 00'da yapar sonra saat 03: 00'da için DST nedeniyle atlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-199">However, once 2:00 AM rolls around, the clock jumps to 3:00 AM because of DST.</span></span> <span data-ttu-id="00d7b-200">Kullanıcı yeni bir sayfa (3:01 AM) oturum açtıktan sonra altı dakika yüklediğinde FormsAuthenticationModule biletin süresi doldu ve kullanıcı oturum açma sayfasına yönlendirir notlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-200">When the user loads a new page six minutes after signing in (at 3:01 AM), the FormsAuthenticationModule notes that the ticket has expired and redirects the user to the login page.</span></span> <span data-ttu-id="00d7b-201">Bu ve diğer kimlik doğrulama bileti zaman aşımı sorunları saklamayı yanı geçici çözümler hakkında daha kapsamlı bir açıklama için Stefan Schackow'in bir kopyasını çekme *Professional ASP.NET 2.0 güvenlik, üyelik ve rol yönetimi* (ISBN: 978-0-7645-9698-8).</span><span class="sxs-lookup"><span data-stu-id="00d7b-201">For a more thorough discussion on this and other authentication ticket timeout oddities, as well as workarounds, pick up a copy of Stefan Schackow's *Professional ASP.NET 2.0 Security, Membership, and Role Management* (ISBN: 978-0-7645-9698-8).</span></span>


<span data-ttu-id="00d7b-202">Şekil 1 SlidingExpiration değeri false olarak ayarlanır ve zaman aşımı 30 zaman iş akışı gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-202">Figure 1 illustrates the workflow when slidingExpiration is set to false and timeout is set to 30.</span></span> <span data-ttu-id="00d7b-203">Oturum açma sırasında oluşturulan kimlik doğrulaması bileti sona erme tarihini içerir ve bu değeri sonraki isteklerde güncelleştirilmemiş unutmayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-203">Note that the authentication ticket generated at login contains the expiration date, and this value is not updated on subsequent requests.</span></span> <span data-ttu-id="00d7b-204">FormsAuthenticationModule biletin süresi doldu bulursa, onu atar ve isteğin anonim olarak değerlendirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-204">If the FormsAuthenticationModule finds that the ticket has expired, it discards it and treats the request as anonymous.</span></span>


<span data-ttu-id="00d7b-205">[![Forms kimlik doğrulaması bileti'nın süre sonu zaman slidingExpiration grafik gösterimi yanlış](forms-authentication-configuration-and-advanced-topics-cs/_static/image2.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-205">[![A Graphical Representation of the Forms Authentication Ticket's Expiry When slidingExpiration is false](forms-authentication-configuration-and-advanced-topics-cs/_static/image2.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image1.png)</span></span>

<span data-ttu-id="00d7b-206">**Şekil 01**: Forms kimlik doğrulaması bileti'nın süre sonu zaman slidingExpiration grafik gösterimi A değer false ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-206">**Figure 01**: A Graphical Representation of the Forms Authentication Ticket's Expiry When slidingExpiration is false([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image3.png))</span></span>


<span data-ttu-id="00d7b-207">Şekil 2'SlidingExpiration değeri ayarlandığında, iş akışı gösterilmiştir true ve zaman aşımı 30 ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-207">Figure 2 shows the workflow when slidingExpiration is set to true and timeout is set to 30.</span></span> <span data-ttu-id="00d7b-208">Kimliği doğrulanmış bir isteği (süresi olmayan bilet ile) alındığında, sona erme gelecekte dakika zaman aşımı sayıya güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-208">When an authenticated request is received (with a non-expired ticket) its expiry is updated to timeout number of minutes in the future.</span></span>


<span data-ttu-id="00d7b-209">[![Forms kimlik doğrulaması bileti 's grafik gösterimi slidingExpiration olduğunda true](forms-authentication-configuration-and-advanced-topics-cs/_static/image5.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-209">[![A Graphical Representation of the Forms Authentication Ticket's When slidingExpiration is true](forms-authentication-configuration-and-advanced-topics-cs/_static/image5.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image4.png)</span></span>

<span data-ttu-id="00d7b-210">**Şekil 02**: Forms kimlik doğrulaması bileti ait bir grafik gösterimi slidingExpiration olduğunda true ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-210">**Figure 02**: A Graphical Representation of the Forms Authentication Ticket's When slidingExpiration is true  ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image6.png))</span></span>


<span data-ttu-id="00d7b-211">Tanımlama bilgisi tabanlı kimlik doğrulama biletlerini (varsayılan) kullanırken, bu tartışma tanımlama bilgilerini ayrıca belirtilen kendi expiries olabileceği için biraz daha karmaşık haline gelir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-211">When using cookie-based authentication tickets (the default), this discussion becomes a little more confusing because cookies can also have their own expiries specified.</span></span> <span data-ttu-id="00d7b-212">Tanımlama bilgisi yok edilmesi durumlarda bir tanımlama bilgisinin süre sonu (veya bunların olmaması) tarayıcıyı yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-212">A cookie's expiry (or lack thereof) instructs the browser when the cookie should be destroyed.</span></span> <span data-ttu-id="00d7b-213">Tanımlama bilgisi geçerlilik süresi eksikse, tarayıcı kapatıldığında yok edilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-213">If the cookie lacks an expiry, it is destroyed when the browser shuts down.</span></span> <span data-ttu-id="00d7b-214">Geçerlilik süresi varsa, ancak, tanımlama bilgisi tarihe kadar kullanıcının bilgisayarında saklanır ve süre sonu içinde belirtilen süre geçtikten.</span><span class="sxs-lookup"><span data-stu-id="00d7b-214">If an expiry is present, however, the cookie remains stored on the user's computer until the date and time specified in the expiry has passed.</span></span> <span data-ttu-id="00d7b-215">Bir tanımlama bilgisi tarayıcı tarafından kaldırıldığı zaman artık web sunucusuna gönderilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-215">When a cookie is destroyed by the browser, it is no longer sent to the web server.</span></span> <span data-ttu-id="00d7b-216">Bu nedenle, site dışında günlüğü kullanıcı için bir tanımlama bilgisinin yok etme benzerdir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-216">Therefore, the destruction of a cookie is analogous to the user logging out of the site.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-217">Elbette, bir kullanıcı önceden bilgisayarlarında depolanan tüm tanımlama bilgilerini kaldırabilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-217">Of course, a user may proactively remove any cookies stored on their computer.</span></span> <span data-ttu-id="00d7b-218">Internet Explorer 7'de, Araçlar, seçenekleri, gidin ve gözatma geçmişini bölümünde Sil düğmesini.</span><span class="sxs-lookup"><span data-stu-id="00d7b-218">In Internet Explorer 7, you would go to Tools, Options, and click the Delete button in the Browsing history section.</span></span> <span data-ttu-id="00d7b-219">Buradan, Sil tanımlama bilgilerini düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-219">From there, click the Delete cookies button.</span></span>


<span data-ttu-id="00d7b-220">Forms kimlik doğrulaması sistem oturumu veya sona erme tabanlı tanımlama bilgisi için geçirilen değerine bağlı olarak oluşturur *persistCookie* parametresi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-220">The forms authentication system creates session-based or expiry-based cookies depending on the value passed in to the *persistCookie* parameter.</span></span> <span data-ttu-id="00d7b-221">İki giriş parametrelerinde FormsAuthentication sınıfının GetAuthCookie, SetAuthCookie ve RedirectFromLoginPage yöntemlerini ele geri çağırma: *kullanıcıadı* ve *persistCookie*.</span><span class="sxs-lookup"><span data-stu-id="00d7b-221">Recall that the FormsAuthentication class's GetAuthCookie, SetAuthCookie, and RedirectFromLoginPage methods take in two input parameters: *username* and *persistCookie*.</span></span> <span data-ttu-id="00d7b-222">Önceki öğreticide oluşturduğumuz oturum açma sayfasına kalıcı bir tanımlama bilgisi oluşturulup oluşturulmadığını belirlenen bir Beni anımsa onay kutusunu dahil.</span><span class="sxs-lookup"><span data-stu-id="00d7b-222">The login page we created in the preceding tutorial included a Remember me CheckBox, which determined whether a persistent cookie was created.</span></span> <span data-ttu-id="00d7b-223">Süre sonu tabanlı kalıcı tanımlama bilgileri; kalıcı olmayan tanımlama bilgileri, oturum tabanlı.</span><span class="sxs-lookup"><span data-stu-id="00d7b-223">Persistent cookies are expiry-based; non-persistent cookies are session-based.</span></span>

<span data-ttu-id="00d7b-224">Zaten açıklanan zaman aşımı ve slidingExpiration kavramları aynı hem oturum ve süre sonu göre tanımlama bilgilerini uygulayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-224">The timeout and slidingExpiration concepts already discussed apply the same to both session- and expiry-based cookies.</span></span> <span data-ttu-id="00d7b-225">Yalnızca bir alt fark yürütmesinde: yarısı belirtilen süre geçtikten birden fazla süre sonu tabanlı tanımlama bilgisi slidingTimeout özelliği true olarak ayarlanmış kullanırken, tanımlama bilgisinin süre sonu yalnızca güncelleştirildiğinde.</span><span class="sxs-lookup"><span data-stu-id="00d7b-225">There is only one minor difference in execution: when using expiry-based cookies with slidingTimeout set to true, the cookie's expiry is only updated when more than half of the specified time has elapsed.</span></span>

<span data-ttu-id="00d7b-226">Şimdi, zaman aşımı kayan zaman aşımı değeri kullanarak bir saat (60 dakika) sonra anahtarları şekilde bizim Web sitesinin kimlik doğrulama bileti zaman aşımı ilkeleri güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-226">Let's update our website's authentication ticket timeout policies so that tickets timeout after one hour (60 minutes), using a sliding expiration.</span></span> <span data-ttu-id="00d7b-227">Bu değişiklik efekt, Web.config dosyasını güncelleştirmek için ekleme bir &lt;forms&gt; öğesine &lt;kimlik doğrulaması&gt; aşağıdaki biçimlendirme sahip öğe:</span><span class="sxs-lookup"><span data-stu-id="00d7b-227">To effect this change, update the Web.config file, adding a &lt;forms&gt; element to the &lt;authentication&gt; element with the following markup:</span></span>

[!code-xml[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample2.xml)]

### <a name="using-an-login-page-url-other-than-loginaspx"></a><span data-ttu-id="00d7b-228">Bir oturum açma sayfası URL'si Login.aspx dışında kullanma</span><span class="sxs-lookup"><span data-stu-id="00d7b-228">Using an Login Page URL Other than Login.aspx</span></span>

<span data-ttu-id="00d7b-229">FormsAuthenticationModule, yetkisiz kullanıcıların otomatik olarak oturum açma sayfasına yeniden yönlendirir. olduğundan, oturum açma sayfasının URL'sini bilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-229">Since the FormsAuthenticationModule automatically redirects unauthorized users to the login page, it needs to know the login page's URL.</span></span> <span data-ttu-id="00d7b-230">Bu URL loginUrl özniteliği tarafından belirtilen &lt;forms&gt; öğesi ve login.aspx varsayılan değeri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-230">This URL is specified by the loginUrl attribute in the &lt;forms&gt; element and defaults to login.aspx.</span></span> <span data-ttu-id="00d7b-231">Mevcut bir Web bağlantı noktası oluşturma, farklı bir URL, zaten işareti ve arama motorları tarafından dizinli bir bir oturum açma sayfası zaten sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-231">If you are porting over an existing website, you may already have a login page with a different URL, one that has already been bookmarked and indexed by search engines.</span></span> <span data-ttu-id="00d7b-232">Varolan oturum açma sayfanız için login.aspx yeniden adlandırma ve son bağlantılar ve kullanıcıların yer işaretleri yerine, bunun yerine oturum açma sayfanız işaret edecek şekilde loginUrl özniteliği değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-232">Rather than renaming your existing login page to login.aspx and breaking links and users' bookmarks, you can instead modify the loginUrl attribute to point to your login page.</span></span>

<span data-ttu-id="00d7b-233">Örneğin, ~/Users/SignIn.aspx loginUrl yapılandırma ayarına işaret oturum açma sayfanız SignIn.aspx idi ve kullanıcıların dizininde bulunan, şu şekilde:</span><span class="sxs-lookup"><span data-stu-id="00d7b-233">For example, if your login page was named SignIn.aspx and was located in the Users directory, you could point the loginUrl configuration setting to ~/Users/SignIn.aspx like so:</span></span>

[!code-xml[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample3.xml)]

<span data-ttu-id="00d7b-234">Geçerli uygulamamız zaten Login.aspx adlı bir oturum açma sayfası olduğundan, özel bir değer belirtmek için gerek yoktur &lt;forms&gt; öğesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-234">Since our current application already has a login page named Login.aspx, there's no need to specify a custom value in the &lt;forms&gt; element.</span></span>

## <a name="step-2-using-cookieless-forms-authentication-tickets"></a><span data-ttu-id="00d7b-235">2. adım: Cookieless form kimlik doğrulama biletlerini kullanma</span><span class="sxs-lookup"><span data-stu-id="00d7b-235">Step 2: Using Cookieless Forms Authentication Tickets</span></span>

<span data-ttu-id="00d7b-236">Varsayılan olarak form kimlik doğrulama sistemi tanımlama bilgileri koleksiyonu kendi kimlik doğrulama biletlerini depolamak veya bunlara sitesini ziyaret kullanıcı aracısı temel URL katıştırmak belirler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-236">By default the forms authentication system determines whether to store its authentication tickets in the cookies collection or embed them in the URL based on the user agent visiting the site.</span></span> <span data-ttu-id="00d7b-237">Tüm temel masaüstü tarayıcıları Internet Explorer, Firefox, Opera ve Safari, destek tanımlama bilgileri gibi çalışır, ancak tüm mobil aygıtları yapın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-237">All mainstream desktop browsers like Internet Explorer, Firefox, Opera, and Safari, support cookies, but not all mobile devices do.</span></span>

<span data-ttu-id="00d7b-238">Forms kimlik doğrulaması sistem tarafından kullanılan tanımlama bilgisi ilkesi cookieless ayarına bağlıdır &lt;forms&gt; dört değerlerden biri atanabilir öğe:</span><span class="sxs-lookup"><span data-stu-id="00d7b-238">The cookie policy used by the forms authentication system depends on the cookieless setting in the &lt;forms&gt; element, which can be assigned one of four values:</span></span>

- <span data-ttu-id="00d7b-239">UseCookies - belirtir tanımlama bilgisi tabanlı kimlik doğrulama biletlerini her zaman kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-239">UseCookies - specifies that cookie-based authentication tickets will always be used.</span></span>
- <span data-ttu-id="00d7b-240">UseUri - gösterir tanımlama bilgisi tabanlı kimlik doğrulama biletlerini hiçbir zaman kullanılmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-240">UseUri - indicates that cookie-based authentication tickets will never be used.</span></span>
- <span data-ttu-id="00d7b-241">Cihaz profili tanımlama bilgisi, tanımlama bilgisi tabanlı kimlik doğrulama biletlerini desteklemiyorsa otomatik algıla - kullanılmaz; cihaz profili tanımlama bilgilerini destekliyorsa, bir araştırma mekanizması tanımlama bilgilerinin etkin olup olmadığını belirlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-241">AutoDetect - if the device profile does not support cookies, cookie-based authentication tickets are not used; if the device profile supports cookies, a probing mechanism is used to determine if cookies are enabled.</span></span>
- <span data-ttu-id="00d7b-242">UseDeviceProfile - varsayılan; cihaz profili tanımlama bilgilerini destekliyorsa tanımlama bilgisi tabanlı kimlik doğrulama biletlerini kullanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-242">UseDeviceProfile - the default; uses cookie-based authentication tickets only if the device profile supports cookies.</span></span> <span data-ttu-id="00d7b-243">Araştırma mekanizması kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-243">No probing mechanism is used.</span></span>

<span data-ttu-id="00d7b-244">Otomatik Algıla ve UseDeviceProfile ayarlarını dayanan bir *aygıt profili* tanımlama bilgisi tabanlı veya cookieless kimlik doğrulama biletlerini kullanıp kullanmayacağınızı ascertaining içinde.</span><span class="sxs-lookup"><span data-stu-id="00d7b-244">The AutoDetect and UseDeviceProfile settings rely on a *device profile* in ascertaining whether to use cookie-based or cookieless authentication tickets.</span></span> <span data-ttu-id="00d7b-245">ASP.NET bir veritabanı çeşitli aygıtlar ve tanımlama bilgileri destekledikleri, hangi sürümü destekledikleri JavaScript vb. gibi yeteneklerini tutar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-245">ASP.NET maintains a database of various devices and their capabilities, such as whether they support cookies, what version of JavaScript they support, and so on.</span></span> <span data-ttu-id="00d7b-246">Her bir aygıtı ister bir web sayfası gönderir boyunca bir web sunucusundan bir *kullanıcı aracısı* aygıt türünü tanımlayan bir HTTP üstbilgisi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-246">Each time a device requests a web page from a web server it sends along a *user-agent* HTTP header that identifies the device type.</span></span> <span data-ttu-id="00d7b-247">ASP.NET, sağlanan kullanıcı aracısı dizesi otomatik olarak kendi veritabanında belirtilen karşılık gelen bir profili ile eşleşir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-247">ASP.NET automatically matches the supplied user-agent string with the corresponding profile specified in its database.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-248">Bu veritabanı cihaz yeteneklerini uygun bir XML dosya sayısı depolanan [tarayıcı tanım dosyası şeması](https://msdn.microsoft.com/library/ms228122.aspx).</span><span class="sxs-lookup"><span data-stu-id="00d7b-248">This database of device capabilities is stored in a number of XML files that adhere to the [Browser Definition File schema](https://msdn.microsoft.com/library/ms228122.aspx).</span></span> <span data-ttu-id="00d7b-249">Varsayılan cihaz profili dosyalarını % WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG\Browsers bulunur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-249">The default device profile files are located in %WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG\Browsers.</span></span> <span data-ttu-id="00d7b-250">Uygulamanızın uygulamaya özel dosyaları da ekleyebilirsiniz\_tarayıcılar klasör.</span><span class="sxs-lookup"><span data-stu-id="00d7b-250">You can also add custom files to your application's App\_Browsers folder.</span></span> <span data-ttu-id="00d7b-251">Daha fazla bilgi için bkz: [nasıl yapılır: algılamak tarayıcı türleri, ASP.NET Web sayfaları](https://msdn.microsoft.com/library/3yekbd5b.aspx).</span><span class="sxs-lookup"><span data-stu-id="00d7b-251">For more information, see [How To: Detect Browser Types in ASP.NET Web Pages](https://msdn.microsoft.com/library/3yekbd5b.aspx).</span></span>


<span data-ttu-id="00d7b-252">Varsayılan ayar UseDeviceProfile olduğundan, site, profili tanımlama bilgilerini desteklemiyor raporları bir cihaz tarafından ziyaret edildiğinde cookieless form kimlik doğrulama biletlerini kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-252">Because the default setting is UseDeviceProfile, cookieless forms authentication tickets will be used when the site is visited by a device whose profile reports that it does not support cookies.</span></span>

### <a name="encoding-the-authentication-ticket-in-the-url"></a><span data-ttu-id="00d7b-253">URL'de kimlik doğrulaması bileti kodlama</span><span class="sxs-lookup"><span data-stu-id="00d7b-253">Encoding the Authentication Ticket in the URL</span></span>

<span data-ttu-id="00d7b-254">Her istekte ziyaret aygıt bunları destekliyorsa varsayılan formlar kimlik doğrulama ayarlarını tanımlama bilgilerini kullanmasına neden olan belirli bir Web tarayıcısından bilgi dahil etmek için doğal bir orta tanımlama bilgileridir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-254">Cookies are a natural medium for including information from the browser in each request to a particular website, which is why the default forms authentication settings use cookies if the visiting device supports them.</span></span> <span data-ttu-id="00d7b-255">Tanımlama bilgilerini desteklenmiyorsa, kimlik doğrulaması bileti istemciden sunucuya geçirme için alternatif bir yol uygulanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-255">If cookies are not supported, an alternate means for passing the authentication ticket from the client to the server must be employed.</span></span> <span data-ttu-id="00d7b-256">URL'deki tanımlama bilgisi verileri kodlamak için geçici cookieless ortamlarda kullanılan ortak bir çözüm değildir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-256">A common workaround used in cookieless environments is to encode the cookie data in the URL.</span></span>

<span data-ttu-id="00d7b-257">URL içinde gibi bilgileri nasıl katıştırılabilen görmek için en iyi cookieless kimlik doğrulama biletlerini kullanmak için site zorlamak için yoludur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-257">The best way to see how such information can be embedded within the URL is to force the site to use cookieless authentication tickets.</span></span> <span data-ttu-id="00d7b-258">Bu işlem için UseUri cookieless yapılandırma ayarı ayarlayarak gerçekleştirilebilir:</span><span class="sxs-lookup"><span data-stu-id="00d7b-258">This can be accomplished by setting the cookieless configuration setting to UseUri:</span></span>

[!code-xml[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample4.xml)]

<span data-ttu-id="00d7b-259">Bu değişikliği yaptıktan sonra bir tarayıcı aracılığıyla sitesini ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-259">Once you have made this change, visit the site through a browser.</span></span> <span data-ttu-id="00d7b-260">Tam olarak menülerin önce olduğu gibi anonim kullanıcı olarak ziyaret ederken URL'leri arar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-260">When visiting as an anonymous user, the URLs will look exactly like they did before.</span></span> <span data-ttu-id="00d7b-261">Örneğin, Default.aspx sayfasını ziyaret eden my tarayıcının adres çubuğunda aşağıdaki URL'yi gösterir:</span><span class="sxs-lookup"><span data-stu-id="00d7b-261">For example, when visiting Default.aspx page my browser's address bar shows the following URL:</span></span>

`http://localhost:2448/ASPNET\_Security\_Tutorial\_03\_CS/default.aspx`

<span data-ttu-id="00d7b-262">Ancak, URL'de oturum açtıktan sonra forms kimlik doğrulaması bileti katıştırılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-262">However, upon logging in, the forms authentication ticket is embedded into the URL.</span></span> <span data-ttu-id="00d7b-263">Örneğin, oturum açma sayfasını ziyaret ve Sam oturum açtıktan sonra Default.aspx sayfasına döndürülen ancak bu kez URL'dir:</span><span class="sxs-lookup"><span data-stu-id="00d7b-263">For example, after visiting the login page and logging in as Sam, I am returned to the Default.aspx page, but the URL this time is:</span></span>

`http://localhost:2448/ASPNET\_Security\_Tutorial\_03\_CS/(F(jaIOIDTJxIr12xYS-VVgkqKCVAuIoW30Bu0diWi6flQC-FyMaLXJfow\_Vd9GZkB2Cv-rfezq0gKadKX0YPZCkA2))/default.aspx`

<span data-ttu-id="00d7b-264">Forms kimlik doğrulaması bileti URL içinde katıştırılmış.</span><span class="sxs-lookup"><span data-stu-id="00d7b-264">The forms authentication ticket has been embedded within the URL.</span></span> <span data-ttu-id="00d7b-265">The string (F(jaIOIDTJxIr12xYS-VVgkqKCVAuIoW30Bu0diWi6flQC-FyMaLXJfow\_Vd9GZkB2Cv-rfezq0gKadKX0YPZCkA2) represents the hex-encoded authentication ticket information, and is the same data that is usually stored within a cookie.</span><span class="sxs-lookup"><span data-stu-id="00d7b-265">The string (F(jaIOIDTJxIr12xYS-VVgkqKCVAuIoW30Bu0diWi6flQC-FyMaLXJfow\_Vd9GZkB2Cv-rfezq0gKadKX0YPZCkA2) represents the hex-encoded authentication ticket information, and is the same data that is usually stored within a cookie.</span></span>

<span data-ttu-id="00d7b-266">Cookieless kimlik doğrulama biletlerini çalışmak sırasıyla sistem kimlik doğrulaması bilet verileri içerecek şekilde tüm URL'leri sayfasında kodlamak gerekir, kullanıcı bir bağlantıyı tıklattığında Aksi takdirde kimlik doğrulaması bileti kaybolacaktır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-266">In order for cookieless authentication tickets to work, the system must encode all URLs on the page to include the authentication ticket data, otherwise the authentication ticket will be lost when the user clicks on a link.</span></span> <span data-ttu-id="00d7b-267">Thankfully, bu katıştırma mantığı otomatik olarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-267">Thankfully, this embedding logic is performed automatically.</span></span> <span data-ttu-id="00d7b-268">Bu işlevselliğini göstermek için Default.aspx sayfasını açın ve bir köprü denetim Bağlantıyı Sına ve SomePage.aspx, metin ve NavigateUrl özelliklerini sırasıyla ayarı ekleyin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-268">To demonstrate this functionality, open the Default.aspx page and add a HyperLink control, setting its Text and NavigateUrl properties to Test Link and SomePage.aspx, respectively.</span></span> <span data-ttu-id="00d7b-269">Gerçekten olmadığından bir sayfa Projemizin SomePage.aspx adlı önemli değildir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-269">It doesn't matter that there really isn't a page in our project named SomePage.aspx.</span></span>

<span data-ttu-id="00d7b-270">Değişiklikleri kaydetmek için Default.aspx ve bir tarayıcı ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-270">Save the changes to Default.aspx and then visit it through a browser.</span></span> <span data-ttu-id="00d7b-271">Böylece URL'de forms kimlik doğrulaması bileti katıştırılmış siteye oturum açın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-271">Log on to the site so that the forms authentication ticket is embedded in the URL.</span></span> <span data-ttu-id="00d7b-272">Ardından, Default.aspx Bağlantıyı Sına bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-272">Next, from Default.aspx, click the Test Link link.</span></span> <span data-ttu-id="00d7b-273">Ne oldu?</span><span class="sxs-lookup"><span data-stu-id="00d7b-273">What happened?</span></span> <span data-ttu-id="00d7b-274">SomePage.aspx adlı sayfa varsa, 404 hatası oluştu, ancak burada önemli olan değil.</span><span class="sxs-lookup"><span data-stu-id="00d7b-274">If no page named SomePage.aspx exists, then a 404 error occurred, but that's not what's important here.</span></span> <span data-ttu-id="00d7b-275">Bunun yerine, tarayıcınızın adres çubuğuna odaklanılmaktadır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-275">Instead, focus on the Address bar in your browser.</span></span> <span data-ttu-id="00d7b-276">Bu form kimlik doğrulama anahtarının URL'de içerdiğini unutmayın!</span><span class="sxs-lookup"><span data-stu-id="00d7b-276">Note that it includes the forms authentication ticket in the URL!</span></span>

`http://localhost:2448/ASPNET\_Security\_Tutorial\_03\_CS/(F(jaIOIDTJxIr12xYS-VVgkqKCVAuIoW30Bu0diWi6flQC-FyMaLXJfow\_Vd9GZkB2Cv-rfezq0gKadKX0YPZCkA2))/SomePage.aspx`

<span data-ttu-id="00d7b-277">Bağlantıda URL SomePage.aspx otomatik olarak kimlik doğrulaması bileti - dahil bir URL'ye dönüştürüldü biz lick kod yazmak zorunda oldu!</span><span class="sxs-lookup"><span data-stu-id="00d7b-277">The URL SomePage.aspx in the link was automatically converted into a URL that included the authentication ticket - we didn't have to write a lick of code!</span></span> <span data-ttu-id="00d7b-278">Form kimlik doğrulaması bileti http:// ile başlayan değil köprüler URL'sini otomatik olarak katıştırılır veya /.</span><span class="sxs-lookup"><span data-stu-id="00d7b-278">The form authentication ticket will automatically be embedded in the URL for any hyperlinks that do not start with http:// or /.</span></span> <span data-ttu-id="00d7b-279">Köprü Response.Redirect yapılan bir çağrı, bir köprü denetim veya bağlı HTML bağlayıcı öğesi görünürse önemli değildir (yani, &lt;bir href = "..."&gt;... &lt;/a&gt;).</span><span class="sxs-lookup"><span data-stu-id="00d7b-279">It doesn't matter if the hyperlink appears in a call to Response.Redirect, in a HyperLink control, or in an anchor HTML element (i.e., &lt;a href="..."&gt;...&lt;/a&gt;).</span></span> <span data-ttu-id="00d7b-280">URL bir şey http://www.someserver.com/SomePage.aspx /SomePage.aspx gibi değil veya sürece, forms kimlik doğrulaması bileti için bize katıştırılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-280">As long as the URL isn't something like http://www.someserver.com/SomePage.aspx or /SomePage.aspx, the forms authentication ticket will be embedded for us.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-281">Cookieless form kimlik doğrulama biletlerini tanımlama bilgisi tabanlı kimlik doğrulama biletlerini olarak aynı zaman aşımı ilkelerine uyması.</span><span class="sxs-lookup"><span data-stu-id="00d7b-281">Cookieless forms authentication tickets adhere to the same timeout policies as cookie-based authentication tickets.</span></span> <span data-ttu-id="00d7b-282">Ancak, tanımlama bilgisi olmayan kimlik doğrulama biletlerini doğrudan URL'de kimlik doğrulaması bileti ekli olduğundan yeniden yürütme saldırılarını daha fazladır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-282">However, cookieless authentication tickets are more prone to replay attacks since the authentication ticket is embedded directly in the URL.</span></span> <span data-ttu-id="00d7b-283">Bir Web sitesini ziyaret eder, oturum açtığında ve bir iş arkadaşınıza e-posta içinde URL gönderebilir bir kullanıcı düşünün.</span><span class="sxs-lookup"><span data-stu-id="00d7b-283">Imagine a user who visits a website, logs in, and then pastes the URL in an email to a colleague.</span></span> <span data-ttu-id="00d7b-284">Süre sonu ulaşılmadan önce iş arkadaşı bu bağlantıyı tıklattığında, bunlar e-posta gönderen bir kullanıcı olarak kaydedilir!</span><span class="sxs-lookup"><span data-stu-id="00d7b-284">If the colleague clicks on that link before the expiry is reached, they will be logged in as the user who sent the email!</span></span>


## <a name="step-3-securing-the-authentication-ticket"></a><span data-ttu-id="00d7b-285">3. adım: kimlik doğrulaması bileti güvenliğini sağlama</span><span class="sxs-lookup"><span data-stu-id="00d7b-285">Step 3: Securing the Authentication Ticket</span></span>

<span data-ttu-id="00d7b-286">Forms kimlik doğrulaması bileti kablo üzerinden aktarılan ya da bir tanımlama bilgisi veya doğrudan URL'de katıştırılmış.</span><span class="sxs-lookup"><span data-stu-id="00d7b-286">The forms authentication ticket is transmitted over the wire either in a cookie or embedded directly within the URL.</span></span> <span data-ttu-id="00d7b-287">Kimlik bilgilerine ek olarak kimlik doğrulaması bileti (4. adımda göreceğiz gibi) kullanıcı verilerini de içerebilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-287">In addition to identity information, the authentication ticket can also include user data (as we will see in Step 4).</span></span> <span data-ttu-id="00d7b-288">Sonuç olarak, anahtar kişinin veri şifrelenir önemli gözetleyen gözler ve, (hatta daha da önemlisi) Form kimlik doğrulama sistemi ile bilet değiştirilmediğini garanti edebilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-288">Consequently, it is important that the ticket's data is encrypted from prying eyes and (even more importantly) that the forms authentication system can guarantee that the ticket was not tampered with.</span></span>

<span data-ttu-id="00d7b-289">Bilet ait verilerin gizliliği sağlamak için forms kimlik doğrulaması sistem bilet verilerini şifreleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-289">To ensure the privacy of the ticket's data, the forms authentication system can encrypt the ticket data.</span></span> <span data-ttu-id="00d7b-290">Bilet verileri şifrelemek için hata olası duyarlı bilgileri düz metin kablo üzerinden gönderir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-290">Failure to encrypt the ticket data sends potentially sensitive information over the wire in plain-text.</span></span>

<span data-ttu-id="00d7b-291">Bilet 's Orijinallik güvence altına almak için forms kimlik doğrulaması sistem gerekir *doğrulamak* anahtar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-291">To guarantee a ticket's authenticity, the forms authentication system must *validate* the ticket.</span></span> <span data-ttu-id="00d7b-292">Doğrulama verileri belirli bir parçasını değiştirilmedi ve aracılığıyla gerçekleştirilir sağlayarak eylemi olan bir  *[ileti kimlik doğrulama kodu (MAC)](http://en.wikipedia.org/wiki/Message_authentication_code)*.</span><span class="sxs-lookup"><span data-stu-id="00d7b-292">Validation is the act of ensuring that a particular piece of data has not been modified, and is accomplished via a *[message authentication code (MAC)](http://en.wikipedia.org/wiki/Message_authentication_code)*.</span></span> <span data-ttu-id="00d7b-293">Buna koysalar MAC bir küçük (Bu durumda bilet) doğrulanması gereken verileri tanımlayan bilgi parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-293">In a nutshell, the MAC is a small piece of information that identifies the data that needs to be validated (in this case, the ticket).</span></span> <span data-ttu-id="00d7b-294">MAC tarafından temsil edilen veri değiştirilirse, daha sonra MAC ve veri eşleşmemesidir değil.</span><span class="sxs-lookup"><span data-stu-id="00d7b-294">If the data represented by the MAC is modified, then the MAC and the data will not match up.</span></span> <span data-ttu-id="00d7b-295">Ayrıca, hem verileri değiştirebilir ve kendi MAC değiştirilmiş verilerle karşılık gelecek şekilde oluşturmak bir bilgisayar korsanının pkı'ya zordur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-295">Moreover, it is computationally hard for a hacker to both modify the data and generate his own MAC to correspond with the modified data.</span></span>

<span data-ttu-id="00d7b-296">Oluşturma (veya değiştirme olduğunda) bilet, forms kimlik doğrulaması sistem MAC oluşturur ve bilet ait verileri ekler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-296">When creating (or modifying) a ticket, the forms authentication system creates a MAC and attaches it to the ticket's data.</span></span> <span data-ttu-id="00d7b-297">Bir sonraki istek ulaştığında, forms kimlik doğrulaması sistem bilet verileri özgünlüğünü doğrulamak için MAC ve bilet verilerini karşılaştırır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-297">When a subsequent request arrives, the forms authentication system compares the MAC and ticket data to validate the authenticity of the ticket data.</span></span> <span data-ttu-id="00d7b-298">Şekil 3 grafik bu iş akışı gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-298">Figure 3 illustrates this workflow graphically.</span></span>


<span data-ttu-id="00d7b-299">[![Bilet'ın Orijinallik Sertifikası ile bir MAC güvence altına](forms-authentication-configuration-and-advanced-topics-cs/_static/image8.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-299">[![The Ticket's Authenticity is Ensured through a MAC](forms-authentication-configuration-and-advanced-topics-cs/_static/image8.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image7.png)</span></span>

<span data-ttu-id="00d7b-300">**Şekil 03**: MAC anahtarı'nın Orijinallik güvence altına ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-300">**Figure 03**: The Ticket's Authenticity is Ensured through a MAC ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image9.png))</span></span>


<span data-ttu-id="00d7b-301">Kimlik doğrulaması bileti için hangi güvenlik önlemleri uygulanan koruma ayarına bağlıdır. &lt;forms&gt; öğesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-301">What security measures are applied to the authentication ticket depends on the protection setting in the &lt;forms&gt; element.</span></span> <span data-ttu-id="00d7b-302">Koruma ayarı şu üç değerden birini atanabilir:</span><span class="sxs-lookup"><span data-stu-id="00d7b-302">The protection setting may be assigned to one of the following three values:</span></span>

- <span data-ttu-id="00d7b-303">Tüm - raporu her ikisi de şifrelenir ve dijital olarak imzalanmış (varsayılan).</span><span class="sxs-lookup"><span data-stu-id="00d7b-303">All - the ticket is both encrypted and digitally signed (the default).</span></span>
- <span data-ttu-id="00d7b-304">Şifreleme - yalnızca şifreleme uygulanan - hiçbir MAC oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-304">Encryption - only encryption is applied - no MAC is generated.</span></span>
- <span data-ttu-id="00d7b-305">Hiçbiri - bilet, şifrelenmiş ne dijital olarak imzalanmış.</span><span class="sxs-lookup"><span data-stu-id="00d7b-305">None - the ticket is neither encrypted nor digitally signed.</span></span>
- <span data-ttu-id="00d7b-306">Doğrulama - MAC oluşturulur, ancak bilet verileri düz metin kablo üzerinden gönderilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-306">Validation - a MAC is generated, but the ticket data is sent over the wire in plain-text.</span></span>

<span data-ttu-id="00d7b-307">Microsoft tüm ayarı kullanarak önerir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-307">Microsoft strongly recommends using the All setting.</span></span>

### <a name="setting-the-validation-and-decryption-keys"></a><span data-ttu-id="00d7b-308">Doğrulama ve şifre çözme anahtarları ayarlama</span><span class="sxs-lookup"><span data-stu-id="00d7b-308">Setting the Validation and Decryption Keys</span></span>

<span data-ttu-id="00d7b-309">Şifreleme ve karma algoritmaları şifrelemek ve kimlik doğrulaması bileti doğrulamak için forms kimlik doğrulaması sistemi tarafından kullanılan özelleştirilebilir aracılığıyla [ &lt;machineKey&gt; öğesi](https://msdn.microsoft.com/library/w8h3skw9.aspx) Web.config dosyasında. Tablo 2 anahatları &lt;machineKey&gt; öğenin özniteliklerini ve olası değerleri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-309">The encryption and hashing algorithms used by the forms authentication system to encrypt and validate the authentication ticket are customizable through the [&lt;machineKey&gt; element](https://msdn.microsoft.com/library/w8h3skw9.aspx) in Web.config. Table 2 outlines the &lt;machineKey&gt; element's attributes and their possible values.</span></span>

| <span data-ttu-id="00d7b-310">**Özniteliği**</span><span class="sxs-lookup"><span data-stu-id="00d7b-310">**Attribute**</span></span> | <span data-ttu-id="00d7b-311">**Açıklama**</span><span class="sxs-lookup"><span data-stu-id="00d7b-311">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="00d7b-312">şifre çözme</span><span class="sxs-lookup"><span data-stu-id="00d7b-312">decryption</span></span> | <span data-ttu-id="00d7b-313">Şifreleme için kullanılan algoritmayı belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-313">Indicates the algorithm used for encryption.</span></span> <span data-ttu-id="00d7b-314">Bu öznitelik aşağıdaki dört değerden birini içerebilir: - otomatik - varsayılan; decryptionKey özniteliğinin uzunluğuna göre algoritmasını belirler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-314">This attribute can have one of the following four values: - Auto - the default; determines the algorithm based on the length of the decryptionKey attribute.</span></span> <span data-ttu-id="00d7b-315">-AES - kullanır [Gelişmiş Şifreleme Standardı (AES)](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard) algoritması.</span><span class="sxs-lookup"><span data-stu-id="00d7b-315">- AES - uses the [Advanced Encryption Standard (AES)](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard) algorithm.</span></span> <span data-ttu-id="00d7b-316">-DES - kullanır [veri şifreleme standardı (DES)](http://en.wikipedia.org/wiki/Data_Encryption_Standard) bu algoritma pkı'ya zayıf kabul edilir ve kullanılmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-316">- DES - uses the [Data Encryption Standard (DES)](http://en.wikipedia.org/wiki/Data_Encryption_Standard) This algorithm is considered computationally weak and should not be used.</span></span> <span data-ttu-id="00d7b-317">-3DES - kullanır [Üçlü DES](http://en.wikipedia.org/wiki/Triple_DES) DES algoritması üç kez Adınızdaki algoritması.</span><span class="sxs-lookup"><span data-stu-id="00d7b-317">- 3DES - uses the [Triple DES](http://en.wikipedia.org/wiki/Triple_DES) algorithm, which works by applying the DES algorithm three times.</span></span> |
| <span data-ttu-id="00d7b-318">decryptionKey</span><span class="sxs-lookup"><span data-stu-id="00d7b-318">decryptionKey</span></span> | <span data-ttu-id="00d7b-319">Şifreleme algoritması tarafından kullanılan gizli anahtarı.</span><span class="sxs-lookup"><span data-stu-id="00d7b-319">The secret key used by the encryption algorithm.</span></span> <span data-ttu-id="00d7b-320">Bu değer (şifre çözme değeri göre) uygun uzunluğu, otomatik olarak üret veya iki değer, eklenen bir onaltılık dize olmalıdır IsolateApps.</span><span class="sxs-lookup"><span data-stu-id="00d7b-320">This value must either be a hexadecimal string of the appropriate length (based on the value in decryption), AutoGenerate, or either value appended with,IsolateApps.</span></span> <span data-ttu-id="00d7b-321">IsolateApps ekleme her uygulama için benzersiz bir değer kullanmak için ASP.NET bildirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-321">Adding IsolateApps instructs ASP.NET to use a unique value for each application.</span></span> <span data-ttu-id="00d7b-322">Kaydın, IsolateApps varsayılandır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-322">The default is AutoGenerate,IsolateApps.</span></span> |
| <span data-ttu-id="00d7b-323">doğrulama</span><span class="sxs-lookup"><span data-stu-id="00d7b-323">validation</span></span> | <span data-ttu-id="00d7b-324">Doğrulama için kullanılan algoritmayı belirtir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-324">Indicates the algorithm used for validation.</span></span> <span data-ttu-id="00d7b-325">Bu öznitelik aşağıdaki dört değerden birini içerebilir: - AES - Gelişmiş Şifreleme Standardı (AES) algoritması kullanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-325">This attribute can have one of the following four values: - AES - uses the Advanced Encryption Standard (AES) algorithm.</span></span> <span data-ttu-id="00d7b-326">-MD5 - kullanan [İleti Özeti 5 (MD5)](http://en.wikipedia.org/wiki/MD5) algoritması.</span><span class="sxs-lookup"><span data-stu-id="00d7b-326">- MD5 - uses the [Message-Digest 5 (MD5)](http://en.wikipedia.org/wiki/MD5) algorithm.</span></span> <span data-ttu-id="00d7b-327">-SHA1 - kullanan [SHA1](http://en.wikipedia.org/wiki/Sha1) algoritması (varsayılan).</span><span class="sxs-lookup"><span data-stu-id="00d7b-327">- SHA1 - uses the [SHA1](http://en.wikipedia.org/wiki/Sha1) algorithm (the default).</span></span> <span data-ttu-id="00d7b-328">-3DES - Üçlü DES algoritması kullanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-328">- 3DES - uses the Triple DES algorithm.</span></span> |
| <span data-ttu-id="00d7b-329">validationKey</span><span class="sxs-lookup"><span data-stu-id="00d7b-329">validationKey</span></span> | <span data-ttu-id="00d7b-330">Doğrulama algoritması tarafından kullanılan gizli anahtarı.</span><span class="sxs-lookup"><span data-stu-id="00d7b-330">The secret key used by the validation algorithm.</span></span> <span data-ttu-id="00d7b-331">Bu değer (doğrulanması değere göre) uygun uzunluğu, otomatik olarak üret veya iki değer, eklenen bir onaltılık dize olmalıdır IsolateApps.</span><span class="sxs-lookup"><span data-stu-id="00d7b-331">This value must either be a hexadecimal string of the appropriate length (based on the value in validation), AutoGenerate, or either value appended with,IsolateApps.</span></span> <span data-ttu-id="00d7b-332">IsolateApps ekleme her uygulama için benzersiz bir değer kullanmak için ASP.NET bildirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-332">Adding IsolateApps instructs ASP.NET to use a unique value for each application.</span></span> <span data-ttu-id="00d7b-333">Kaydın, IsolateApps varsayılandır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-333">The default is AutoGenerate,IsolateApps.</span></span> |

<span data-ttu-id="00d7b-334">**Tablo 2**: &lt;machineKey&gt; öğesi özniteliklerini</span><span class="sxs-lookup"><span data-stu-id="00d7b-334">**Table 2**: The &lt;machineKey&gt; Element Attributes</span></span>

<span data-ttu-id="00d7b-335">Bu şifreleme ve doğrulama seçenekleri ve uzmanları kapsamlı bir tartışma avantajlarını ve dezavantajlarını çeşitli algoritmalar, Bu öğretici kapsamında değildir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-335">A thorough discussion of these encryption and validation options, and the pros and cons of the various algorithms, is beyond the scope of this tutorial.</span></span> <span data-ttu-id="00d7b-336">Bir ayrıntılı aramak için kullanmak için şifreleme ve doğrulama algoritmaları yönergeler de dahil olmak üzere, bu sorunları adresindeki kullanmak için hangi anahtar uzunlukları ve bu anahtarları oluştur, başvurmak en iyi nasıl *Professional ASP.NET 2.0 güvenlik, üyelik ve rol yönetimi* .</span><span class="sxs-lookup"><span data-stu-id="00d7b-336">For an in-depth look at these issues, including guidance on what encryption and validation algorithms to use, what key lengths to use, and how best to generate these keys, refer to *Professional ASP.NET 2.0 Security, Membership, and Role Management*.</span></span>

<span data-ttu-id="00d7b-337">Varsayılan olarak, şifreleme ve doğrulama için kullanılan anahtarların her uygulama için otomatik olarak oluşturulur ve bu anahtarları yerel güvenlik yetkilisi (LSA) depolanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-337">By default, the keys used for encryption and validation are generated automatically for each application, and these keys are stored in the Local Security Authority (LSA).</span></span> <span data-ttu-id="00d7b-338">Kısacası, varsayılan ayarlarını benzersiz anahtarlar, bir web sunucusu web sunucusu ve uygulama uygulaması temel garanti.</span><span class="sxs-lookup"><span data-stu-id="00d7b-338">In short, the default settings guarantee unique keys on a web server-by-web server and application-by-application basis.</span></span> <span data-ttu-id="00d7b-339">Sonuç olarak, bu varsayılan davranışı iki aşağıdaki senaryolar için çalışmaz:</span><span class="sxs-lookup"><span data-stu-id="00d7b-339">Consequently, this default behavior will not work for the two following scenarios:</span></span>

- <span data-ttu-id="00d7b-340">**Web grupları** - bir [web grubu](http://en.wikipedia.org/wiki/Web_farm) senaryo, bir tek bir web uygulaması, ölçeklenebilirlik ve artıklık amacıyla birden çok web sunucusu üzerinde barındırılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-340">**Web Farms** - in a [web farm](http://en.wikipedia.org/wiki/Web_farm) scenario, a single web application is hosted on multiple web servers for purposes of scalability and redundancy.</span></span> <span data-ttu-id="00d7b-341">Her gelen istek, bir kullanıcının oturumunu ömrü boyunca, farklı sunucular çeşitli kendi isteklerini işlemek için kullanılabilir anlamı bir gruptaki sunucusuna gönderilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-341">Each incoming request is dispatched to a server in the farm, meaning that over the lifetime of a user's session, different servers may be used to handle his various requests.</span></span> <span data-ttu-id="00d7b-342">Sonuç olarak, forms kimlik doğrulaması bileti oluşturulan her sunucu aynı şifreleme ve doğrulama anahtarları kullanmalıdır, şifrelenmiş ve doğrulanmış üzerinde bir sunucu şifresi ve gruptaki başka bir sunucuya doğrulandı.</span><span class="sxs-lookup"><span data-stu-id="00d7b-342">Consequently, each server must use the same encryption and validation keys so that the forms authentication ticket created, encrypted, and validated on one server can be decrypted and validated on a different server in the farm.</span></span>
- <span data-ttu-id="00d7b-343">**Bilet uygulama paylaşımı arası** -tek bir web sunucusu birden çok ASP.NET uygulaması barındırabilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-343">**Cross Application Ticket Sharing** - a single web server may host multiple ASP.NET applications.</span></span> <span data-ttu-id="00d7b-344">Bu farklı uygulamaları tek forms kimlik doğrulaması bileti paylaşmak ihtiyacınız varsa, kendi şifreleme ve doğrulama anahtarları eşleştiğini zorunludur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-344">If you need for these different applications to share a single forms authentication ticket, it is imperative that their encryption and validation keys match up.</span></span>

<span data-ttu-id="00d7b-345">Bir web grubunda ayarlama veya aynı sunucu üzerinde uygulamalar arasında kimlik doğrulama biletlerini paylaşımı çalışırken yapılandırmanız gerekecektir &lt;machineKey&gt; etkilenen uygulamaları öğesinde böylece kendi decryptionKey ve validationKey değerleri eşleşme.</span><span class="sxs-lookup"><span data-stu-id="00d7b-345">When working in a web farm setting or sharing authentication tickets across applications on the same server, you will need to configure the &lt;machineKey&gt; element in the affected applications so that their decryptionKey and validationKey values match up.</span></span>

<span data-ttu-id="00d7b-346">Yukarıdaki senaryoların hiçbiri örnek uygulamamız uygularken size hala açık decryptionKey validationKey değerlerini belirtin ve kullanılacak algoritmaları tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-346">While neither of the above scenarios applies to our sample application, we can still specify explicit decryptionKey and validationKey values and define the algorithms to be used.</span></span> <span data-ttu-id="00d7b-347">Ekleme bir &lt;machineKey&gt; Web.config dosyasına ayarı:</span><span class="sxs-lookup"><span data-stu-id="00d7b-347">Add a &lt;machineKey&gt; setting to the Web.config file:</span></span>

[!code-xml[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample5.xml)]

<span data-ttu-id="00d7b-348">Daha fazla bilgi için kullanıma [nasıl yapılır: ASP.NET 2.0 MachineKey Yapılandırma](https://msdn.microsoft.com/library/ms998288.aspx).</span><span class="sxs-lookup"><span data-stu-id="00d7b-348">For more information check out [How To: Configure MachineKey in ASP.NET 2.0](https://msdn.microsoft.com/library/ms998288.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-349">DecryptionKey ve validationKey değerleri gelen gerçekleştirilen [Steve Gibson](http://www.grc.com/stevegibson.htm)'s [kusursuz parolaları web sayfası](https://www.grc.com/passwords.htm), her sayfasını ziyaret edin 64 rastgele onaltılı karakter oluşturur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-349">The decryptionKey and validationKey values were taken from [Steve Gibson](http://www.grc.com/stevegibson.htm)'s [Perfect Passwords web page](https://www.grc.com/passwords.htm), which generates 64 random hexadecimal characters on each page visit.</span></span> <span data-ttu-id="00d7b-350">Bu anahtarları üretim uygulamalarınıza yollarını yapma olasılığını azaltmak için mükemmel parolaları sayfa rastgele oluşturulmuş olanlardan yukarıdaki anahtarları yerine kullanmaları önerilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-350">To lessen the likelihood of these keys making their way into your production applications, you are encouraged to replace the above keys with randomly generated ones from the Perfect Passwords page.</span></span>


## <a name="step-4-storing-additional-user-data-in-the-ticket"></a><span data-ttu-id="00d7b-351">4. adım: Bilet ek kullanıcı verilerini depolama</span><span class="sxs-lookup"><span data-stu-id="00d7b-351">Step 4: Storing Additional User Data in the Ticket</span></span>

<span data-ttu-id="00d7b-352">Birçok web uygulamaları hakkında bilgileri görüntülemek veya şu anda oturum açmış kullanıcıya sayfanın görüntüleme temel.</span><span class="sxs-lookup"><span data-stu-id="00d7b-352">Many web applications display information about or base the page's display on the currently logged on user.</span></span> <span data-ttu-id="00d7b-353">Örneğin, bir web sayfasında kullanıcı adını ve son her sayfanın üst köşedeki açmışken tarih gösterebilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-353">For example, a web page might show the user's name and the date she last logged on in the upper corner of every page.</span></span> <span data-ttu-id="00d7b-354">Forms kimlik doğrulaması bileti şu anda oturum açmış kullanıcının kullanıcı adını depolar, ancak herhangi bir bilgi gerektiğinde sayfa kimlik doğrulaması bileti depolanmadığından bilgi aramak için kullanıcı deposuna - genellikle bir veritabanı - gitmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-354">The forms authentication ticket stores the currently logged on user's username, but when any other information is needed, the page must go to the user store - typically a database - to lookup the information not stored in the authentication ticket.</span></span>

<span data-ttu-id="00d7b-355">Biraz kod ile biz forms kimlik doğrulaması bileti ek kullanıcı bilgilerini depolayabilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-355">With a little bit of code we can store additional user information in the forms authentication ticket.</span></span> <span data-ttu-id="00d7b-356">Bu tür veriler ifade edilebilir [FormsAuthenticationTicket sınıfı](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.aspx)'s [UserData özelliği](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.userdata.aspx).</span><span class="sxs-lookup"><span data-stu-id="00d7b-356">Such data can be expressed through the [FormsAuthenticationTicket class](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.aspx)'s [UserData property](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.userdata.aspx).</span></span> <span data-ttu-id="00d7b-357">Bu, genellikle gereken kullanıcı hakkındaki bilgileri küçük miktarda koymak için yararlı bir yerdir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-357">This is a useful place to put small amounts of information about the user that is commonly needed.</span></span> <span data-ttu-id="00d7b-358">UserData özelliği parçası olarak kimlik doğrulaması bileti tanımlama bilgisinin ve diğer bilet alanları gibi dahil edilmiştir, şifrelenir ve doğrulanması için belirtilen değer forms kimlik doğrulaması sistemin yapılandırmasına bağlı olarak.</span><span class="sxs-lookup"><span data-stu-id="00d7b-358">The value specified in the UserData property is included as part of the authentication ticket cookie and, like the other ticket fields, is encrypted and validated based on the forms authentication system's configuration.</span></span> <span data-ttu-id="00d7b-359">Varsayılan olarak, UserData boş bir dizedir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-359">By default, UserData is an empty string.</span></span>

<span data-ttu-id="00d7b-360">Kimlik doğrulaması bileti kullanıcı verilerini depolamak için size kullanıcıya özgü bilgileri alan ve bilet depolayan oturum açma sayfasındaki biraz kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-360">In order to store user data in the authentication ticket, we need to write a bit of code in the login page that grabs the user-specific information and stores it in the ticket.</span></span> <span data-ttu-id="00d7b-361">İçinde depolanan veriler, düzgün şekilde UserData dize türünde bir özellik olduğundan, bir dize olarak serileştirilmiş gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-361">Since UserData is a property of type string, the data stored in it must be properly serialized as a string.</span></span> <span data-ttu-id="00d7b-362">Örneğin, her kullanıcının doğum tarihi ve bunların İşveren adını bizim kullanıcı deposu dahil ve biz bu iki özellik değerlerini kimlik doğrulaması bileti saklamak istediğinizi düşünün.</span><span class="sxs-lookup"><span data-stu-id="00d7b-362">For example, imagine that our user store included each user's date of birth and the name of their employer, and we wanted to store these two property values in the authentication ticket.</span></span> <span data-ttu-id="00d7b-363">Biz bu değerleri bir dize olarak İşveren adından kullanıcının tarih Doğum'ın dizesinin dikey çizgi (|) ile birleştirerek seri hale.</span><span class="sxs-lookup"><span data-stu-id="00d7b-363">We could serialize these values into a string by concatenating the user's date of birth's string with a pipe ( | ), followed by the employer name.</span></span> <span data-ttu-id="00d7b-364">Northwind Traders çalışan 15 Ağustos 1974 doğacak bir kullanıcı için biz UserData özelliği dize atamanız gerekir: 1974-08-15 | Northwind Traders.</span><span class="sxs-lookup"><span data-stu-id="00d7b-364">For a user born on August 15, 1974 that works for Northwind Traders, we would assign the UserData property the string: 1974-08-15|Northwind Traders .</span></span>

<span data-ttu-id="00d7b-365">Bilet depolanan verilere erişmek ihtiyacımız olduğunda, biz geçerli isteğin FormsAuthenticationTicket ele geçirme ve UserData özelliği seri bunu yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-365">Whenever we need to access the data stored in the ticket, we can do so by grabbing the current request's FormsAuthenticationTicket and deserializing the UserData property.</span></span> <span data-ttu-id="00d7b-366">Doğum ve İşveren adı örneği tarih söz konusu olduğunda, biz UserData dize iki alt dizeler (|) sınırlayıcıyı kullanarak Böl.</span><span class="sxs-lookup"><span data-stu-id="00d7b-366">In the case of the date of birth and employer name example, we would split the UserData string into two substrings based on the delimiter ( | ).</span></span>


<span data-ttu-id="00d7b-367">[![Ek kullanıcı bilgilerini kimlik doğrulaması bileti depolanabilir](forms-authentication-configuration-and-advanced-topics-cs/_static/image11.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-367">[![Additional User Information Can Be Stored in the Authentication Ticket](forms-authentication-configuration-and-advanced-topics-cs/_static/image11.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image10.png)</span></span>

<span data-ttu-id="00d7b-368">**Şekil 04**: ek kullanıcı bilgileri depolanabilir kimlik doğrulaması bileti ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-368">**Figure 04**: Additional User Information Can Be Stored in the Authentication Ticket ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image12.png))</span></span>


### <a name="writing-information-to-userdata"></a><span data-ttu-id="00d7b-369">UserData bilgi yazma</span><span class="sxs-lookup"><span data-stu-id="00d7b-369">Writing Information to UserData</span></span>

<span data-ttu-id="00d7b-370">Ne yazık ki, forms kimlik doğrulaması bileti için kullanıcıya özgü bilgileri ekleyerek bir bekleyebilirsiniz kadar basit değil.</span><span class="sxs-lookup"><span data-stu-id="00d7b-370">Unfortunately, adding user-specific information to a forms authentication ticket is not as straightforward as one might expect.</span></span> <span data-ttu-id="00d7b-371">FormsAuthenticationTicket sınıfının UserData özelliği salt okunurdur ve yalnızca FormsAuthenticationTicket sınıf oluşturucu kullanılarak belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-371">The UserData property of the FormsAuthenticationTicket class is read-only and can only be specified through the FormsAuthenticationTicket class constructor.</span></span> <span data-ttu-id="00d7b-372">UserData özellik oluşturucuda belirtirken, biz de bilet kullanıcının diğer değerler sağlamanız gerekir: kullanıcı adı, tarihi, sona erme ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-372">When specifying the UserData property in the constructor, we also need to provide the ticket's other values: the username, the issue date, the expiration, and so on.</span></span> <span data-ttu-id="00d7b-373">Oturum açma sayfasına önceki öğreticide oluşturduğunuzda bu tüm bize FormsAuthentication sınıfı tarafından işlendi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-373">When we created the login page in the preceding tutorial, this was all handled for us by the FormsAuthentication class.</span></span> <span data-ttu-id="00d7b-374">UserData FormsAuthenticationTicket eklerken, biz zaten FormsAuthentication sınıfı tarafından sağlanan işlevlerinin çoğunu çoğaltmak için kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-374">When adding UserData to the FormsAuthenticationTicket, we will need to write code to replicate much of the functionality already provided by the FormsAuthentication class.</span></span>

<span data-ttu-id="00d7b-375">Kullanıcı kimlik doğrulaması bileti için ilgili ek bilgileri kaydetmek için Login.aspx sayfasına güncelleştirerek UserData ile çalışmak için gerekli kodu inceleyelim.</span><span class="sxs-lookup"><span data-stu-id="00d7b-375">Let's explore the necessary code for working with UserData by updating the Login.aspx page to record additional information about the user to the authentication ticket.</span></span> <span data-ttu-id="00d7b-376">Bizim kullanıcı deposunda kullanıcının çalıştığı şirketin ve bunların başlık hakkında bilgi içerir ve bu bilgileri kimlik doğrulaması bileti yakalamak istiyoruz içeriğini.</span><span class="sxs-lookup"><span data-stu-id="00d7b-376">Pretend that our user store contains information about the company the user works for and their title, and that we want to capture this information in the authentication ticket.</span></span> <span data-ttu-id="00d7b-377">Login.aspx sayfanın Oturum Aç düğmesini Click olay işleyicisi güncelleştirin, böylece kodu aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="00d7b-377">Update the Login.aspx page's LoginButton Click event handler so that the code looks like the following:</span></span>

[!code-csharp[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample6.cs)]

<span data-ttu-id="00d7b-378">Şimdi bu kodu bir çizgi geçen bir kerede adım.</span><span class="sxs-lookup"><span data-stu-id="00d7b-378">Let's step through this code one line at a time.</span></span> <span data-ttu-id="00d7b-379">Dört dize diziler tanımlayarak yöntemi başlatır: kullanıcıları, parolaları, ŞirketAdı ve titleAtCompany.</span><span class="sxs-lookup"><span data-stu-id="00d7b-379">The method starts by defining four string arrays: users, passwords, companyName, and titleAtCompany.</span></span> <span data-ttu-id="00d7b-380">Bu diziler kullanıcı adları, parolalar, şirket adlarını ve başlıkları kullanıcı hesapları için sistemde, üç var olan tutun: Scott, Jisun ve Sam.</span><span class="sxs-lookup"><span data-stu-id="00d7b-380">These arrays hold the usernames, passwords, company names, and titles for the user accounts in the system, of which there are three: Scott, Jisun, and Sam.</span></span> <span data-ttu-id="00d7b-381">Gerçek bir uygulamada, kullanıcı mağazadan sayfanın kaynak kodunda kodlanmış değil, bu değerleri seçmeleri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-381">In a real application, these values would be queried from the user store, not hard-coded in the page's source code.</span></span>

<span data-ttu-id="00d7b-382">Sağlanan kimlik bilgilerinin geçerli olsaydı önceki öğreticide, biz yalnızca, aşağıdaki adımları gerçekleştirilen FormsAuthentication.RedirectFromLoginPage (UserName.Text, RememberMe.Checked) adlı:</span><span class="sxs-lookup"><span data-stu-id="00d7b-382">In the previous tutorial, if the supplied credentials were valid we simply called FormsAuthentication.RedirectFromLoginPage(UserName.Text, RememberMe.Checked), which performed the following steps:</span></span>

1. <span data-ttu-id="00d7b-383">Forms kimlik doğrulaması bileti oluşturuldu</span><span class="sxs-lookup"><span data-stu-id="00d7b-383">Created the forms authentication ticket</span></span>
2. <span data-ttu-id="00d7b-384">Bilet uygun depoya yazıldı.</span><span class="sxs-lookup"><span data-stu-id="00d7b-384">Wrote the ticket to the appropriate store.</span></span> <span data-ttu-id="00d7b-385">Tanımlama bilgisi tabanlı kimlik doğrulama biletlerini tarayıcının tanımlama bilgileri koleksiyonu kullanılır; cookieless kimlik doğrulama biletlerini URL'ye bilet verilerini seri</span><span class="sxs-lookup"><span data-stu-id="00d7b-385">For cookies-based authentication tickets, the browser's cookies collection is used; for cookieless authentication tickets, the ticket data is serialized into the URL</span></span>
3. <span data-ttu-id="00d7b-386">Kullanıcı uygun sayfaya yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-386">Redirected the user to the appropriate page</span></span>

<span data-ttu-id="00d7b-387">Bu adımları Yukarıdaki kod çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-387">These steps are replicated in the code above.</span></span> <span data-ttu-id="00d7b-388">İlk olarak, biz sonunda UserData özelliğinde depolayacak dize şirket adı ve bir dikey çizgi (|) ile iki değer sınırlandırma başlık birleştirerek biçimlendirilmemiş.</span><span class="sxs-lookup"><span data-stu-id="00d7b-388">First, the string we will eventually store in the UserData property is formed by combining the company name and the title, delimiting the two values with a pipe character ( | ).</span></span>

<span data-ttu-id="00d7b-389">userDataString dize = dize. Concat (ŞirketAdı [i] "|", titleAtCompany[i]);</span><span class="sxs-lookup"><span data-stu-id="00d7b-389">string userDataString = string.Concat(companyName[i], "|", titleAtCompany[i]);</span></span>

<span data-ttu-id="00d7b-390">Ardından, kimlik doğrulaması bileti oluşturur, yöntemi çağrılır, FormsAuthentication.GetAuthCookie şifreler ve yapılandırma ayarlarını göre doğrular ve HttpCookie nesneyi yerleştirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-390">Next, the FormsAuthentication.GetAuthCookie method is invoked, which creates the authentication ticket, encrypts and validates it according to the configuration settings, and places it in an HttpCookie object.</span></span>

<span data-ttu-id="00d7b-391">HttpCookie authCookie = FormsAuthentication.GetAuthCookie(UserName.Text, RememberMe.Checked);</span><span class="sxs-lookup"><span data-stu-id="00d7b-391">HttpCookie authCookie = FormsAuthentication.GetAuthCookie(UserName.Text, RememberMe.Checked);</span></span>

<span data-ttu-id="00d7b-392">Tanımlama bilgisi içinde katıştırılmış FormAuthenticationTicket çalışmak için FormAuthentication sınıfının çağırmak ihtiyacımız [şifresini yöntemi](https://msdn.microsoft.com/library/system.web.security.formsauthentication.decrypt.aspx), geçen tanımlama bilgisi değeri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-392">In order to work with the FormAuthenticationTicket embedded within the cookie, we need to call the FormAuthentication class's [Decrypt method](https://msdn.microsoft.com/library/system.web.security.formsauthentication.decrypt.aspx), passing in the cookie value.</span></span>

<span data-ttu-id="00d7b-393">FormsAuthenticationTicket bilet FormsAuthentication.Decrypt(authCookie.Value); =</span><span class="sxs-lookup"><span data-stu-id="00d7b-393">FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(authCookie.Value);</span></span>

<span data-ttu-id="00d7b-394">Ardından oluşturuyoruz bir *yeni* FormsAuthenticationTicket örnek tabanlı varolan FormsAuthenticationTicket'ın değerleri.</span><span class="sxs-lookup"><span data-stu-id="00d7b-394">We then create a *new* FormsAuthenticationTicket instance based on the existing FormsAuthenticationTicket's values.</span></span> <span data-ttu-id="00d7b-395">Ancak, bu yeni anahtarı (userDataString) kullanıcıya özgü bilgileri içerir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-395">However, this new ticket includes the user-specific information (userDataString).</span></span>

<span data-ttu-id="00d7b-396">FormsAuthenticationTicket newTicket = yeni FormsAuthenticationTicket (bileti. Sürüm, bilet. Anahtar adı. İssueDate, bilet. Süre sonu, bilet. IsPersistent, userDataString);</span><span class="sxs-lookup"><span data-stu-id="00d7b-396">FormsAuthenticationTicket newTicket = new FormsAuthenticationTicket(ticket.Version, ticket.Name, ticket.IssueDate, ticket.Expiration, ticket.IsPersistent, userDataString);</span></span>

<span data-ttu-id="00d7b-397">Biz sonra şifrelemek (ve doğrula) çağırarak yeni FormsAuthenticationTicket örnek [yöntemi şifrelemek](https://msdn.microsoft.com/library/system.web.security.formsauthentication.encrypt.aspx)ve bu şifrelenmiş (ve doğrulanmış) verileri geri authCookie yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-397">We then encrypt (and validate) the new FormsAuthenticationTicket instance by calling the [Encrypt method](https://msdn.microsoft.com/library/system.web.security.formsauthentication.encrypt.aspx), and put this encrypted (and validated) data back into authCookie.</span></span>

<span data-ttu-id="00d7b-398">authCookie.Value = FormsAuthentication.Encrypt(newTicket);</span><span class="sxs-lookup"><span data-stu-id="00d7b-398">authCookie.Value = FormsAuthentication.Encrypt(newTicket);</span></span>

<span data-ttu-id="00d7b-399">Son olarak, authCookie Response.Cookies koleksiyonuna eklenir ve kullanıcıya göndermek için uygun sayfayı belirlemek için GetRedirectUrl yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-399">Finally, authCookie is added to the Response.Cookies collection and the GetRedirectUrl method is called to determine the appropriate page to send the user.</span></span>

[!code-csharp[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample7.cs)]

<span data-ttu-id="00d7b-400">Bu kod tümünün UserData özelliği salt okunur olduğundan ve FormsAuthentication sınıfı GetAuthCookie, SetAuthCookie veya RedirectFromLoginPage yöntemlerinden UserData bilgileri belirtmek için herhangi bir yöntem sağlamaz gereklidir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-400">All of this code is needed because the UserData property is read-only and the FormsAuthentication class does not provide any methods for specifying UserData information in its GetAuthCookie, SetAuthCookie, or RedirectFromLoginPage methods.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-401">Biz yalnızca incelenmesi kodunu bir tanımlama bilgisi tabanlı kimlik doğrulaması bileti kullanıcıya özgü bilgileri depolar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-401">The code we just examined stores user-specific information in a cookies-based authentication ticket.</span></span> <span data-ttu-id="00d7b-402">Forms kimlik doğrulaması bileti URL'ye serileştirmek için sorumlu .NET Framework iç sınıflarıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-402">The classes responsible for serializing the forms authentication ticket to the URL are internal to the .NET Framework.</span></span> <span data-ttu-id="00d7b-403">Yazıyı kısa, kullanıcı verilerini bir tanımlama bilgisi içermeyen forms kimlik doğrulaması bileti depolanamıyor.</span><span class="sxs-lookup"><span data-stu-id="00d7b-403">Long story short, you cannot store user data in a cookieless forms authentication ticket.</span></span>


### <a name="accessing-the-userdata-information"></a><span data-ttu-id="00d7b-404">UserData bilgilerine erişme</span><span class="sxs-lookup"><span data-stu-id="00d7b-404">Accessing the UserData Information</span></span>

<span data-ttu-id="00d7b-405">Bu noktada her kullanıcının şirket adı ve başlık depolanmış forms kimlik doğrulaması bileti 's UserData özelliğinde oturum açtığında.</span><span class="sxs-lookup"><span data-stu-id="00d7b-405">At this point each user's company name and title is stored in the forms authentication ticket's UserData property when they log in.</span></span> <span data-ttu-id="00d7b-406">Bu bilgiler kullanıcı deposuna seyahat gerek kalmadan herhangi bir sayfasında kimlik doğrulaması bileti erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-406">This information can be accessed from the authentication ticket on any page without requiring a trip to the user store.</span></span> <span data-ttu-id="00d7b-407">Bu bilgiler UserData özelliğinden nasıl alınabilir göstermek için yalnızca kullanıcı adını, ancak ayrıca çalıştıkları şirket ve bunların başlık Hoş Geldiniz iletisi içeren Default.aspx şimdi güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-407">To illustrate how this information can be retrieved from the UserData property, let's update Default.aspx so that its welcome message includes not only the user's name, but also the company they work for and their title.</span></span>

<span data-ttu-id="00d7b-408">Şu anda Default.aspx AuthenticatedMessagePanel Masası WelcomeBackMessage adlı bir etiket denetimi içerir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-408">Currently, Default.aspx contains an AuthenticatedMessagePanel Panel with a Label control named WelcomeBackMessage.</span></span> <span data-ttu-id="00d7b-409">Bu pano, yalnızca kimliği doğrulanmış kullanıcılara görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-409">This Panel is only displayed to authenticated users.</span></span> <span data-ttu-id="00d7b-410">Default.aspx'in sayfa kodunda güncelleştirme\_aşağıdaki gibi görünüyor. böylece olay işleyicisi yükleyin:</span><span class="sxs-lookup"><span data-stu-id="00d7b-410">Update the code in Default.aspx's Page\_Load event handler so that it looks like the following:</span></span>

[!code-csharp[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample8.cs)]

<span data-ttu-id="00d7b-411">Request.IsAuthenticated doğruysa sonra WelcomeBackMessage'nın metin özelliği ilk tekrar Hoş Geldiniz ayarlanır *kullanıcıadı*.</span><span class="sxs-lookup"><span data-stu-id="00d7b-411">If Request.IsAuthenticated is true, then the WelcomeBackMessage's Text property is first set to Welcome back, *username*.</span></span> <span data-ttu-id="00d7b-412">Ardından, biz temel FormsAuthenticationTicket erişebilmesi için User.Identity özelliği FormsIdentity nesnesine atamalısınız.</span><span class="sxs-lookup"><span data-stu-id="00d7b-412">Then, the User.Identity property is cast to a FormsIdentity object so that we can access the underlying FormsAuthenticationTicket.</span></span> <span data-ttu-id="00d7b-413">Biz FormsAuthenticationTicket sonra biz UserData özelliği başlık ve şirket adı seri durumdan çıkarır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-413">Once we have the FormsAuthenticationTicket, we deserialize the UserData property into the company name and title.</span></span> <span data-ttu-id="00d7b-414">Bu, dikey çizgi karakterinden dizesi ayırarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-414">This is accomplished by splitting the string on the pipe character.</span></span> <span data-ttu-id="00d7b-415">Başlık ve şirket adı WelcomeBackMessage etiketinde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-415">The company name and title are then displayed in the WelcomeBackMessage Label.</span></span>

<span data-ttu-id="00d7b-416">Şekil 5 eylemde Bu ekranının ekran görüntüsü gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-416">Figure 5 shows a screenshot of this display in action.</span></span> <span data-ttu-id="00d7b-417">Scott oturum açmayı Scott'ın şirket ve başlık içeren bir Hoş Geldiniz geri iletisi görüntüler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-417">Logging in as Scott displays a welcome back message that includes Scott's company and title.</span></span>


<span data-ttu-id="00d7b-418">[![Şu anda oturum açan kullanıcının şirket ve başlığı görüntülenir](forms-authentication-configuration-and-advanced-topics-cs/_static/image14.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-418">[![The Currently Logged On User's Company and Title are Displayed](forms-authentication-configuration-and-advanced-topics-cs/_static/image14.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image13.png)</span></span>

<span data-ttu-id="00d7b-419">**Şekil 05**: şu anda oturum açan kullanıcının şirket ve başlığı görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-419">**Figure 05**: The Currently Logged On User's Company and Title are Displayed ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="00d7b-420">Kimlik doğrulaması bileti 's UserData özelliği kullanıcı deposu için bir önbellek olarak görev yapar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-420">The authentication ticket's UserData property serves as a cache for the user store.</span></span> <span data-ttu-id="00d7b-421">Herhangi bir önbellek gibi temel veri değiştirildiğinde güncelleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-421">Like any cache, it needs to be updated when the underlying data is modified.</span></span> <span data-ttu-id="00d7b-422">Örneğin, kullanıcılar kendi profili güncelleştirebilir bir web sayfası ise, kullanıcı tarafından yapılan değişiklikleri yansıtacak şekilde UserData özelliğinde önbelleğe alanları yenilenmelidir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-422">For example, if there is a web page from which users can update their profile, the fields cached in the UserData property must be refreshed to reflect the changes made by the user.</span></span>


## <a name="step-5-using-a-custom-principal"></a><span data-ttu-id="00d7b-423">5. adım: özel esas kullanma</span><span class="sxs-lookup"><span data-stu-id="00d7b-423">Step 5: Using a Custom Principal</span></span>

<span data-ttu-id="00d7b-424">Her gelen isteğe göre FormsAuthenticationModule kullanıcının kimliğini doğrulamak çalışır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-424">On each incoming request the FormsAuthenticationModule attempts to authenticate the user.</span></span> <span data-ttu-id="00d7b-425">Süresi dolmuş olmayan kimlik doğrulama anahtarı varsa, FormsAuthenticationModule HttpContext.User özelliği için yeni bir GenericPrincipal nesnesi atar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-425">If a non-expired authentication ticket is present, the FormsAuthenticationModule assigns the HttpContext.User property to a new GenericPrincipal object.</span></span> <span data-ttu-id="00d7b-426">Bu GenericPrincipal nesne türü forms kimlik doğrulaması bileti için referans içeriyor FormsIdentity bir kimliğe sahip.</span><span class="sxs-lookup"><span data-stu-id="00d7b-426">This GenericPrincipal object has an Identity of type FormsIdentity, which includes a reference to the forms authentication ticket.</span></span> <span data-ttu-id="00d7b-427">GenericPrincipal sınıfı IPrincipal uygulayan bir sınıf tarafından gereken tam en az işlevselliği içerir - yalnızca bir kimlik özelliği ve IsInRole yöntemi vardır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-427">The GenericPrincipal class contains the bare minimum functionality needed by a class that implements IPrincipal - it just has an Identity property and an IsInRole method.</span></span>

<span data-ttu-id="00d7b-428">Asıl nesne iki sorumlulukları vardır: kullanıcının ait olduğu için hangi rollerin belirtmek ve kimlik bilgilerini sağlamak için.</span><span class="sxs-lookup"><span data-stu-id="00d7b-428">The principal object has two responsibilities: to indicate what roles the user belongs to and to provide identity information.</span></span> <span data-ttu-id="00d7b-429">Bu IPrincipal arabiriminin IsInRole gerçekleştirilir (*roleName*) yöntemini ve kimlik özelliği, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="00d7b-429">This is accomplished through the IPrincipal interface's IsInRole(*roleName*) method and Identity property, respectively.</span></span> <span data-ttu-id="00d7b-430">GenericPrincipal sınıfı Rol adlarının dize dizisi için kurucusu belirtilmesine olanak verir; kendi IsInRole (*roleName*) yöntemi yalnızca denetler olmadığını görmek için geçirilen içinde *roleName* içinde dize dizisi yok.</span><span class="sxs-lookup"><span data-stu-id="00d7b-430">The GenericPrincipal class allows for a string array of role names to be specified via its constructor; its IsInRole(*roleName*) method merely checks to see if the passed in *roleName* exists within the string array.</span></span> <span data-ttu-id="00d7b-431">FormsAuthenticationModule GenericPrincipal oluşturduğunda, boş bir dize dizisi GenericPrincipal'ın oluşturucuya geçirir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-431">When the FormsAuthenticationModule creates the GenericPrincipal, it passes in an empty string array to the GenericPrincipal's constructor.</span></span> <span data-ttu-id="00d7b-432">Sonuç olarak, tüm IsInRole çağrısına her zaman false döndürür.</span><span class="sxs-lookup"><span data-stu-id="00d7b-432">Consequently, any call to IsInRole will always return false.</span></span>

<span data-ttu-id="00d7b-433">GenericPrincipal sınıfı rolleri değil kullanıldığı çoğu forms tabanlı kimlik doğrulama senaryosu için gereksinimlerini karşılar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-433">The GenericPrincipal class meets the needs for most forms based authentication scenarios where roles are not used.</span></span> <span data-ttu-id="00d7b-434">Varsayılan rol işleme olduğu yetersiz bu durumlar için ya da özel bir kimlik nesnesi kullanıcı ile ilişkilendirmek gerektiğinde, kimlik doğrulama iş akışı sırasında özel bir IPrincipal nesnesi oluşturun ve HttpContext.User özelliğine atayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-434">For those situations where the default role handling is insufficient or when you need to associate a custom IIdentity object with the user, you can create a custom IPrincipal object during the authentication workflow and assign it to the HttpContext.User property.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-435">Öğreticiler, gelecekte göreceğiz olarak, ASP. NET'in rolleri framework etkin türünde bir özel asıl nesne oluşturur [RolePrincipal](https://msdn.microsoft.com/library/system.web.security.roleprincipal.aspx) ve forms kimlik doğrulaması oluşturulan GenericPrincipal nesnenin üzerine yazar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-435">As we will see in future tutorials, when ASP.NET's Roles framework is enabled it creates a custom principal object of type [RolePrincipal](https://msdn.microsoft.com/library/system.web.security.roleprincipal.aspx) and overwrites the forms authentication-created GenericPrincipal object.</span></span> <span data-ttu-id="00d7b-436">Rolleri framework'ün API ile arabirim oluşturmak için sorumlunun IsInRole yöntemi özelleştirmek için bunu yapar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-436">It does this in order to customize the principal's IsInRole method to interface with the Roles framework's API.</span></span>


<span data-ttu-id="00d7b-437">Biz kendisini rolleriyle henüz kaygı olmayan olduğundan, biz juncture en bu özel bir kural oluşturmak için olması gereken tek nedeni asıl özel bir kimlik nesnesine ilişkilendirilecek olacaktır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-437">Since we have not concerned ourselves with roles yet, the only reason we would have for creating a custom principal at this juncture would be to associate a custom IIdentity object to the principal.</span></span> <span data-ttu-id="00d7b-438">Adım 4'te ek kullanıcı bilgilerini özellikle de kimlik doğrulaması bileti 's UserData özelliğinde kullanıcının şirket adını ve bunların başlık depolamak Aranan.</span><span class="sxs-lookup"><span data-stu-id="00d7b-438">In Step 4 we looked at storing additional user information in the authentication ticket's UserData property, in particular the user's company name and their title.</span></span> <span data-ttu-id="00d7b-439">Ancak, UserData yalnızca kimlik doğrulaması bileti üzerinden erişilebilir ve biz bilet depolanan kullanıcı bilgilerini görüntülemek istediğiniz zaman UserData özelliği ayrıştırılamıyor ihtiyacımız, yani seri hale getirilmiş bir dize olarak sonra yalnızca bilgilerdir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-439">However, the UserData information is only accessible through the authentication ticket and only then as a serialized string, meaning that anytime we want to view the user information stored in the ticket we need to parse the UserData property.</span></span>

<span data-ttu-id="00d7b-440">IIdentity uygular ve ŞirketAdı ve başlık özellikleri içeren bir sınıf oluşturarak biz geliştirici deneyimi artırabilir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-440">We can improve the developer experience by creating a class that implements IIdentity and includes CompanyName and Title properties.</span></span> <span data-ttu-id="00d7b-441">Böylece, başlık ŞirketAdı ve başlık özellikleri olmadan aracılığıyla doğrudan UserData özelliği ayrıştırılamıyor nasıl bilmeniz gereken ve bir geliştirici şu anda oturum açmış kullanıcının şirket adı erişebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-441">That way, a developer can access the currently logged on user's company name and title directly through the CompanyName and Title properties without needed to know how to parse the UserData property.</span></span>

### <a name="creating-the-custom-identity-and-principal-classes"></a><span data-ttu-id="00d7b-442">Özel kimlik ve asıl sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="00d7b-442">Creating the Custom Identity and Principal Classes</span></span>

<span data-ttu-id="00d7b-443">Bu öğretici için özel asıl ve kimlik nesneleri uygulamada oluşturalım\_kod klasör.</span><span class="sxs-lookup"><span data-stu-id="00d7b-443">For this tutorial, let's create the custom principal and identity objects in the App\_Code folder.</span></span> <span data-ttu-id="00d7b-444">Bir uygulama eklemeye başlayın\_kod projenize klasörü - Çözüm Gezgini'nde proje adına sağ tıklayın, ASP.NET klasörü Ekle seçeneğini belirleyin ve uygulamayı seçin\_kodu.</span><span class="sxs-lookup"><span data-stu-id="00d7b-444">Start by adding an App\_Code folder to your project - right-click on the project name in Solution Explorer, select the Add ASP.NET Folder option, and choose App\_Code.</span></span> <span data-ttu-id="00d7b-445">Uygulama\_kodun klasörüdür sınıfı Web sitesine belirli dosyaları içeren özel bir ASP.NET klasör.</span><span class="sxs-lookup"><span data-stu-id="00d7b-445">The App\_Code folder is a special ASP.NET folder that holds class files specific to the website.</span></span>

> [!NOTE]
> <span data-ttu-id="00d7b-446">Uygulama\_kod klasörü, yalnızca projenizi Web sitesi proje modeli aracılığıyla yönetirken kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-446">The App\_Code folder should only be used when managing your project through the Website Project Model.</span></span> <span data-ttu-id="00d7b-447">Kullanıyorsanız [Web uygulama projesi modeli](https://msdn.microsoft.com/asp.net/Aa336618.aspx), standart bir klasör oluşturun ve sınıflar olarak ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-447">If you are using the [Web Application Project Model](https://msdn.microsoft.com/asp.net/Aa336618.aspx), create a standard folder and add the classes to that.</span></span> <span data-ttu-id="00d7b-448">Örneğin, sınıfları adlı yeni bir klasör ekleyin ve kodunuzu var. yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-448">For example, you could add a new folder named Classes, and place your code there.</span></span>


<span data-ttu-id="00d7b-449">Ardından, iki yeni sınıf dosyaları için uygulama ekleme\_kod klasörü, bir adlandırılmış CustomIdentity.cs ve bir adlı CustomPrincipal.cs.</span><span class="sxs-lookup"><span data-stu-id="00d7b-449">Next, add two new class files to the App\_Code folder, one named CustomIdentity.cs and one named CustomPrincipal.cs.</span></span>


<span data-ttu-id="00d7b-450">[![CustomIdentity ve CustomPrincipal sınıfları projenize ekleyin](forms-authentication-configuration-and-advanced-topics-cs/_static/image17.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-450">[![Add the CustomIdentity and CustomPrincipal Classes to Your Project](forms-authentication-configuration-and-advanced-topics-cs/_static/image17.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image16.png)</span></span>

<span data-ttu-id="00d7b-451">**Şekil 06**: CustomIdentity ve CustomPrincipal sınıfları bilgisayarınızı projeye ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-451">**Figure 06**: Add the CustomIdentity and CustomPrincipal Classes to Your Project ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image18.png))</span></span>


<span data-ttu-id="00d7b-452">AuthenticationType, IsAuthenticated ve ad özelliklerini tanımlar IIdentity arabirimi uygulamak için sorumlu CustomIdentity sınıftır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-452">The CustomIdentity class is responsible for implementing the IIdentity interface, which defines the AuthenticationType, IsAuthenticated, and Name properties.</span></span> <span data-ttu-id="00d7b-453">Bu gerekli özellikleri yanı sıra temel alınan forms kimlik doğrulaması bileti yanı sıra kullanıcının şirket adı ve başlık özelliklerini gösterme de ilginizi duyuyoruz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-453">In addition to those required properties, we are interested in exposing the underlying forms authentication ticket as well as properties for the user's company name and title.</span></span> <span data-ttu-id="00d7b-454">Aşağıdaki kod CustomIdentity sınıfına girin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-454">Enter the following code into the CustomIdentity class.</span></span>

[!code-csharp[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample9.cs)]

<span data-ttu-id="00d7b-455">Sınıf FormsAuthenticationTicket üye değişkeni içerdiğini unutmayın (\_bilet) ve bu anahtar bilgileri oluşturucu kullanılarak sağlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-455">Note that the class includes a FormsAuthenticationTicket member variable (\_ticket) and that this ticket information must be supplied through the constructor.</span></span> <span data-ttu-id="00d7b-456">Bu bilet verileri kimliğin adı döndürme kullanılır; kendi UserData özelliği ŞirketAdı ve başlık özellikleri için değer döndürmek için ayrıştırılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-456">This ticket data is used in returning the identity's Name; its UserData property is parsed to return the values for the CompanyName and Title properties.</span></span>

<span data-ttu-id="00d7b-457">Ardından, CustomPrincipal sınıfı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="00d7b-457">Next, create the CustomPrincipal class.</span></span> <span data-ttu-id="00d7b-458">Biz juncture en bu rolleri ile ilgili bir kaygınız beri CustomPrincipal sınıfının Oluşturucusu yalnızca CustomIdentity nesnesi kabul eder; kendi IsInRole yöntem her zaman false döndürür.</span><span class="sxs-lookup"><span data-stu-id="00d7b-458">Since we are not concerned with roles at this juncture, the CustomPrincipal class's constructor accepts only a CustomIdentity object; its IsInRole method always returns false.</span></span>

[!code-csharp[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample10.cs)]

### <a name="assigning-a-customprincipal-object-to-the-incoming-requests-security-context"></a><span data-ttu-id="00d7b-459">Gelen isteğin güvenlik bağlamı için bir CustomPrincipal nesnesi atama</span><span class="sxs-lookup"><span data-stu-id="00d7b-459">Assigning a CustomPrincipal Object to the Incoming Request's Security Context</span></span>

<span data-ttu-id="00d7b-460">Şimdi ŞirketAdı ve başlık özellikleri eklemek için varsayılan kimlik belirtimi genişleten bir sınıfı gibi özel kimlik kullanan özel bir asıl sınıfı sunuyoruz.</span><span class="sxs-lookup"><span data-stu-id="00d7b-460">We now have a class that extends the default IIdentity specification to include CompanyName and Title properties, as well as a custom principal class that uses the custom identity.</span></span> <span data-ttu-id="00d7b-461">Biz ASP.NET ardışık adımla hazır ve gelen isteğin güvenlik bağlamına bizim Özel asıl nesne atayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-461">We are ready to step into the ASP.NET pipeline and assign our custom principal object to the incoming request's security context.</span></span>

<span data-ttu-id="00d7b-462">ASP.NET ardışık gelen bir istek alır ve bir dizi adımı üzerinden işler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-462">The ASP.NET pipeline takes an incoming request and processes it through a number of steps.</span></span> <span data-ttu-id="00d7b-463">Her aşamada ASP.NET ardışık düzenine dokunun ve kendi ömrü belirli noktalarında isteği değiştirmek geliştiricilere edinerek belirli bir olay tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-463">At each step, a particular event is raised, making it possible for developers to tap into the ASP.NET pipeline and modify the request at certain points in its lifecycle.</span></span> <span data-ttu-id="00d7b-464">FormsAuthenticationModule örneğin yükseltmek ASP.NET için bekleyeceği [AuthenticateRequest olay](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx), isteğe bağlı olarak, bu noktada kimlik doğrulama biletini gelen isteği inceler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-464">The FormsAuthenticationModule, for example, waits for ASP.NET to raise the [AuthenticateRequest event](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx), at which point it inspects the incoming request for an authentication ticket.</span></span> <span data-ttu-id="00d7b-465">Kimlik doğrulama biletini bulunursa, bir GenericPrincipal nesnesi oluşturulur ve HttpContext.User özelliğine atanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-465">If an authentication ticket is found, a GenericPrincipal object is created and assigned to the HttpContext.User property.</span></span>

<span data-ttu-id="00d7b-466">AuthenticateRequest sonra ASP.NET ardışık olayını [PostAuthenticateRequest olay](https://msdn.microsoft.com/library/system.web.httpapplication.postauthenticaterequest.aspx), hangi biz FormsAuthenticationModule bir örneği tarafından oluşturulan GenericPrincipal nesneyi burada değiştirmek olduğu bizim CustomPrincipal nesnesi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-466">After the AuthenticateRequest event, the ASP.NET pipeline raises the [PostAuthenticateRequest event](https://msdn.microsoft.com/library/system.web.httpapplication.postauthenticaterequest.aspx), which is where we can replace the GenericPrincipal object created by the FormsAuthenticationModule with an instance of our CustomPrincipal object.</span></span> <span data-ttu-id="00d7b-467">Şekil 7, bu iş akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-467">Figure 7 depicts this workflow.</span></span>


<span data-ttu-id="00d7b-468">[![GenericPrincipal CustomPrincipal PostAuthenticationRequest olay ile değiştirilir](forms-authentication-configuration-and-advanced-topics-cs/_static/image20.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-468">[![The GenericPrincipal is Replaced by a CustomPrincipal in the PostAuthenticationRequest Event](forms-authentication-configuration-and-advanced-topics-cs/_static/image20.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image19.png)</span></span>

<span data-ttu-id="00d7b-469">**Şekil 07**: GenericPrincipal CustomPrincipal PostAuthenticationRequest olayda almıştır ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-469">**Figure 07**: The GenericPrincipal is Replaced by a CustomPrincipal in the PostAuthenticationRequest Event ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image21.png))</span></span>


<span data-ttu-id="00d7b-470">Bir ASP.NET ardışık düzen olaya yanıt olarak kod yürütmek için size uygun olay işleyicisi Global.asax dosyasında oluşturabilir veya kendi HTTP modülü oluşturun.</span><span class="sxs-lookup"><span data-stu-id="00d7b-470">In order to execute code in response to an ASP.NET pipeline event, we can either create the appropriate event handler in Global.asax or create our own HTTP Module.</span></span> <span data-ttu-id="00d7b-471">Bu öğretici için olay işleyicisini Global.asax dosyasında oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="00d7b-471">For this tutorial let's create the event handler in Global.asax.</span></span> <span data-ttu-id="00d7b-472">Web sitenize Global.asax ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-472">Start by adding Global.asax to your website.</span></span> <span data-ttu-id="00d7b-473">Çözüm Gezgini'nde proje adına sağ tıklayın ve genel uygulama sınıfı Global.asax adlı türünde bir öğe ekleyin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-473">Right-click on the project name in Solution Explorer and add an item of type Global Application Class named Global.asax.</span></span>


<span data-ttu-id="00d7b-474">[![Global.asax dosyası Web sitenize ekleyin](forms-authentication-configuration-and-advanced-topics-cs/_static/image23.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="00d7b-474">[![Add a Global.asax File to Your Website](forms-authentication-configuration-and-advanced-topics-cs/_static/image23.png)](forms-authentication-configuration-and-advanced-topics-cs/_static/image22.png)</span></span>

<span data-ttu-id="00d7b-475">**Şekil 08**: Global.asax dosyası için Web sitenizi ekleme ([tam boyutlu görüntüyü görüntülemek için tıklatın](forms-authentication-configuration-and-advanced-topics-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="00d7b-475">**Figure 08**: Add a Global.asax File to Your Website ([Click to view full-size image](forms-authentication-configuration-and-advanced-topics-cs/_static/image24.png))</span></span>


<span data-ttu-id="00d7b-476">Olay işleyicileri son başlangıç dahil olmak üzere ASP.NET ardışık düzen olayların sayısı için varsayılan Global.asax şablonu içerir ve [hata olayı](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx), diğerlerinin yanı sıra.</span><span class="sxs-lookup"><span data-stu-id="00d7b-476">The default Global.asax template includes event handlers for a number of the ASP.NET pipeline events, including the Start, End and [Error event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx), among others.</span></span> <span data-ttu-id="00d7b-477">Biz bu uygulama için değil gerektiğinde bu olay işleyicileri kaldırmak çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="00d7b-477">Feel free to remove these event handlers, as we do not need them for this application.</span></span> <span data-ttu-id="00d7b-478">Biz ilgilendiğiniz PostAuthenticateRequest etkinliğidir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-478">The event we are interested in is PostAuthenticateRequest.</span></span> <span data-ttu-id="00d7b-479">Kendi biçimlendirme aşağıdakine benzer şekilde, Global.asax dosyası güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="00d7b-479">Update your Global.asax file so its markup looks similar to the following:</span></span>

[!code-aspx[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample11.aspx)]

<span data-ttu-id="00d7b-480">Uygulama\_OnPostAuthenticateRequest yöntemini yürütür her zaman ASP.NET çalışma zamanı gelen her sayfa isteğinde bir kez gerçekleşir PostAuthenticateRequest olayını başlatır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-480">The Application\_OnPostAuthenticateRequest method executes each time the ASP.NET runtime raises the PostAuthenticateRequest event, which happens once on each incoming page request.</span></span> <span data-ttu-id="00d7b-481">Olay işleyicisi, kullanıcının kimliği doğrulanır ve form kimlik doğrulaması kimlik doğrulamasının yapıldığı olmadığını denetleyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="00d7b-481">The event handler starts by checking to see if the user is authenticated and was authenticated via forms authentication.</span></span> <span data-ttu-id="00d7b-482">Bu durumda, yeni bir CustomIdentity nesnesi oluşturulur ve geçerli isteğin kimlik doğrulaması bileti kurucusunda geçirildi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-482">If so, a new CustomIdentity object is created and passed the current request's authentication ticket in its constructor.</span></span> <span data-ttu-id="00d7b-483">CustomPrincipal nesnesi oluşturulur ve yeni oluşturulan CustomIdentity nesnesi kurucusunda geçirildi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-483">Following that, a CustomPrincipal object is created and passed the just-created CustomIdentity object in its constructor.</span></span> <span data-ttu-id="00d7b-484">Son olarak, geçerli isteğin güvenlik bağlamı yeni oluşturulan CustomPrincipal nesneye atanmış.</span><span class="sxs-lookup"><span data-stu-id="00d7b-484">Finally, the current request's security context is assigned to the newly created CustomPrincipal object.</span></span>

<span data-ttu-id="00d7b-485">-CustomPrincipal nesnesi isteğin güvenlik bağlamı ile ilişkilendirme - son adımı asıl iki özelliklerine olduğunu unutmayın: HttpContext.User ve Thread.CurrentPrincipal.</span><span class="sxs-lookup"><span data-stu-id="00d7b-485">Note that the last step - associating the CustomPrincipal object with the request's security context - assigns the principal to two properties: HttpContext.User and Thread.CurrentPrincipal.</span></span> <span data-ttu-id="00d7b-486">Bu iki atamaları, ASP.NET güvenlik kapsamları işlenme nedeniyle gereklidir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-486">These two assignments are necessary because of the way security contexts are handled in ASP.NET.</span></span> <span data-ttu-id="00d7b-487">.NET Framework bir güvenlik bağlamı her çalışan iş parçacığı ile ilişkilendirir; Bu bilgiler IPrincipal nesnesi olarak kullanılabilir [iş parçacığı nesnesi](https://msdn.microsoft.com/library/system.threading.thread.aspx)'s [CurrentPrincipal özelliği](https://msdn.microsoft.com/library/system.threading.thread.currentcontext.aspx).</span><span class="sxs-lookup"><span data-stu-id="00d7b-487">The .NET Framework associates a security context with each running thread; this information is available as an IPrincipal object through the [Thread object](https://msdn.microsoft.com/library/system.threading.thread.aspx)'s [CurrentPrincipal property](https://msdn.microsoft.com/library/system.threading.thread.currentcontext.aspx).</span></span> <span data-ttu-id="00d7b-488">Bir kafa karıştırıcı nedir ASP.NET kendi güvenlik bağlamı bilgilerini (HttpContext.User) sahip olur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-488">What is a confusing is that ASP.NET has its own security context information (HttpContext.User).</span></span>

<span data-ttu-id="00d7b-489">Belirli senaryolarda Thread.CurrentPrincipal özelliği güvenlik bağlamı belirlerken incelenir; Diğer senaryolarda HttpContext.User kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-489">In certain scenarios, the Thread.CurrentPrincipal property is examined when determining the security context; in other scenarios, HttpContext.User is used.</span></span> <span data-ttu-id="00d7b-490">Örneğin, hangi kullanıcıların bildirimli olarak durumuna geliştiriciler izin veren .NET güvenlik özellikleri vardır veya rolleri bir sınıf örneği veya belirli yöntemleri çağırma (bkz [iş ve veri kullanan katmanlar için yetkilendirme kuralları ekleme PrincipalPermissionAttributes](https://weblogs.asp.net/scottgu/archive/2006/10/04/Tip_2F00_Trick_3A00_-Adding-Authorization-Rules-to-Business-and-Data-Layers-using-PrincipalPermissionAttributes.aspx)).</span><span class="sxs-lookup"><span data-stu-id="00d7b-490">For example, there are security features in .NET that allow developers to declaratively state what users or roles can instantiate a class or invoke specific methods (see [Adding Authorization Rules to Business and Data Layers Using PrincipalPermissionAttributes](https://weblogs.asp.net/scottgu/archive/2006/10/04/Tip_2F00_Trick_3A00_-Adding-Authorization-Rules-to-Business-and-Data-Layers-using-PrincipalPermissionAttributes.aspx)).</span></span> <span data-ttu-id="00d7b-491">Kapak altında bu bildirim temelli teknikler Thread.CurrentPrincipal özelliği aracılığıyla güvenlik bağlamı belirler.</span><span class="sxs-lookup"><span data-stu-id="00d7b-491">Underneath the covers, these declarative techniques determine the security context via the Thread.CurrentPrincipal property.</span></span>

<span data-ttu-id="00d7b-492">Diğer senaryolarda HttpContext.User özelliği kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-492">In other scenarios, the HttpContext.User property is used.</span></span> <span data-ttu-id="00d7b-493">Örneğin, önceki öğreticide Biz bu özellik şu anda oturum açmış kullanıcının kullanıcı adını görüntülemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-493">For example, in the previous tutorial we used this property to display the currently logged on user's username.</span></span> <span data-ttu-id="00d7b-494">Açıkçası, daha sonra bu güvenlik bağlamı bilgilerini Thread.CurrentPrincipal ve HttpContext.User özelliklerinde eşleştiğini zorunludur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-494">Clearly, then, it is imperative that the security context information in the Thread.CurrentPrincipal and HttpContext.User properties match up.</span></span>

<span data-ttu-id="00d7b-495">ASP.NET çalışma zamanı bu özellik değerlerini bize için otomatik olarak eşitlenir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-495">The ASP.NET runtime automatically syncs these property values for us.</span></span> <span data-ttu-id="00d7b-496">Ancak, bu eşitleme AuthenticateRequest olayından sonra meydana gelir ancak *önce* PostAuthenticateRequest olay.</span><span class="sxs-lookup"><span data-stu-id="00d7b-496">However, this synchronization occurs after the AuthenticateRequest event, but *before* the PostAuthenticateRequest event.</span></span> <span data-ttu-id="00d7b-497">Sonuç olarak, özel bir kural PostAuthenticateRequest olayında eklerken Thread.CurrentPrincipal Aksi takdirde Thread.CurrentPrincipal el ile atamanız emin olmak ihtiyacımız ve HttpContext.User eşitlenmemiş olacaktır. Bkz: [Context.User vs. Thread.CurrentPrincipal](http://leastprivilege.com/2005/11/23/context-user-vs-thread-currentprincipal/) bu sorunla ilgili daha ayrıntılı bir tartışma için.</span><span class="sxs-lookup"><span data-stu-id="00d7b-497">Consequently, when adding a custom principal in the PostAuthenticateRequest event we need to be certain to manually assign the Thread.CurrentPrincipal or else Thread.CurrentPrincipal and HttpContext.User will be out of sync. See [Context.User vs. Thread.CurrentPrincipal](http://leastprivilege.com/2005/11/23/context-user-vs-thread-currentprincipal/) for a more detailed discussion on this issue.</span></span>

### <a name="accessing-the-companyname-and-title-properties"></a><span data-ttu-id="00d7b-498">Başlık özellikleri ve ŞirketAdı erişme</span><span class="sxs-lookup"><span data-stu-id="00d7b-498">Accessing the CompanyName and Title Properties</span></span>

<span data-ttu-id="00d7b-499">Her bir istek ulaştığında ve uygulama, ASP.NET altyapısı gönderilen\_OnPostAuthenticateRequest olay işleyicisini Global.asax yangın.</span><span class="sxs-lookup"><span data-stu-id="00d7b-499">Whenever a request arrives and is dispatched to the ASP.NET engine, the Application\_OnPostAuthenticateRequest event handler in Global.asax will fire.</span></span> <span data-ttu-id="00d7b-500">İstek tarafından FormsAuthenticationModule başarıyla doğrulandı, olay işleyicisi forms kimlik doğrulaması bileti dayanan bir CustomIdentity nesnesi ile yeni bir CustomPrincipal nesnesi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-500">If the request has been successfully authenticated by the FormsAuthenticationModule, the event handler will create a new CustomPrincipal object with a CustomIdentity object based on the forms authentication ticket.</span></span> <span data-ttu-id="00d7b-501">Yerinde bu mantığı ile şu anda oturum açmış kullanıcının şirket adı ve başlık bilgilerine erişme son derece basittir.</span><span class="sxs-lookup"><span data-stu-id="00d7b-501">With this logic in place, accessing information about the currently logged on user's company name and title is incredibly straightforward.</span></span>

<span data-ttu-id="00d7b-502">Sayfaya dönmek\_burada adım 4'te yazdığımız form kimlik doğrulaması bileti almak ve kullanıcının şirket adı ve başlık görüntülemek için UserData özelliği ayrıştırılamıyor kod Default.aspx yük olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-502">Return to the Page\_Load event handler in Default.aspx, where in Step 4 we wrote code to retrieve the form authentication ticket and parse the UserData property in order to display the user's company name and title.</span></span> <span data-ttu-id="00d7b-503">Artık kullanımda CustomPrincipal ve CustomIdentity nesneleriyle anahtar kişinin UserData özellik değerleri ayrıştırmak için gerek yoktur.</span><span class="sxs-lookup"><span data-stu-id="00d7b-503">With the CustomPrincipal and CustomIdentity objects in use now, there's no need to parse the values out of the ticket's UserData property.</span></span> <span data-ttu-id="00d7b-504">Bunun yerine, yalnızca CustomIdentity nesneye bir başvurusu alın ve ŞirketAdı ve başlık özelliklerini kullanın:</span><span class="sxs-lookup"><span data-stu-id="00d7b-504">Instead, simply get a reference to the CustomIdentity object and use its CompanyName and Title properties:</span></span>

[!code-csharp[Main](forms-authentication-configuration-and-advanced-topics-cs/samples/sample12.cs)]

## <a name="summary"></a><span data-ttu-id="00d7b-505">Özet</span><span class="sxs-lookup"><span data-stu-id="00d7b-505">Summary</span></span>

<span data-ttu-id="00d7b-506">Bu öğreticide Web.config aracılığıyla forms kimlik doğrulaması sistemin ayarlarını özelleştirmek nasıl incelendi. Kimlik doğrulaması bileti 's sona erme nasıl işlendiğini ve şifreleme ve doğrulama korumaları bileti denetleme ve değiştirme korumak için nasıl kullanıldığı inceledik.</span><span class="sxs-lookup"><span data-stu-id="00d7b-506">In this tutorial we examined how to customize the forms authentication system's settings via Web.config. We looked at how the authentication ticket's expiration is handled and how the encryption and validation safeguards are used to protect the ticket from inspection and modification.</span></span> <span data-ttu-id="00d7b-507">Son olarak, anahtar ek kullanıcı bilgilerini ve bu bilgileri bir daha Geliştirici dostu şekilde kullanıma sunmak için özel asıl ve kimlik nesneleri kullanmayı depolamak için kimlik doğrulaması bileti 's UserData özelliği kullanma açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-507">Finally, we discussed using the authentication ticket's UserData property to store additional user information in the ticket itself, and how to use custom principal and identity objects to expose this information in a more developer-friendly manner.</span></span>

<span data-ttu-id="00d7b-508">Bu öğretici ASP.NET forms kimlik doğrulaması bizim incelendiğinde sonlanır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-508">This tutorial concludes our examination of forms authentication in ASP.NET.</span></span> <span data-ttu-id="00d7b-509">Sonraki öğretici bizim gezisine üyelik framework uygulamasına başlatır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-509">The next tutorial starts our journey into the Membership framework.</span></span>

<span data-ttu-id="00d7b-510">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="00d7b-510">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="00d7b-511">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="00d7b-511">Further Reading</span></span>

<span data-ttu-id="00d7b-512">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="00d7b-512">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="00d7b-513">Form kimlik doğrulaması dissecting</span><span class="sxs-lookup"><span data-stu-id="00d7b-513">Dissecting Forms Authentication</span></span>](http://aspnet.4guysfromrolla.com/articles/072005-1.aspx)
- [<span data-ttu-id="00d7b-514">Açıklanmıştır: ASP.NET 2.0 form kimlik doğrulaması</span><span class="sxs-lookup"><span data-stu-id="00d7b-514">Explained: Forms Authentication in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/aa480476.aspx)
- [<span data-ttu-id="00d7b-515">Nasıl yapılır: ASP.NET 2.0 form kimlik doğrulamasını korumak</span><span class="sxs-lookup"><span data-stu-id="00d7b-515">How To: Protect Forms Authentication in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998310.aspx)
- <span data-ttu-id="00d7b-516">[Profesyonel ASP.NET 2.0 güvenlik, üyelik ve rol yönetimi](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764596985.html) (ISBN: 978-0-7645-9698-8)</span><span class="sxs-lookup"><span data-stu-id="00d7b-516">[Professional ASP.NET 2.0 Security, Membership, and Role Management](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764596985.html) (ISBN: 978-0-7645-9698-8)</span></span>
- [<span data-ttu-id="00d7b-517">Oturum açma denetimleri güvenliğini sağlama</span><span class="sxs-lookup"><span data-stu-id="00d7b-517">Securing Login Controls</span></span>](https://msdn.microsoft.com/library/ms178346.aspx)
- [<span data-ttu-id="00d7b-518">&lt;Kimlik doğrulaması&gt; öğesi</span><span class="sxs-lookup"><span data-stu-id="00d7b-518">The &lt;authentication&gt; Element</span></span>](https://msdn.microsoft.com/library/532aee0e.aspx)
- [<span data-ttu-id="00d7b-519">&lt;Forms&gt; öğesi için &lt;kimlik doğrulaması&gt;</span><span class="sxs-lookup"><span data-stu-id="00d7b-519">The &lt;forms&gt; Element for &lt;authentication&gt;</span></span>](https://msdn.microsoft.com/library/1d3t3c61.aspx)
- [<span data-ttu-id="00d7b-520">&lt;MachineKey&gt; öğesi</span><span class="sxs-lookup"><span data-stu-id="00d7b-520">The &lt;machineKey&gt; Element</span></span>](https://msdn.microsoft.com/library/w8h3skw9.aspx)
- [<span data-ttu-id="00d7b-521">Tanımlama bilgisi ve Forms kimlik doğrulaması bileti anlama</span><span class="sxs-lookup"><span data-stu-id="00d7b-521">Understanding the Forms Authentication Ticket and Cookie</span></span>](https://support.microsoft.com/kb/910443)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="00d7b-522">Bu öğreticide yer alan konularda video eğitim</span><span class="sxs-lookup"><span data-stu-id="00d7b-522">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="00d7b-523">Forms kimlik doğrulaması özelliklerini değiştirme</span><span class="sxs-lookup"><span data-stu-id="00d7b-523">How to Change the Forms Authentication Properties</span></span>](../../../videos/authentication/how-to-change-the-forms-authentication-properties.md)
- [<span data-ttu-id="00d7b-524">Kurulumu ve kullanımı daha az tanımlama bilgisi kimlik doğrulaması bir ASP.NET uygulamasında nasıl</span><span class="sxs-lookup"><span data-stu-id="00d7b-524">How to Setup and Use Cookie-less Authentication in an ASP.NET Application</span></span>](../../../videos/authentication/how-to-setup-and-use-cookie-less-authentication-in-an-aspnet-application.md)
- [<span data-ttu-id="00d7b-525">ASP Forms Oturum Açmayı Yeniden Konumlandırma</span><span class="sxs-lookup"><span data-stu-id="00d7b-525">ASP Forms Login Relocation</span></span>](../../../videos/authentication/asp-forms-login-relocation.md)
- [<span data-ttu-id="00d7b-526">Forms Oturum Açma Özel Anahtar Yapılandırması</span><span class="sxs-lookup"><span data-stu-id="00d7b-526">Forms Login Custom Key Configuration</span></span>](../../../videos/authentication/forms-login-custom-key-configuration.md)
- [<span data-ttu-id="00d7b-527">Kimlik Doğrulama Metoduna Özel Veri Ekleme</span><span class="sxs-lookup"><span data-stu-id="00d7b-527">Add Custom Data to the Authentication Method</span></span>](../../../videos/authentication/add-custom-data-to-the-authentication-method.md)
- [<span data-ttu-id="00d7b-528">Özel Asıl Nesneler Kullanma</span><span class="sxs-lookup"><span data-stu-id="00d7b-528">Use Custom Principal Objects</span></span>](../../../videos/authentication/use-custom-principal-objects.md)

### <a name="about-the-author"></a><span data-ttu-id="00d7b-529">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="00d7b-529">About the Author</span></span>

<span data-ttu-id="00d7b-530">Scott Mitchell, birden çok ASP/ASP.NET books yazar ve 4GuysFromRolla.com, kurucusu 1998 itibaren Microsoft Web teknolojileri ile çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-530">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="00d7b-531">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="00d7b-531">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="00d7b-532">En son kendi defteri  *[kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="00d7b-532">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="00d7b-533">Tan adresindeki ulaşılabilir [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) veya kendi blog aracılığıyla [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="00d7b-533">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="00d7b-534">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="00d7b-534">Special Thanks To</span></span>

<span data-ttu-id="00d7b-535">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="00d7b-535">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="00d7b-536">Bu öğretici için sağlama İnceleme Alicja Maziarz oluştu.</span><span class="sxs-lookup"><span data-stu-id="00d7b-536">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="00d7b-537">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="00d7b-537">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="00d7b-538">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4guysfromrolla.com).</span><span class="sxs-lookup"><span data-stu-id="00d7b-538">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="00d7b-539">[Önceki](an-overview-of-forms-authentication-cs.md)
[sonraki](security-basics-and-asp-net-support-vb.md)</span><span class="sxs-lookup"><span data-stu-id="00d7b-539">[Previous](an-overview-of-forms-authentication-cs.md)
[Next](security-basics-and-asp-net-support-vb.md)</span></span>

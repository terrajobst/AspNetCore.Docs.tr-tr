---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal
title: Kullanıma alma ve PayPal ödeme | Microsoft Docs
author: Erikre
description: Bu öğretici seri ASP.NET 4.5 ve Microsoft Visual Studio Express 2013 biz için kullanarak bir ASP.NET Web Forms uygulaması oluşturma temellerini öğretmek...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 664ec95e-b0c9-4f43-a39f-798d0f2a7e08
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal
msc.type: authoredcontent
ms.openlocfilehash: 0dba613594686a28b82bc6d7701cda6e24b82e2e
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
---
<a name="checkout-and-payment-with-paypal"></a><span data-ttu-id="35028-103">Kullanıma alma ve PayPal ödeme</span><span class="sxs-lookup"><span data-stu-id="35028-103">Checkout and Payment with PayPal</span></span>
====================
<span data-ttu-id="35028-104">Tarafından [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="35028-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="35028-105">[Wingtip Toys örnek proje (C#) karşıdan](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) veya [karşıdan E-kitap (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="35028-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="35028-106">Bu öğretici seri ASP.NET 4.5 ve Microsoft Visual Studio Express 2013 için Web kullanarak bir ASP.NET Web Forms uygulaması oluşturma temellerini öğretmek.</span><span class="sxs-lookup"><span data-stu-id="35028-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="35028-107">Visual Studio 2013 [C# kaynak kodu projeyle](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) Bu öğretici seri eşlik etmek üzere hazırdır.</span><span class="sxs-lookup"><span data-stu-id="35028-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="35028-108">Bu öğretici, kullanıcı kimlik doğrulaması, kayıt ve PayPal kullanarak ödeme içerecek şekilde Wingtip Toys örnek uygulamayı değiştirmek açıklar.</span><span class="sxs-lookup"><span data-stu-id="35028-108">This tutorial describes how to modify the Wingtip Toys sample application to include user authorization, registration, and payment using PayPal.</span></span> <span data-ttu-id="35028-109">Oturum açan kullanıcıların ürünleri satın almak için yetkilendirme gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-109">Only users who are logged in will have authorization to purchase products.</span></span> <span data-ttu-id="35028-110">ASP.NET 4.5 Web formları proje şablonun yerleşik kullanıcı kayıt işlevselliği zaten gerekenler çoğunu içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-110">The ASP.NET 4.5 Web Forms project template's built-in user registration functionality already includes much of what you need.</span></span> <span data-ttu-id="35028-111">PayPal Express Checkout işlevselliği ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-111">You will add PayPal Express Checkout functionality.</span></span> <span data-ttu-id="35028-112">Bu öğreticide, gerçek bir fon aktarılacak şekilde sınama ortamında, PayPal Geliştirici kullanıyor.</span><span class="sxs-lookup"><span data-stu-id="35028-112">In this tutorial you be using the PayPal developer testing environment, so no actual funds will be transferred.</span></span> <span data-ttu-id="35028-113">Öğreticinin sonunda alışveriş sepeti, ödeme düğmesini tıklatarak ve verileri PayPal test web sitesine aktarma eklemek için ürün seçerek uygulamayı test.</span><span class="sxs-lookup"><span data-stu-id="35028-113">At the end of the tutorial, you will test the application by selecting products to add to the shopping cart, clicking the checkout button, and transferring data to the PayPal testing web site.</span></span> <span data-ttu-id="35028-114">PayPal test web sitesinde sevkiyat ve Ödeme bilgilerinizi doğrulayın ve ardından onaylamak ve satın alma işlemini tamamlamak için yerel Wingtip Toys örnek uygulama için döndürür.</span><span class="sxs-lookup"><span data-stu-id="35028-114">On the PayPal testing web site, you will confirm your shipping and payment information and then return to the local Wingtip Toys sample application to confirm and complete the purchase.</span></span>

<span data-ttu-id="35028-115">Bu adres ölçeklenebilirlik ve güvenlik çevrimiçi alışveriş specialize birkaç deneyimli üçüncü taraf ödeme işlemciler vardır.</span><span class="sxs-lookup"><span data-stu-id="35028-115">There are several experienced third-party payment processors that specialize in online shopping that address scalability and security.</span></span> <span data-ttu-id="35028-116">ASP.NET geliştiricilerinin bir alışveriş uygulama ve çözüm satın almadan önce bir üçüncü taraf ödeme çözümü kullanan yararları göz önünde bulundurmalısınız.</span><span class="sxs-lookup"><span data-stu-id="35028-116">ASP.NET developers should consider the advantages of utilizing a third party payment solution before implementing a shopping and purchasing solution.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="35028-117">Wingtip Toys örnek uygulama, ASP.NET web geliştiricilerin belirli ASP.NET kavramları ve özellikler kullanılabilir gösterildiği şekilde tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="35028-117">The Wingtip Toys sample application was designed to shown specific ASP.NET concepts and features available to ASP.NET web developers.</span></span> <span data-ttu-id="35028-118">Bu örnek uygulama ölçeklenebilirlik ve güvenlik in regard to tüm olası durumlarda iyi duruma getirilmiş değil.</span><span class="sxs-lookup"><span data-stu-id="35028-118">This sample application was not optimized for all possible circumstances in regard to scalability and security.</span></span>


## <a name="what-youll-learn"></a><span data-ttu-id="35028-119">Öğrenecekleriniz:</span><span class="sxs-lookup"><span data-stu-id="35028-119">What you'll learn:</span></span>

- <span data-ttu-id="35028-120">Bir klasördeki belirli sayfalara erişimi kısıtlamak nasıl.</span><span class="sxs-lookup"><span data-stu-id="35028-120">How to restrict access to specific pages in a folder.</span></span>
- <span data-ttu-id="35028-121">Anonim bir Alışveriş sepetinden bilinen alışveriş sepeti oluşturma</span><span class="sxs-lookup"><span data-stu-id="35028-121">How to create a known shopping cart from an anonymous shopping cart.</span></span>
- <span data-ttu-id="35028-122">Nasıl proje için SSL etkinleştirilir.</span><span class="sxs-lookup"><span data-stu-id="35028-122">How to enable SSL for the project.</span></span>
- <span data-ttu-id="35028-123">OAuth sağlayıcısı projeye ekleme.</span><span class="sxs-lookup"><span data-stu-id="35028-123">How to add an OAuth provider to the project.</span></span>
- <span data-ttu-id="35028-124">PayPal PayPal sınama ortamı kullanarak ürün satın almak için nasıl kullanılacağını.</span><span class="sxs-lookup"><span data-stu-id="35028-124">How to use PayPal to purchase products using the PayPal testing environment.</span></span>
- <span data-ttu-id="35028-125">İçinde PayPal ayrıntılarını görüntülemek nasıl bir **DetailsView** denetim.</span><span class="sxs-lookup"><span data-stu-id="35028-125">How to display details from PayPal in a **DetailsView** control.</span></span>
- <span data-ttu-id="35028-126">PayPal elde edilen ayrıntılarla Wingtip Toys uygulamasının veritabanını güncelleştirmek nasıl.</span><span class="sxs-lookup"><span data-stu-id="35028-126">How to update the database of the Wingtip Toys application with details obtained from PayPal.</span></span>

## <a name="adding-order-tracking"></a><span data-ttu-id="35028-127">Sipariş İzleme ekleme</span><span class="sxs-lookup"><span data-stu-id="35028-127">Adding Order Tracking</span></span>

<span data-ttu-id="35028-128">Bu öğreticide, bir kullanıcının oluşturduğu siparişte veri izlemek için iki yeni sınıflar oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="35028-128">In this tutorial, you'll create two new classes to track data from the order a user has created.</span></span> <span data-ttu-id="35028-129">Sınıfları veri aktarma bilgileri, satın alma toplam ve ödeme onayı izler.</span><span class="sxs-lookup"><span data-stu-id="35028-129">The classes will track data regarding shipping information, purchase total, and payment confirmation.</span></span>

### <a name="add-the-order-and-orderdetail-model-classes"></a><span data-ttu-id="35028-130">OrderDetail modeli sınıfları ve sırası Ekle</span><span class="sxs-lookup"><span data-stu-id="35028-130">Add the Order and OrderDetail Model Classes</span></span>

<span data-ttu-id="35028-131">Öğretici serisinde daha önce bu kategoriler, ürünler, şema tanımlanan ve alışveriş sepeti öğeleri oluşturarak `Category`, `Product`, ve `CartItem` sınıfları *modelleri* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-131">Earlier in this tutorial series, you defined the schema for categories, products, and shopping cart items by creating the `Category`, `Product`, and `CartItem` classes in the *Models* folder.</span></span> <span data-ttu-id="35028-132">Artık ürün sırası ve Sipariş ayrıntılarını şemasını tanımlamak için iki yeni sınıflar ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-132">Now you will add two new classes to define the schema for the product order and the details of the order.</span></span>

1. <span data-ttu-id="35028-133">İçinde **modelleri** klasör adında yeni bir sınıf ekleyin *Order.cs*.</span><span class="sxs-lookup"><span data-stu-id="35028-133">In the **Models** folder, add a new class named *Order.cs*.</span></span>   
   <span data-ttu-id="35028-134">Yeni sınıf dosyası Düzenleyicisi'nde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-134">The new class file is displayed in the editor.</span></span>
2. <span data-ttu-id="35028-135">Varsayılan kodu aşağıdakilerle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-135">Replace the default code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample1.cs)]
3. <span data-ttu-id="35028-136">Ekleme bir *OrderDetail.cs* sınıfının *modelleri* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-136">Add an *OrderDetail.cs* class to the *Models* folder.</span></span>
4. <span data-ttu-id="35028-137">Varsayılan kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-137">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample2.cs)]

<span data-ttu-id="35028-138">`Order` Ve `OrderDetail` satın alma ve aktarma için kullanılan sipariş bilgilerini tanımlamak için şema sınıfları içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-138">The `Order` and `OrderDetail` classes contain the schema to define the order information used for purchasing and shipping.</span></span>

<span data-ttu-id="35028-139">Ayrıca, varlık sınıflarını yönetir ve veritabanına veri erişimi sağlayan veritabanı bağlamı sınıfının güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-139">In addition, you will need to update the database context class that manages the entity classes and that provides data access to the database.</span></span> <span data-ttu-id="35028-140">Bunu yapmak için yeni oluşturulan sipariş ekleyecek ve `OrderDetail` model sınıflarına `ProductContext` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="35028-140">To do this, you will add the newly created Order and `OrderDetail` model classes to `ProductContext` class.</span></span>

1. <span data-ttu-id="35028-141">İçinde **Çözüm Gezgini**, bulma ve açma *ProductContext.cs* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-141">In **Solution Explorer**, find and open the *ProductContext.cs* file.</span></span>
2. <span data-ttu-id="35028-142">Vurgulanmış kodu ekleyin *ProductContext.cs* dosya aşağıda gösterildiği gibi:</span><span class="sxs-lookup"><span data-stu-id="35028-142">Add the highlighted code to the *ProductContext.cs* file as shown below:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample3.cs?highlight=14-15)]

<span data-ttu-id="35028-143">Bu öğretici serisinde kodu daha önce belirtildiği gibi *ProductContext.cs* dosyayı ekler `System.Data.Entity` ad alanı Entity Framework'ün tüm çekirdek işlevlerin erişimi böylece.</span><span class="sxs-lookup"><span data-stu-id="35028-143">As mentioned previously in this tutorial series, the code in the *ProductContext.cs* file adds the `System.Data.Entity` namespace so that you have access to all the core functionality of the Entity Framework.</span></span> <span data-ttu-id="35028-144">Bu işlevsellik, sorgu, Ekle, Güncelleştir ve güçlü şekilde yazılan nesnelerin çalışarak verilerini silmek için özelliği içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-144">This functionality includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span> <span data-ttu-id="35028-145">Yukarıdaki kod `ProductContext` sınıfı Entity Framework erişim için yeni eklenen ekler `Order` ve `OrderDetail` sınıfları.</span><span class="sxs-lookup"><span data-stu-id="35028-145">The above code in the `ProductContext` class adds Entity Framework access to the newly added `Order` and `OrderDetail` classes.</span></span>

## <a name="adding-checkout-access"></a><span data-ttu-id="35028-146">Checkout erişim ekleme</span><span class="sxs-lookup"><span data-stu-id="35028-146">Adding Checkout Access</span></span>

<span data-ttu-id="35028-147">Wingtip Toys örnek uygulama gözden geçirin ve ürünleri alışveriş sepetine eklemek anonim kullanıcıların sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-147">The Wingtip Toys sample application allows anonymous users to review and add products to a shopping cart.</span></span> <span data-ttu-id="35028-148">Anonim kullanıcılar alışveriş sepetine eklenen ürünlerin seçtiğinizde, ancak bunlar siteye oturum açmalısınız.</span><span class="sxs-lookup"><span data-stu-id="35028-148">However, when anonymous users choose to purchase the products they added to the shopping cart, they must log on to the site.</span></span> <span data-ttu-id="35028-149">Bunlar oturum açtıktan sonra bunların checkout işleyen ve satın alma işlemi kısıtlı sayfalarına Web uygulamasının erişebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-149">Once they have logged on, they can access the restricted pages of the Web application that handle the checkout and purchase process.</span></span> <span data-ttu-id="35028-150">Bu sınırlı sayfalar içerdiği *Checkout* uygulamanın klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-150">These restricted pages are contained in the *Checkout* folder of the application.</span></span>

### <a name="add-a-checkout-folder-and-pages"></a><span data-ttu-id="35028-151">Bir Checkout klasör ve sayfaları ekleme</span><span class="sxs-lookup"><span data-stu-id="35028-151">Add a Checkout Folder and Pages</span></span>

<span data-ttu-id="35028-152">Şimdi oluşturacak *Checkout* klasör ve sayfaları, Müşteri satın alma işlemi sırasında görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="35028-152">You will now create the *Checkout* folder and the pages in it that the customer will see during the checkout process.</span></span> <span data-ttu-id="35028-153">Bu öğreticide daha sonra bu sayfaları güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="35028-153">You will update these pages later in this tutorial.</span></span>

1. <span data-ttu-id="35028-154">Proje adına sağ tıklayın (**Wingtip Toys**) içinde **Çözüm Gezgini** seçip **yeni bir klasör ekleyin**.</span><span class="sxs-lookup"><span data-stu-id="35028-154">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add a New Folder**.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - yeni klasör](checkout-and-payment-with-paypal/_static/image1.png)
2. <span data-ttu-id="35028-156">Yeni bir klasör adı *Checkout*.</span><span class="sxs-lookup"><span data-stu-id="35028-156">Name the new folder *Checkout*.</span></span>
3. <span data-ttu-id="35028-157">Sağ *Checkout* klasörünü ve ardından **Ekle**-&gt;**yeni öğe**.</span><span class="sxs-lookup"><span data-stu-id="35028-157">Right-click the *Checkout* folder and then select **Add**-&gt;**New Item**.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - yeni öğe ile](checkout-and-payment-with-paypal/_static/image2.png)
4. <span data-ttu-id="35028-159">**Yeni Öğe Ekle** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-159">The **Add New Item** dialog box is displayed.</span></span>
5. <span data-ttu-id="35028-160">Seçin **Visual C#**  - &gt; **Web** soldaki templates grubu.</span><span class="sxs-lookup"><span data-stu-id="35028-160">Select the **Visual C#** -&gt; **Web** templates group on the left.</span></span> <span data-ttu-id="35028-161">Orta bölmesinden seçip **ana sayfa ile Web Form**ve adlandırın *CheckoutStart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="35028-161">Then, from the middle pane, select **Web Form with Master Page**and name it *CheckoutStart.aspx*.</span></span> 

    ![Kullanıma alma ve PayPal - ödemeyle ekleme yeni öğe iletişim kutusu](checkout-and-payment-with-paypal/_static/image3.png)
6. <span data-ttu-id="35028-163">Önceki gibi seçin *Site.Master* ana sayfa olarak dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-163">As before, select the *Site.Master* file as the master page.</span></span>
7. <span data-ttu-id="35028-164">Aşağıdaki ek sayfalara eklemek *Checkout* klasörü yukarıdaki aynı adımları kullanarak:</span><span class="sxs-lookup"><span data-stu-id="35028-164">Add the following additional pages to the *Checkout* folder using the same steps above:</span></span>   

    - <span data-ttu-id="35028-165">CheckoutReview.aspx</span><span class="sxs-lookup"><span data-stu-id="35028-165">CheckoutReview.aspx</span></span>
    - <span data-ttu-id="35028-166">CheckoutComplete.aspx</span><span class="sxs-lookup"><span data-stu-id="35028-166">CheckoutComplete.aspx</span></span>
    - <span data-ttu-id="35028-167">CheckoutCancel.aspx</span><span class="sxs-lookup"><span data-stu-id="35028-167">CheckoutCancel.aspx</span></span>
    - <span data-ttu-id="35028-168">CheckoutError.aspx</span><span class="sxs-lookup"><span data-stu-id="35028-168">CheckoutError.aspx</span></span>

### <a name="add-a-webconfig-file"></a><span data-ttu-id="35028-169">Bir Web.config dosyası ekler</span><span class="sxs-lookup"><span data-stu-id="35028-169">Add a Web.config File</span></span>

<span data-ttu-id="35028-170">Yeni bir ekleyerek *Web.config* dosya *Checkout* klasörünü görebilirsiniz klasördeki tüm sayfalar için erişimi kısıtlamak.</span><span class="sxs-lookup"><span data-stu-id="35028-170">By adding a new *Web.config* file to the *Checkout* folder, you will be able to restrict access to all the pages contained in the folder.</span></span>

1. <span data-ttu-id="35028-171">Sağ *Checkout* klasörü ve select **Ekle**  - &gt; **yeni öğe**.</span><span class="sxs-lookup"><span data-stu-id="35028-171">Right-click the *Checkout* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="35028-172">**Yeni Öğe Ekle** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-172">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="35028-173">Seçin **Visual C#**  - &gt; **Web** soldaki templates grubu.</span><span class="sxs-lookup"><span data-stu-id="35028-173">Select the **Visual C#** -&gt; **Web** templates group on the left.</span></span> <span data-ttu-id="35028-174">Orta bölmesinden seçip **Web yapılandırma dosyası**, varsayılan adı kabul *Web.config*ve ardından **Ekle**.</span><span class="sxs-lookup"><span data-stu-id="35028-174">Then, from the middle pane, select **Web Configuration File**, accept the default name of *Web.config*, and then select **Add**.</span></span>
3. <span data-ttu-id="35028-175">Varolan XML içeriği Değiştir *Web.config* aşağıdaki dosyasıyla:</span><span class="sxs-lookup"><span data-stu-id="35028-175">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](checkout-and-payment-with-paypal/samples/sample4.xml)]
4. <span data-ttu-id="35028-176">Kaydet *Web.config* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-176">Save the *Web.config* file.</span></span>

<span data-ttu-id="35028-177">*Web.config* dosyayı belirtir Web uygulamasının tüm bilinmeyen kullanıcılar içinde yer alan sayfaları için erişim reddedildi gerekir *Checkout* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-177">The *Web.config* file specifies that all unknown users of the Web application must be denied access to the pages contained in the *Checkout* folder.</span></span> <span data-ttu-id="35028-178">Ancak, kullanıcı hesabınız kayıtlı olan ve oturum açmış, bunlar bilinen bir kullanıcı ve sayfalarına erişebilir *Checkout* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-178">However, if the user has registered an account and is logged on, they will be a known user and will have access to the pages in the *Checkout* folder.</span></span>

<span data-ttu-id="35028-179">ASP.NET yapılandırma bir hiyerarşi izlediğini dikkate almak önemlidir burada her *Web.config* dosya olarak klasöre ve alt dizinlerinde tüm yapılandırma ayarlarını uygular.</span><span class="sxs-lookup"><span data-stu-id="35028-179">It's important to note that ASP.NET configuration follows a hierarchy, where each *Web.config* file applies configuration settings to the folder that it is in and to all of the child directories below it.</span></span>

<a id="SSLWebForms"></a>
## <a name="enable-ssl-for-the-project"></a><span data-ttu-id="35028-180">Proje için SSL etkinleştir</span><span class="sxs-lookup"><span data-stu-id="35028-180">Enable SSL for the Project</span></span>

 <span data-ttu-id="35028-181">Güvenli Yuva Katmanı (SSL), Web sunucuları ve Web istemcileri daha güvenli bir şekilde şifreleme kullanımı ile iletişim kurmasına izin vermek için tanımlanmış bir protokoldür.</span><span class="sxs-lookup"><span data-stu-id="35028-181">Secure Sockets Layer (SSL) is a protocol defined to allow Web servers and Web clients to communicate more securely through the use of encryption.</span></span> <span data-ttu-id="35028-182">SSL kullanılmadığında istemci ve sunucu arasında gönderilen verilerin ağa fiziksel erişimi olan herkes tarafından algılaması paket açıktır.</span><span class="sxs-lookup"><span data-stu-id="35028-182">When SSL is not used, data sent between the client and server is open to packet sniffing by anyone with physical access to the network.</span></span> <span data-ttu-id="35028-183">Ayrıca, birçok ortak kimlik doğrulama şemasını düz HTTP üzerinden güvenli değildir.</span><span class="sxs-lookup"><span data-stu-id="35028-183">Additionally, several common authentication schemes are not secure over plain HTTP.</span></span> <span data-ttu-id="35028-184">Özellikle, temel kimlik doğrulaması ve forms kimlik doğrulaması şifrelenmemiş kimlik bilgilerini gönderir.</span><span class="sxs-lookup"><span data-stu-id="35028-184">In particular, Basic authentication and forms authentication send unencrypted credentials.</span></span> <span data-ttu-id="35028-185">Güvenli olması için bu kimlik doğrulama şemasını SSL kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-185">To be secure, these authentication schemes must use SSL.</span></span> 

1. <span data-ttu-id="35028-186">İçinde **Çözüm Gezgini**, tıklatın **WingtipToys** proje ve basın **F4** görüntülemek için **özellikleri** penceresi.</span><span class="sxs-lookup"><span data-stu-id="35028-186">In **Solution Explorer**, click the **WingtipToys** project, then press **F4** to display the **Properties** window.</span></span>
2. <span data-ttu-id="35028-187">Değişiklik **SSL özellikli** için `true`.</span><span class="sxs-lookup"><span data-stu-id="35028-187">Change **SSL Enabled** to `true`.</span></span>
3. <span data-ttu-id="35028-188">Kopya **SSL URL** daha sonra kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-188">Copy the **SSL URL** so you can use it later.</span></span>   
 <span data-ttu-id="35028-189">SSL URL `https://localhost:44300/` SSL Web siteleri (aşağıda gösterildiği gibi) daha önceden oluşturduğunuz sürece.</span><span class="sxs-lookup"><span data-stu-id="35028-189">The SSL URL will be `https://localhost:44300/` unless you've previously created SSL Web Sites (as shown below).</span></span>   
    <span data-ttu-id="35028-190">![Proje Özellikleri](checkout-and-payment-with-paypal/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="35028-190">![Project Properties](checkout-and-payment-with-paypal/_static/image4.png)</span></span>
4. <span data-ttu-id="35028-191">İçinde **Çözüm Gezgini**, sağ tıklatın **WingtipToys** proje ve tıklatın **özellikleri**.</span><span class="sxs-lookup"><span data-stu-id="35028-191">In **Solution Explorer**, right click the **WingtipToys** project and click **Properties**.</span></span>
5. <span data-ttu-id="35028-192">Sol sekmede tıklatın **Web**.</span><span class="sxs-lookup"><span data-stu-id="35028-192">In the left tab, click **Web**.</span></span>
6. <span data-ttu-id="35028-193">Değişiklik **proje URL'sini** kullanmak için **SSL URL** daha önce kaydettiğiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-193">Change the **Project Url** to use the **SSL URL** that you saved earlier.</span></span>   
    <span data-ttu-id="35028-194">![Proje Web özellikleri](checkout-and-payment-with-paypal/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="35028-194">![Project Web Properties](checkout-and-payment-with-paypal/_static/image5.png)</span></span>
7. <span data-ttu-id="35028-195">Sayfayı tuşlarına basarak kaydetmek **CTRL + S**.</span><span class="sxs-lookup"><span data-stu-id="35028-195">Save the page by pressing **CTRL+S**.</span></span>
8. <span data-ttu-id="35028-196">Tuşuna **Ctrl + F5** uygulamayı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="35028-196">Press **Ctrl+F5** to run the application.</span></span> <span data-ttu-id="35028-197">Visual Studio SSL uyarılarını olanak tanımak için bir seçenek görüntüler.</span><span class="sxs-lookup"><span data-stu-id="35028-197">Visual Studio will display an option to allow you to avoid SSL warnings.</span></span>
9. <span data-ttu-id="35028-198">Tıklatın **Evet** IIS Express SSL sertifikasına güvenmesi ve devam edin.</span><span class="sxs-lookup"><span data-stu-id="35028-198">Click **Yes** to trust the IIS Express SSL certificate and continue.</span></span>   
    <span data-ttu-id="35028-199">![IIS Express SSL sertifikası ayrıntıları](checkout-and-payment-with-paypal/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="35028-199">![IIS Express SSL certificate details](checkout-and-payment-with-paypal/_static/image6.png)</span></span>  
 <span data-ttu-id="35028-200">Bir güvenlik uyarısı görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-200">A Security Warning is displayed.</span></span>
10. <span data-ttu-id="35028-201">Tıklatın **Evet** localhost olarak sertifika yüklemek için.</span><span class="sxs-lookup"><span data-stu-id="35028-201">Click **Yes** to install the certificate to your localhost.</span></span>   
    <span data-ttu-id="35028-202">![Güvenlik Uyarısı iletişim kutusu](checkout-and-payment-with-paypal/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="35028-202">![Security Warning dialog box](checkout-and-payment-with-paypal/_static/image7.png)</span></span>  
 <span data-ttu-id="35028-203">Bir tarayıcı penceresi görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-203">The browser window will be displayed.</span></span>

<span data-ttu-id="35028-204">Şimdi kolayca Web uygulamanızı yerel olarak SSL kullanarak test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-204">You can now easily test your Web application locally using SSL.</span></span>

<a id="OAuthWebForms"></a>
## <a name="add-an-oauth-20-provider"></a><span data-ttu-id="35028-205">Bir OAuth 2.0 Sağlayıcısı Ekle</span><span class="sxs-lookup"><span data-stu-id="35028-205">Add an OAuth 2.0 Provider</span></span>

<span data-ttu-id="35028-206">ASP.NET Web Forms üyeliği ve kimlik doğrulama için Gelişmiş seçenekleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-206">ASP.NET Web Forms provides enhanced options for membership and authentication.</span></span> <span data-ttu-id="35028-207">Bu geliştirmeler, OAuth içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-207">These enhancements include OAuth.</span></span> <span data-ttu-id="35028-208">OAuth güvenli yetkilendirme, web, mobil ve Masaüstü uygulamalardan basit ve standart bir yöntem sağlar açık bir protokoldür.</span><span class="sxs-lookup"><span data-stu-id="35028-208">OAuth is an open protocol that allows secure authorization in a simple and standard method from web, mobile, and desktop applications.</span></span> <span data-ttu-id="35028-209">ASP.NET Web Forms şablon OAuth Facebook, Twitter, Google ve Microsoft kimlik doğrulama sağlayıcısı olarak kullanıma sunmak için kullanır.</span><span class="sxs-lookup"><span data-stu-id="35028-209">The ASP.NET Web Forms template uses OAuth to expose Facebook, Twitter, Google and Microsoft as authentication providers.</span></span> <span data-ttu-id="35028-210">Bu öğretici yalnızca Google kimlik doğrulama sağlayıcısı olarak kullansa da, sağlayıcılardan herhangi birinin kullanmak için kodu kolayca değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-210">Although this tutorial uses only Google as the authentication provider, you can easily modify the code to use any of the providers.</span></span> <span data-ttu-id="35028-211">Diğer sağlayıcıları uygulamaya yönelik adımlar, bu öğreticide görürsünüz adımları çok benzer.</span><span class="sxs-lookup"><span data-stu-id="35028-211">The steps to implement other providers are very similar to the steps you will see in this tutorial.</span></span>

<span data-ttu-id="35028-212">Ek olarak, kimlik, öğreticiyi de rolleri yetkilendirme uygulamak için kullanır.</span><span class="sxs-lookup"><span data-stu-id="35028-212">In addition to authentication, the tutorial will also use roles to implement authorization.</span></span> <span data-ttu-id="35028-213">Yalnızca eklediğiniz kullanıcılar `canEdit` rolü verileri değiştirmek mümkün olacaktır (oluşturmak, düzenlemek veya kişiler Sil).</span><span class="sxs-lookup"><span data-stu-id="35028-213">Only those users you add to the `canEdit` role will be able to change data (create, edit, or delete contacts).</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="35028-214">Oturum açma bilgileri test etmek için bir yerel Web sitesi URL'si kullanamazlar Windows Live uygulamalar yalnızca bir çalışma Web sitesi için Canlı bir URL kabul edin.</span><span class="sxs-lookup"><span data-stu-id="35028-214">Windows Live applications only accept a live URL for a working website, so you cannot use a local website URL for testing logins.</span></span>


<span data-ttu-id="35028-215">Aşağıdaki adımlar, Google kimlik doğrulama sağlayıcısı eklemenize izin verir.</span><span class="sxs-lookup"><span data-stu-id="35028-215">The following steps will allow you to add a Google authentication provider.</span></span>

1. <span data-ttu-id="35028-216">Açık *uygulama\_Start\Startup.Auth.cs* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-216">Open the *App\_Start\Startup.Auth.cs* file.</span></span>
2. <span data-ttu-id="35028-217">Açıklama karakterlerinden kaldırmak `app.UseGoogleAuthentication()` yöntemi olarak yöntemi görünmesi izler:</span><span class="sxs-lookup"><span data-stu-id="35028-217">Remove the comment characters from the `app.UseGoogleAuthentication()` method so that the method appears as follows:</span></span> 

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample5.cs)]
3. <span data-ttu-id="35028-218">Gidin [Google geliştiriciler konsol](https://console.developers.google.com/).</span><span class="sxs-lookup"><span data-stu-id="35028-218">Navigate to the [Google Developers Console](https://console.developers.google.com/).</span></span> <span data-ttu-id="35028-219">Google developer e-posta hesabınızı (gmail.com) ile oturum açması gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-219">You will also need to sign-in with your Google developer email account (gmail.com).</span></span> <span data-ttu-id="35028-220">Bir Google hesabı yoksa seçin **bir hesap oluşturmanız** bağlantı.</span><span class="sxs-lookup"><span data-stu-id="35028-220">If you do not have a Google account, select the **Create an account** link.</span></span>   
   <span data-ttu-id="35028-221">Ardından, göreceğiniz **Google geliştiriciler konsol**.</span><span class="sxs-lookup"><span data-stu-id="35028-221">Next, you'll see the **Google Developers Console**.</span></span>   
    <span data-ttu-id="35028-222">![Google geliştiriciler konsol](checkout-and-payment-with-paypal/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="35028-222">![Google Developers Console](checkout-and-payment-with-paypal/_static/image8.png)</span></span>
4. <span data-ttu-id="35028-223">Tıklatın **proje oluştur** düğmesine tıklayın ve bir proje adı ve kimliği (varsayılan değerleri kullanabilirsiniz) girin.</span><span class="sxs-lookup"><span data-stu-id="35028-223">Click the **Create Project** button and enter a project name and ID (you can use the default values).</span></span> <span data-ttu-id="35028-224">Ardından **sözleşmesi onay kutusunu** ve **oluşturma** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-224">Then, click the **agreement checkbox** and the **Create** button.</span></span>  

    ![Google - yeni proje](checkout-and-payment-with-paypal/_static/image9.png)

   <span data-ttu-id="35028-226">Yeni Proje birkaç saniye içinde oluşturulur ve yeni projeler sayfa, tarayıcınızın görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-226">In a few seconds the new project will be created and your browser will display the new projects page.</span></span>
5. <span data-ttu-id="35028-227">Sol sekmede tıklatın **API'leri &amp; auth**ve ardından **kimlik bilgileri**.</span><span class="sxs-lookup"><span data-stu-id="35028-227">In the left tab, click **APIs &amp; auth**, and then click **Credentials**.</span></span>
6. <span data-ttu-id="35028-228">Tıklatın **yeni istemci kodu oluştur** altında **OAuth**.</span><span class="sxs-lookup"><span data-stu-id="35028-228">Click the **Create New Client ID** under **OAuth**.</span></span>   
   <span data-ttu-id="35028-229">**İstemci kimliği oluşturma** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-229">The **Create Client ID** dialog will be displayed.</span></span>   
    <span data-ttu-id="35028-230">![Google - istemci kodu oluştur](checkout-and-payment-with-paypal/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="35028-230">![Google - Create Client ID](checkout-and-payment-with-paypal/_static/image10.png)</span></span>
7. <span data-ttu-id="35028-231">İçinde **istemci kimliği oluşturma** iletişim kutusunda, varsayılan tutmak **Web uygulaması** uygulama türü için.</span><span class="sxs-lookup"><span data-stu-id="35028-231">In the **Create Client ID** dialog, keep the default **Web application** for the application type.</span></span>
8. <span data-ttu-id="35028-232">Ayarlama **yetkili JavaScript çıkış** Bu öğreticide daha önce kullanılan SSL URL'ye (`https://localhost:44300/` diğer SSL projeleri oluşturmuş olduğunuz sürece).</span><span class="sxs-lookup"><span data-stu-id="35028-232">Set the **Authorized JavaScript Origins** to the SSL URL you used earlier in this tutorial (`https://localhost:44300/` unless you've created other SSL projects).</span></span>   
   <span data-ttu-id="35028-233">Uygulamanız için kaynak URL'dir.</span><span class="sxs-lookup"><span data-stu-id="35028-233">This URL is the origin for your application.</span></span> <span data-ttu-id="35028-234">Bu örnek için yalnızca localhost test URL'sini girer.</span><span class="sxs-lookup"><span data-stu-id="35028-234">For this sample, you will only enter the localhost test URL.</span></span> <span data-ttu-id="35028-235">Ancak, birden fazla hesap localhost ve üretim için URL'lerini girebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-235">However, you can enter multiple URLs to account for localhost and production.</span></span>
9. <span data-ttu-id="35028-236">Ayarlama **yeniden yönlendirme URI'si yetkili** şu:</span><span class="sxs-lookup"><span data-stu-id="35028-236">Set the **Authorized Redirect URI** to the following:</span></span> 

    [!code-html[Main](checkout-and-payment-with-paypal/samples/sample6.html)]

   <span data-ttu-id="35028-237">Bu değer, ASP.NET OAuth URI'dir kullanıcılar google OAuth sunucusuyla iletişim kurar.</span><span class="sxs-lookup"><span data-stu-id="35028-237">This value is the URI that ASP.NET OAuth users to communicate with the google OAuth server.</span></span> <span data-ttu-id="35028-238">Yukarıda kullanılan SSL URL unutmayın ( `https://localhost:44300/` diğer SSL projeleri oluşturmuş olduğunuz sürece).</span><span class="sxs-lookup"><span data-stu-id="35028-238">Remember the SSL URL you used above (    `https://localhost:44300/` unless you've created other SSL projects).</span></span>
10. <span data-ttu-id="35028-239">Tıklatın **istemci kimliği oluşturma** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-239">Click the **Create Client ID** button.</span></span>
11. <span data-ttu-id="35028-240">Google geliştiriciler konsolunun sol menüsünde tıklatın **izin ekran** menü öğesi, ardından e-posta adresi ve ürün adı ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="35028-240">On the left menu of the Google Developers Console, click the **Consent screen** menu item, then set your email address and product name.</span></span> <span data-ttu-id="35028-241">Formu doldurduğunuzda tıklatın **kaydetmek**.</span><span class="sxs-lookup"><span data-stu-id="35028-241">When you have completed the form, click **Save**.</span></span>
12. <span data-ttu-id="35028-242">Tıklatın **API'leri** menü öğesi, aşağı kaydırın ve tıklatın **kapalı** düğmesine **Google + API**.</span><span class="sxs-lookup"><span data-stu-id="35028-242">Click the **APIs** menu item, scroll down and click the **off** button next to **Google+ API**.</span></span>   
    <span data-ttu-id="35028-243">Bu seçenek kabul Google + API olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-243">Accepting this option will enable the Google+ API.</span></span>
13. <span data-ttu-id="35028-244">Aynı zamanda güncelleştirmelisiniz **Microsoft.Owin** 3.0.0 sürümüne NuGet paketi.</span><span class="sxs-lookup"><span data-stu-id="35028-244">You must also update the **Microsoft.Owin** NuGet package to version 3.0.0.</span></span>   
    <span data-ttu-id="35028-245">Gelen **Araçları** menüsünde, select **NuGet Paket Yöneticisi** ve ardından **çözüm için NuGet paketlerini Yönet**.</span><span class="sxs-lookup"><span data-stu-id="35028-245">From the **Tools** menu, select **NuGet Package Manager** and then select **Manage NuGet Packages for Solution**.</span></span>  
    <span data-ttu-id="35028-246">Gelen **NuGet paketlerini Yönet** penceresi, bulma ve güncelleştirme **Microsoft.Owin** 3.0.0 sürümüne paket.</span><span class="sxs-lookup"><span data-stu-id="35028-246">From the **Manage NuGet Packages** window, find and update the **Microsoft.Owin** package to version 3.0.0.</span></span>
14. <span data-ttu-id="35028-247">Visual Studio'da güncelleştirme `UseGoogleAuthentication` yöntemi *Startup.Auth.cs* sayfa kopyalama ve yapıştırma tarafından **istemci kimliği** ve **gizli** yöntemiyle.</span><span class="sxs-lookup"><span data-stu-id="35028-247">In Visual Studio, update the `UseGoogleAuthentication` method of the *Startup.Auth.cs* page by copying and pasting the **Client ID** and **Client Secret** into the method.</span></span> <span data-ttu-id="35028-248">**İstemci kimliği** ve **gizli** aşağıda gösterilen değerleri örnekleri ve çalışmaz.</span><span class="sxs-lookup"><span data-stu-id="35028-248">The **Client ID** and **Client Secret** values shown below are samples and will not work.</span></span> 

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample7.cs?highlight=64-65)]
15. <span data-ttu-id="35028-249">Tuşuna **CTRL + F5** oluşturun ve uygulamayı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="35028-249">Press **CTRL+F5** to build and run the application.</span></span> <span data-ttu-id="35028-250">Tıklatın **oturum** bağlantı.</span><span class="sxs-lookup"><span data-stu-id="35028-250">Click the **Log in** link.</span></span>
16. <span data-ttu-id="35028-251">Altında **oturum açmak için başka bir hizmet kullanın**, tıklatın **Google**.</span><span class="sxs-lookup"><span data-stu-id="35028-251">Under **Use another service to log in**, click **Google**.</span></span>  
    <span data-ttu-id="35028-252">![Oturum aç](checkout-and-payment-with-paypal/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="35028-252">![Log in](checkout-and-payment-with-paypal/_static/image11.png)</span></span>
17. <span data-ttu-id="35028-253">Kimlik bilgilerinizi girmeniz gerekiyorsa, kimlik bilgilerinizi gireceğiniz google siteye yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="35028-253">If you need to enter your credentials, you will be redirected to the google site where you will enter your credentials.</span></span>  
    ![Google - oturum açma](checkout-and-payment-with-paypal/_static/image12.png)
18. <span data-ttu-id="35028-255">Kimlik bilgilerinizi girdikten sonra yeni oluşturduğunuz web uygulaması izinleri vermeniz istenir.</span><span class="sxs-lookup"><span data-stu-id="35028-255">After you enter your credentials, you will be prompted to give permissions to the web application you just created.</span></span>  
    ![Proje varsayılan hizmet hesabı](checkout-and-payment-with-paypal/_static/image13.png)
19. <span data-ttu-id="35028-257">Tıklatın **kabul**.</span><span class="sxs-lookup"><span data-stu-id="35028-257">Click **Accept**.</span></span> <span data-ttu-id="35028-258">Artık yeniden yönlendirileceği konum **kaydetmek** sayfasında **WingtipToys** Burada, kaydolabilir Google hesabınız uygulama.</span><span class="sxs-lookup"><span data-stu-id="35028-258">You will now be redirected back to the **Register** page of the **WingtipToys** application where you can register your Google account.</span></span>  
    <span data-ttu-id="35028-259">![Google hesabınız ile kaydetme](checkout-and-payment-with-paypal/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="35028-259">![Register with your Google Account](checkout-and-payment-with-paypal/_static/image14.png)</span></span>
20. <span data-ttu-id="35028-260">Gmail hesabınız için kullanılan yerel e-posta kayıt adını değiştirme seçeneğiniz vardır, ancak genellikle varsayılan e-posta diğer adı (diğer bir deyişle, kimlik doğrulaması için kullanılan bir) tutmak istiyor.</span><span class="sxs-lookup"><span data-stu-id="35028-260">You have the option of changing the local email registration name used for your Gmail account, but you generally want to keep the default email alias (that is, the one you used for authentication).</span></span> <span data-ttu-id="35028-261">Tıklatın **oturum** yukarıda gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="35028-261">Click **Log in** as shown above.</span></span>

### <a name="modifying-login-functionality"></a><span data-ttu-id="35028-262">Oturum açma işlevselliği değiştirme</span><span class="sxs-lookup"><span data-stu-id="35028-262">Modifying Login Functionality</span></span>

<span data-ttu-id="35028-263">Daha önce belirtildiği gibi Bu öğretici serisinde, kullanıcı kayıt işlevlerinin çoğunu ASP.NET Web Forms şablonunda varsayılan olarak dahil edilmiştir.</span><span class="sxs-lookup"><span data-stu-id="35028-263">As previously mentioned in this tutorial series, much of the user registration functionality has been included in the ASP.NET Web Forms template by default.</span></span> <span data-ttu-id="35028-264">Varsayılan değiştirecek artık *Login.aspx* ve *Register.aspx* çağırmak için sayfaları `MigrateCart` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="35028-264">Now you will modify the default *Login.aspx* and *Register.aspx* pages to call the `MigrateCart` method.</span></span> <span data-ttu-id="35028-265">`MigrateCart` Yöntemi yeni oturum açmış kullanıcının anonim bir alışveriş sepeti ile ilişkilendirir.</span><span class="sxs-lookup"><span data-stu-id="35028-265">The `MigrateCart` method associates a newly logged in user with an anonymous shopping cart.</span></span> <span data-ttu-id="35028-266">Kullanıcı ilişkilendirme ve alışveriş sepeti Wingtip Toys örnek uygulama ziyaretleri kullanıcının alışveriş sepeti korumak kuramaz.</span><span class="sxs-lookup"><span data-stu-id="35028-266">By associating the user and shopping cart, the Wingtip Toys sample application will be able to maintain the shopping cart of the user between visits.</span></span>

1. <span data-ttu-id="35028-267">İçinde **Çözüm Gezgini**, bulma ve açma *hesap* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-267">In **Solution Explorer**, find and open the *Account* folder.</span></span>
2. <span data-ttu-id="35028-268">Adlı arka plan kod sayfası değiştirmek *Login.aspx.cs* şu şekilde görünmesi sarı ile vurgulanmış kodu eklemek için:</span><span class="sxs-lookup"><span data-stu-id="35028-268">Modify the code-behind page named *Login.aspx.cs* to include the code highlighted in yellow, so that it appears as follows:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample8.cs?highlight=41-43)]
3. <span data-ttu-id="35028-269">Kaydet *Login.aspx.cs* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-269">Save the *Login.aspx.cs* file.</span></span>

<span data-ttu-id="35028-270">Şimdilik, tanım için bu uyarıyı yoksayabilirsiniz `MigrateCart` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="35028-270">For now, you can ignore the warning that there is no definition for the `MigrateCart` method.</span></span> <span data-ttu-id="35028-271">Bu biraz daha sonra Bu öğreticide eklemek olacaktır.</span><span class="sxs-lookup"><span data-stu-id="35028-271">You will be adding it a bit later in this tutorial.</span></span>

<span data-ttu-id="35028-272">*Login.aspx.cs* arka plan kod dosyasına bir oturum açma yöntemini destekler.</span><span class="sxs-lookup"><span data-stu-id="35028-272">The *Login.aspx.cs* code-behind file supports a LogIn method.</span></span> <span data-ttu-id="35028-273">Login.aspx sayfasına inceleyerek bu sayfa "Oturum" düğmesi içerir görürsünüz olduğunda Tetikleyicileri tıklatın `LogIn` arka plan kodu üzerinde işleyici.</span><span class="sxs-lookup"><span data-stu-id="35028-273">By inspecting the Login.aspx page, you'll see that this page includes a "Log in" button that when click triggers the `LogIn` handler on the code-behind.</span></span>

<span data-ttu-id="35028-274">Zaman `Login` yöntemi *Login.aspx.cs* çağrılır, alışveriş sepeti adlı yeni bir örneğini `usersShoppingCart` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="35028-274">When the `Login` method on the *Login.aspx.cs* is called, a new instance of the shopping cart named `usersShoppingCart` is created.</span></span> <span data-ttu-id="35028-275">Alışveriş sepeti (GUID) Kimliğini alınır ve kümesine `cartId` değişkeni.</span><span class="sxs-lookup"><span data-stu-id="35028-275">The ID of the shopping cart (a GUID) is retrieved and set to the `cartId` variable.</span></span> <span data-ttu-id="35028-276">Ardından, `MigrateCart` yöntemi çağrıldığında, her ikisi de geçirme `cartId` ve bu yöntem için oturum açma kullanıcı adı.</span><span class="sxs-lookup"><span data-stu-id="35028-276">Then, the `MigrateCart` method is called, passing both the `cartId` and the name of the logged-in user to this method.</span></span> <span data-ttu-id="35028-277">Alışveriş sepeti geçirildiğinde anonim alışveriş sepeti tanımlamak için kullanılan GUID kullanıcı adı ile değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="35028-277">When the shopping cart is migrated, the GUID used to identify the anonymous shopping cart is replaced with the user name.</span></span>

<span data-ttu-id="35028-278">Değiştirme yanı sıra *Login.aspx.cs* alışveriş sepeti, kullanıcı oturumunu geçirmek için arka plan kodu dosyasını aynı zamanda değiştirmeniz gerekir *Register.aspx.cs arka plan kod dosyasına* alışveriş sepeti geçirmek için Kullanıcı yeni bir hesabı oluşturur ve oturum açtığında.</span><span class="sxs-lookup"><span data-stu-id="35028-278">In addition to modifying the *Login.aspx.cs* code-behind file to migrate the shopping cart when the user logs in, you must also modify the *Register.aspx.cs code-behind file* to migrate the shopping cart when the user creates a new account and logs in.</span></span>

1. <span data-ttu-id="35028-279">İçinde *hesap* arka plan kodu dosya adlı klasörü, açık *Register.aspx.cs*.</span><span class="sxs-lookup"><span data-stu-id="35028-279">In the *Account* folder, open the code-behind file named *Register.aspx.cs*.</span></span>
2. <span data-ttu-id="35028-280">Böylece aşağıdaki gibi görünür sarı olarak kod dahil olmak üzere arka plan kodu dosyasını değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-280">Modify the code-behind file by including the code in yellow, so that it appears as follows:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample9.cs?highlight=28-32)]
3. <span data-ttu-id="35028-281">Kaydet *Register.aspx.cs* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-281">Save the *Register.aspx.cs* file.</span></span> <span data-ttu-id="35028-282">Bir kez daha, hakkında uyarı yoksayılabilir `MigrateCart` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="35028-282">Once again, ignore the warning about the `MigrateCart` method.</span></span>

<span data-ttu-id="35028-283">Kod içinde kullandığınız fark `CreateUser_Click` olay işleyicisi içinde kullanılan kod çok benzer `LogIn` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="35028-283">Notice that the code you used in the `CreateUser_Click` event handler is very similar to the code you used in the `LogIn` method.</span></span> <span data-ttu-id="35028-284">Kullanıcı kayıtları veya oturum açtığında siteye yapılan bir çağrı olduğunda `MigrateCart` yöntemi yapılmayacak.</span><span class="sxs-lookup"><span data-stu-id="35028-284">When the user registers or logs in to the site, a call to the `MigrateCart` method will be made.</span></span>

## <a name="migrating-the-shopping-cart"></a><span data-ttu-id="35028-285">Alışveriş sepeti geçirme</span><span class="sxs-lookup"><span data-stu-id="35028-285">Migrating the Shopping Cart</span></span>

<span data-ttu-id="35028-286">Güncelleştirilmiş oturum açma ve kayıt işlemine sahip olduğunuza göre alışveriş sepeti kullanarak geçirmek için kod ekleyebilirsiniz `MigrateCart` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="35028-286">Now that you have the log-in and registration process updated, you can add the code to migrate the shopping cart using the `MigrateCart` method.</span></span>

1. <span data-ttu-id="35028-287">İçinde **Çözüm Gezgini**, bulma *mantığı* klasörü ve açık *ShoppingCartActions.cs* sınıf dosyası.</span><span class="sxs-lookup"><span data-stu-id="35028-287">In **Solution Explorer**, find the *Logic* folder and open the *ShoppingCartActions.cs* class file.</span></span>
2. <span data-ttu-id="35028-288">Var olan kodda sarıya vurgulanmış kodu ekleyin *ShoppingCartActions.cs* dosya, böylece kodu *ShoppingCartActions.cs* dosya şu şekilde görünür:</span><span class="sxs-lookup"><span data-stu-id="35028-288">Add the code highlighted in yellow to the existing code in the *ShoppingCartActions.cs* file, so that the code in the *ShoppingCartActions.cs* file appears as follows:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample10.cs?highlight=215-224)]

<span data-ttu-id="35028-289">`MigrateCart` Yöntemi, kullanıcının alışveriş sepeti bulmak için varolan cartId kullanır.</span><span class="sxs-lookup"><span data-stu-id="35028-289">The `MigrateCart` method uses the existing cartId to find the shopping cart of the user.</span></span> <span data-ttu-id="35028-290">Ardından, kod tüm alışveriş sepeti öğeler arasında döngü ve değiştirir `CartId` özelliği (belirtildiği gibi `CartItem` şema) ile oturum açma kullanıcı adı.</span><span class="sxs-lookup"><span data-stu-id="35028-290">Next, the code loops through all the shopping cart items and replaces the `CartId` property (as specified by the `CartItem` schema) with the logged-in user name.</span></span>

### <a name="updating-the-database-connection"></a><span data-ttu-id="35028-291">Veritabanı bağlantısı güncelleştiriliyor</span><span class="sxs-lookup"><span data-stu-id="35028-291">Updating the Database Connection</span></span>

<span data-ttu-id="35028-292">Bu öğretici kullanarak izliyorsanız **önceden oluşturulmuş** Wingtip Toys örnek uygulama, varsayılan üyelik veritabanının yeniden oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-292">If you are following this tutorial using the **prebuilt** Wingtip Toys sample application, you must recreate the default membership database.</span></span> <span data-ttu-id="35028-293">Varsayılan bağlantı dizesini değiştirerek, üyelik veritabanının uygulama çalıştığında oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="35028-293">By modifying the default connection string, the membership database will be created the next time the application runs.</span></span>

1. <span data-ttu-id="35028-294">Açık *Web.config* proje kökündeki dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-294">Open the *Web.config* file at the root of the project.</span></span>
2. <span data-ttu-id="35028-295">Varsayılan bağlantı dizesini gibi göründüğü şekilde güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-295">Update the default connection string so that it appears as follows:</span></span>   

    [!code-xml[Main](checkout-and-payment-with-paypal/samples/sample11.xml)]

<a id="PayPalWebForms"></a>
## <a name="integrating-paypal"></a><span data-ttu-id="35028-296">PayPal tümleştirme</span><span class="sxs-lookup"><span data-stu-id="35028-296">Integrating PayPal</span></span>

<span data-ttu-id="35028-297">PayPal ödemelerini çevrimiçi satıcı tarafından kabul eden bir web tabanlı fatura platformudur.</span><span class="sxs-lookup"><span data-stu-id="35028-297">PayPal is a web-based billing platform that accepts payments by online merchants.</span></span> <span data-ttu-id="35028-298">Bu öğreticinin sonraki PayPal'ın Express Checkout işlevselliği uygulamanıza tümleştirmek açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="35028-298">This tutorial next explains how to integrate PayPal's Express Checkout functionality into your application.</span></span> <span data-ttu-id="35028-299">Express Checkout müşterilerinizin PayPal kendi alışveriş sepetine eklemiş olduğunuz öğeleri için ödeme kullanmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-299">Express Checkout allows your customers to use PayPal to pay for the items they have added to their shopping cart.</span></span>

### <a name="create-paylpal-test-accounts"></a><span data-ttu-id="35028-300">PaylPal Test hesapları oluşturma</span><span class="sxs-lookup"><span data-stu-id="35028-300">Create PaylPal Test Accounts</span></span>

<span data-ttu-id="35028-301">Sınama ortamı PayPal kullanmak için oluşturma ve bir geliştirici test hesabı doğrulamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-301">To use the PayPal testing environment, you must create and verify a developer test account.</span></span> <span data-ttu-id="35028-302">Bir alıcı test hesabınız ve satıcı test hesabınız oluşturmak için geliştirici test hesabını kullanır.</span><span class="sxs-lookup"><span data-stu-id="35028-302">You will use the developer test account to create a buyer test account and a seller test account.</span></span> <span data-ttu-id="35028-303">Geliştirici testi hesap kimlik bilgilerini de PayPal test ortamını erişmek Wingtip Toys örnek uygulama izin verir.</span><span class="sxs-lookup"><span data-stu-id="35028-303">The developer test account credentials also will allow the Wingtip Toys sample application to access the PayPal testing environment.</span></span>

1. <span data-ttu-id="35028-304">Bir tarayıcıda, site test PayPal Geliştirici gidin:</span><span class="sxs-lookup"><span data-stu-id="35028-304">In a browser, navigate to the PayPal developer testing site:</span></span>   
    [https://developer.paypal.com](https://developer.paypal.com/)
2. <span data-ttu-id="35028-305">PayPal Geliştirici hesabınız yoksa, yeni bir hesap oluşturun **kaydolun**kayıt adımları izleyerek.</span><span class="sxs-lookup"><span data-stu-id="35028-305">If you don't have a PayPal developer account, create a new account by clicking **Sign Up**and following the sign up steps.</span></span> <span data-ttu-id="35028-306">PayPal Geliştirici hesabınız varsa, tıklayarak oturum **oturum**.</span><span class="sxs-lookup"><span data-stu-id="35028-306">If you have an existing PayPal developer account, sign in by clicking **Log In**.</span></span> <span data-ttu-id="35028-307">PayPal Geliştirici hesabınızda daha sonra Bu öğreticide Wingtip Toys örnek uygulamanızı test etmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-307">You will need your PayPal developer account to test the Wingtip Toys sample application later in this tutorial.</span></span>
3. <span data-ttu-id="35028-308">Yalnızca PayPal Geliştirici hesabınız için kaydolduysanız, PayPal, PayPal Geliştirici hesabınızla doğrulamak gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="35028-308">If you have just signed up for your PayPal developer account, you may need to verify your PayPal developer account with PayPal.</span></span> <span data-ttu-id="35028-309">E-posta hesabınızı PayPal gönderilen adımları izleyerek hesabınızı doğrulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-309">You can verify your account by following the steps that PayPal sent to your email account.</span></span> <span data-ttu-id="35028-310">PayPal Geliştirici hesabınızda doğruladıktan sonra site test geri PayPal Geliştirici oturum açın.</span><span class="sxs-lookup"><span data-stu-id="35028-310">Once you have verified your PayPal developer account, log back into the PayPal developer testing site.</span></span>
4. <span data-ttu-id="35028-311">PayPal Geliştirici siteye zaten yapmazsanız PayPal alıcı sınama hesabı oluşturmanız gerekir, PayPal Geliştirici hesabınızla oturum sonra vardır.</span><span class="sxs-lookup"><span data-stu-id="35028-311">After you are logged in to the PayPal developer site with your PayPal developer account you need to create a PayPal buyer test account if you don't already have one.</span></span> <span data-ttu-id="35028-312">Bir alıcı test hesabınız, PayPal site tıklatıldığında oluşturmak için **uygulamaları** sekmesini ve sonra **korumalı alan hesapları**.</span><span class="sxs-lookup"><span data-stu-id="35028-312">To create a buyer test account, on the PayPal site click the **Applications** tab and then click **Sandbox accounts**.</span></span>   
 <span data-ttu-id="35028-313">**Korumalı alan test hesapları** sayfası gösterilir.</span><span class="sxs-lookup"><span data-stu-id="35028-313">The **Sandbox test accounts** page is shown.</span></span>   

    > [!NOTE] 
    > 
    > <span data-ttu-id="35028-314">PayPal Geliştirici sitesi zaten bir ticari test hesabı sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-314">The PayPal Developer site already provides a merchant test account.</span></span>

    ![Kullanıma alma ve ödeme PayPal - korumalı alan test hesapları ile](checkout-and-payment-with-paypal/_static/image15.png)
5. <span data-ttu-id="35028-316">Korumalı alan test hesapları sayfasında, tıklatın **hesap oluştur**.</span><span class="sxs-lookup"><span data-stu-id="35028-316">On the Sandbox test accounts page, click **Create Account**.</span></span>
6. <span data-ttu-id="35028-317">Üzerinde **test hesap oluştur** sayfa test hesabı e-posta ve parola tercih ettiğiniz bir alıcı seçin.</span><span class="sxs-lookup"><span data-stu-id="35028-317">On the **Create test account** page choose a buyer test account email and password of your choice.</span></span>   

    > [!NOTE] 
    > 
    > <span data-ttu-id="35028-318">Alıcı e-posta adreslerini ve bu öğreticinin sonunda Wingtip Toys örnek uygulamayı test etmek için parola gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-318">You will need the buyer email addresses and password to test the Wingtip Toys sample application at the end of this tutorial.</span></span>

    ![Kullanıma alma ve ödeme PayPal - korumalı alan test hesapları ile](checkout-and-payment-with-paypal/_static/image16.png)
7. <span data-ttu-id="35028-320">Tıklayarak alıcı test hesabı oluşturma **hesap oluştur** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-320">Create the buyer test account by clicking the **Create Account** button.</span></span>  
 <span data-ttu-id="35028-321">**Korumalı alan Test hesapları** sayfası görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-321">The **Sandbox Test accounts** page is displayed.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - PaylPal hesapları ile](checkout-and-payment-with-paypal/_static/image17.png)
8. <span data-ttu-id="35028-323">Üzerinde **korumalı alan test hesapları** sayfasında, **yönetici** e-posta hesabı.</span><span class="sxs-lookup"><span data-stu-id="35028-323">On the **Sandbox test accounts** page, click the **facilitator** email account.</span></span>  
    <span data-ttu-id="35028-324">**Profil** ve **bildirim** seçenekler görünür.</span><span class="sxs-lookup"><span data-stu-id="35028-324">**Profile** and **Notification** options appear.</span></span>
9. <span data-ttu-id="35028-325">Seçin **profil** seçeneğini ve ardından **API kimlik** Tüccar sınama hesabı için API kimlik bilgilerinizi görüntülemek için.</span><span class="sxs-lookup"><span data-stu-id="35028-325">Select the **Profile** option, then click **API credentials** to view your API credentials for the merchant test account.</span></span>
10. <span data-ttu-id="35028-326">TEST API'si kimlik bilgilerini Not Defteri'ne kopyalayın.</span><span class="sxs-lookup"><span data-stu-id="35028-326">Copy the TEST API credentials to notepad.</span></span>

<span data-ttu-id="35028-327">Sınama ortamı PayPal görüntülenen Klasik TEST API kimlik bilgilerinizi (kullanıcı adı, parola ve imza) API çağrıları Wingtip Toys örnek uygulamadan yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-327">You will need your displayed Classic TEST API credentials (Username, Password, and Signature) to make API calls from the Wingtip Toys sample application to the PayPal testing environment.</span></span> <span data-ttu-id="35028-328">Kimlik bilgileri sonraki adımda ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-328">You will add the credentials in the next step.</span></span>

### <a name="add-paypal-class-and-api-credentials"></a><span data-ttu-id="35028-329">PayPal sınıfı ve API kimlik bilgileri ekleme</span><span class="sxs-lookup"><span data-stu-id="35028-329">Add PayPal Class and API Credentials</span></span>

<span data-ttu-id="35028-330">PayPal kod çoğunluğu tek bir sınıf içine yerleştirir.</span><span class="sxs-lookup"><span data-stu-id="35028-330">You will place the majority of the PayPal code into a single class.</span></span> <span data-ttu-id="35028-331">Bu sınıf, PayPal ile iletişim kurmak için kullanılan yöntemler içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-331">This class contains the methods used to communicate with PayPal.</span></span> <span data-ttu-id="35028-332">Ayrıca, bu sınıfa PayPal kimlik bilgilerinizi ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-332">Also, you will add your PayPal credentials to this class.</span></span>

1. <span data-ttu-id="35028-333">Visual Studio içinde Wingtip Toys örnek uygulamayı sağ **mantığı** klasörünü ve ardından **Ekle**  - &gt; **yeni öğe**.</span><span class="sxs-lookup"><span data-stu-id="35028-333">In the Wingtip Toys sample application within Visual Studio, right-click the **Logic** folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="35028-334">**Yeni Öğe Ekle** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-334">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="35028-335">Altında **Visual C#** gelen **yüklü** seçin sol bölmede **kod**.</span><span class="sxs-lookup"><span data-stu-id="35028-335">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span>
3. <span data-ttu-id="35028-336">Orta bölmesinden seçin **sınıfı**.</span><span class="sxs-lookup"><span data-stu-id="35028-336">From the middle pane, select **Class**.</span></span> <span data-ttu-id="35028-337">Bu yeni sınıf adını **PayPalFunctions.cs**.</span><span class="sxs-lookup"><span data-stu-id="35028-337">Name this new class **PayPalFunctions.cs**.</span></span>
4. <span data-ttu-id="35028-338">**Ekle**'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="35028-338">Click **Add**.</span></span>  
   <span data-ttu-id="35028-339">Yeni sınıf dosyası Düzenleyicisi'nde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-339">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="35028-340">Varsayılan kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-340">Replace the default code with the following code:</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample12.cs)]
6. <span data-ttu-id="35028-341">Bu öğreticide daha önce görüntülenen ve böylece PayPal test ortamını işlev çağrılarını yapabileceğiniz satıcı API kimlik bilgilerini (kullanıcı adı, parola ve imza) ekleyin.</span><span class="sxs-lookup"><span data-stu-id="35028-341">Add the Merchant API credentials (Username, Password, and Signature) that you displayed earlier in this tutorial so that you can make function calls to the PayPal testing environment.</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample13.cs)]

> [!NOTE] 
> 
> <span data-ttu-id="35028-342">Bu örnek uygulamasında bir C# dosyasına (.cs) kimlik bilgilerini yalnızca ekliyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="35028-342">In this sample application you are simply adding credentials to a C# file (.cs).</span></span> <span data-ttu-id="35028-343">Ancak, uygulanan bir çözümde bir yapılandırma dosyası kimlik bilgilerinizi şifrelemek düşünmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-343">However, in a implemented solution, you should consider encrypting your credentials in a configuration file.</span></span>


<span data-ttu-id="35028-344">NVPAPICaller sınıfı PayPal işlevselliğin çoğu içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-344">The NVPAPICaller class contains the majority of the PayPal functionality.</span></span> <span data-ttu-id="35028-345">Sınıfı kodda PayPal sınama ortamından satın test yapmak için gereken yöntemleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-345">The code in the class provides the methods needed to make a test purchase from the PayPal testing environment.</span></span> <span data-ttu-id="35028-346">Aşağıdaki üç PayPal işlevleri, satın alma işlemleri yapmak için kullanılır:</span><span class="sxs-lookup"><span data-stu-id="35028-346">The following three PayPal functions are used to make purchases:</span></span>

- <span data-ttu-id="35028-347">`SetExpressCheckout` İşlevi</span><span class="sxs-lookup"><span data-stu-id="35028-347">`SetExpressCheckout` function</span></span>
- <span data-ttu-id="35028-348">`GetExpressCheckoutDetails` İşlevi</span><span class="sxs-lookup"><span data-stu-id="35028-348">`GetExpressCheckoutDetails` function</span></span>
- <span data-ttu-id="35028-349">`DoExpressCheckoutPayment` İşlevi</span><span class="sxs-lookup"><span data-stu-id="35028-349">`DoExpressCheckoutPayment` function</span></span>

<span data-ttu-id="35028-350">`ShortcutExpressCheckout` Yöntemi toplar test satın alma bilgileri ve ürün ayrıntıları alışveriş sepeti ve çağrıları `SetExpressCheckout` PayPal işlevi.</span><span class="sxs-lookup"><span data-stu-id="35028-350">The `ShortcutExpressCheckout` method collects the test purchase information and product details from the shopping cart and calls the `SetExpressCheckout` PayPal function.</span></span> <span data-ttu-id="35028-351">`GetCheckoutDetails` Yöntemini onaylar satın alma ayrıntıları ve çağrıları `GetExpressCheckoutDetails` test satın alma yapmadan önce PayPal işlevi.</span><span class="sxs-lookup"><span data-stu-id="35028-351">The `GetCheckoutDetails` method confirms purchase details and calls the `GetExpressCheckoutDetails` PayPal function before making the test purchase.</span></span> <span data-ttu-id="35028-352">`DoCheckoutPayment` Yöntemi çağrılarak sınama ortamından test satınalma tamamlayan `DoExpressCheckoutPayment` PayPal işlevi.</span><span class="sxs-lookup"><span data-stu-id="35028-352">The `DoCheckoutPayment` method completes the test purchase from the testing environment by calling the `DoExpressCheckoutPayment` PayPal function.</span></span> <span data-ttu-id="35028-353">Kalan kod PayPal yöntemleri ve işlemin dizeleri kodlama, dizeleri kod çözme, dizileri işleme ve kimlik bilgilerini belirleme gibi destekler.</span><span class="sxs-lookup"><span data-stu-id="35028-353">The remaining code supports the PayPal methods and process, such as encoding strings, decoding strings, processing arrays, and determining credentials.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="35028-354">PayPal göre isteğe bağlı satın alma ayrıntıları dahil etmenize olanak verir [PayPal'ın API belirtimine](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&amp;content_ID=developer/e_howto_api_nvp_r_SetExpressCheckout).</span><span class="sxs-lookup"><span data-stu-id="35028-354">PayPal allows you to include optional purchase details based on [PayPal's API specification](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&amp;content_ID=developer/e_howto_api_nvp_r_SetExpressCheckout).</span></span> <span data-ttu-id="35028-355">Wingtip Toys örnek uygulama kodunda genişleterek, yerelleştirme ayrıntıları, ürün tanımları, vergi, bir müşteri hizmeti numarası yanı sıra diğer birçok isteğe bağlı alanları içerebilir.</span><span class="sxs-lookup"><span data-stu-id="35028-355">By extending the code in the Wingtip Toys sample application, you can include localization details, product descriptions, tax, a customer service number, as well as many other optional fields.</span></span>


<span data-ttu-id="35028-356">Dikkat belirtilen dönüş ve iptal URL'leri **ShortcutExpressCheckout** yöntemi bir bağlantı noktası numarasını kullanın.</span><span class="sxs-lookup"><span data-stu-id="35028-356">Notice that the return and cancel URLs that are specified in the **ShortcutExpressCheckout** method use a port number.</span></span>

[!code-html[Main](checkout-and-payment-with-paypal/samples/sample14.html)]

<span data-ttu-id="35028-357">Yaygın olarak Visual Web Developer SSL kullanarak bir web projesi çalıştığında, bağlantı noktası 44300 web sunucusu için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="35028-357">When Visual Web Developer runs a web project using SSL, commonly the port 44300 is used for the web server.</span></span> <span data-ttu-id="35028-358">Yukarıda gösterildiği gibi bağlantı noktası numarasını 44300 olur.</span><span class="sxs-lookup"><span data-stu-id="35028-358">As shown above, the port number is 44300.</span></span> <span data-ttu-id="35028-359">Uygulamayı çalıştırdığınızda, farklı bir bağlantı noktası görebilir.</span><span class="sxs-lookup"><span data-stu-id="35028-359">When you run the application, you could see a different port number.</span></span> <span data-ttu-id="35028-360">Bağlantı noktası numarası gereksinimlerinizi yapabilmeniz doğru kodda başarılı ayarlanması, bu öğreticinin sonunda Wingtip Toys örnek uygulamayı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="35028-360">Your port number needs to be correctly set in the code so that you can successful run the Wingtip Toys sample application at the end of this tutorial.</span></span> <span data-ttu-id="35028-361">Bu öğreticinin sonraki bölümde, yerel ana bilgisayar bağlantı noktası numarasını almak ve PayPal sınıfını güncelleştirme açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="35028-361">The next section of this tutorial explains how to retrieve the local host port number and update the PayPal class.</span></span>

### <a name="update-the-localhost-port-number-in-the-paypal-class"></a><span data-ttu-id="35028-362">Güncelleştirme PayPal sınıfındaki LocalHost bağlantı noktası numarası</span><span class="sxs-lookup"><span data-stu-id="35028-362">Update the LocalHost Port Number in the PayPal Class</span></span>

<span data-ttu-id="35028-363">Wingtip Toys örnek uygulama, PayPal test siteye gittikten Wingtip Toys örnek uygulamayı yerel örneğine döndürme ürünleri satın alır.</span><span class="sxs-lookup"><span data-stu-id="35028-363">The Wingtip Toys sample application purchases products by navigating to the PayPal testing site and returning to your local instance of the Wingtip Toys sample application.</span></span> <span data-ttu-id="35028-364">URL'nin doğru dönüş PayPal olması için yerel olarak çalışan bağlantı noktası numarasını belirtmeniz gerekir örnek uygulama yukarıda belirtilen PayPal kod.</span><span class="sxs-lookup"><span data-stu-id="35028-364">In order to have PayPal return to the correct URL, you need to specify the port number of the locally running sample application in the PayPal code mentioned above.</span></span>

1. <span data-ttu-id="35028-365">Proje adına sağ tıklayın (**WingtipToys**) içinde **Çözüm Gezgini** seçip **özellikleri**.</span><span class="sxs-lookup"><span data-stu-id="35028-365">Right-click the project name (**WingtipToys**) in **Solution Explorer** and select **Properties**.</span></span>
2. <span data-ttu-id="35028-366">Sol sütunda seçin **Web** sekmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-366">In the left column, select the **Web** tab.</span></span>
3. <span data-ttu-id="35028-367">Bağlantı noktası numarasından almak **proje URL'sini** kutusu.</span><span class="sxs-lookup"><span data-stu-id="35028-367">Retrieve the port number from the **Project Url** box.</span></span>
4. <span data-ttu-id="35028-368">Gerekirse, güncelleştirme `returnURL` ve `cancelURL` PayPal sınıfında (`NVPAPICaller`) içinde *PayPalFunctions.cs* web uygulamanızı bağlantı noktası numarasını kullanmak üzere bir dosya:</span><span class="sxs-lookup"><span data-stu-id="35028-368">If needed, update the `returnURL` and `cancelURL` in the PayPal class (`NVPAPICaller`) in the *PayPalFunctions.cs* file to use the port number of your web application:</span></span>   

    [!code-html[Main](checkout-and-payment-with-paypal/samples/sample15.html?highlight=1-2)]

<span data-ttu-id="35028-369">Şimdi eklediğiniz kodu yerel Web uygulamanız için beklenen bağlantı noktası ile eşleşir.</span><span class="sxs-lookup"><span data-stu-id="35028-369">Now the code that you added will match the expected port for your local Web application.</span></span> <span data-ttu-id="35028-370">PayPal URL'nin doğru yerel makinenizde iade etme olanağınız olur.</span><span class="sxs-lookup"><span data-stu-id="35028-370">PayPal will be able to return to the correct URL on your local machine.</span></span>

### <a name="add-the-paypal-checkout-button"></a><span data-ttu-id="35028-371">PayPal ödeme düğme ekleme</span><span class="sxs-lookup"><span data-stu-id="35028-371">Add the PayPal Checkout Button</span></span>

<span data-ttu-id="35028-372">Birincil PayPal işlevleri örnek uygulama için eklenene, biçimlendirme ve bu işlevleri çağırmak için gereken kod eklemeye başlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-372">Now that the primary PayPal functions have been added to the sample application, you can begin adding the markup and code needed to call these functions.</span></span> <span data-ttu-id="35028-373">İlk olarak, kullanıcı alışveriş sepeti sayfasında göreceğiniz çıkış düğmesi eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-373">First, you must add the checkout button that the user will see on the shopping cart page.</span></span>

1. <span data-ttu-id="35028-374">Açık *ShoppingCart.aspx* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-374">Open the *ShoppingCart.aspx* file.</span></span>
2. <span data-ttu-id="35028-375">Dosyanın sonuna kaydırın ve Bul `<!--Checkout Placeholder -->` açıklama.</span><span class="sxs-lookup"><span data-stu-id="35028-375">Scroll to the bottom of the file and find the `<!--Checkout Placeholder -->` comment.</span></span>
3. <span data-ttu-id="35028-376">İle açıklamayı değiştirin bir `ImageButton` işaretleme şu şekilde değiştirilir böylece denetleme:</span><span class="sxs-lookup"><span data-stu-id="35028-376">Replace the comment with an `ImageButton` control so that the mark up is replaced as follows:</span></span>  

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample16.aspx)]
4. <span data-ttu-id="35028-377">İçinde *ShoppingCart.aspx.cs* sonra dosya `UpdateBtn_Click` dosyasının sonuna yakın olay işleyicisi ekleme `CheckOutBtn_Click` olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="35028-377">In the *ShoppingCart.aspx.cs* file, after the `UpdateBtn_Click` event handler near the end of the file, add the `CheckOutBtn_Click` event handler:</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample17.cs)]
5. <span data-ttu-id="35028-378">Ayrıca, *ShoppingCart.aspx.cs* dosya, bir başvuru ekleyin `CheckoutBtn`, böylece yeni görüntü düğmesi gibi başvuruluyor:</span><span class="sxs-lookup"><span data-stu-id="35028-378">Also in the *ShoppingCart.aspx.cs* file, add a reference to the `CheckoutBtn`, so that the new image button is referenced as follows:</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample18.cs?highlight=18)]
6. <span data-ttu-id="35028-379">Her ikisi de yaptığınız değişiklikleri kaydetmek *ShoppingCart.aspx* dosya ve *ShoppingCart.aspx.cs* dosya.</span><span class="sxs-lookup"><span data-stu-id="35028-379">Save your changes to both the *ShoppingCart.aspx* file and the *ShoppingCart.aspx.cs* file.</span></span>
7. <span data-ttu-id="35028-380">Menüsünden seçin **hata ayıklama**-&gt;**yapı WingtipToys**.</span><span class="sxs-lookup"><span data-stu-id="35028-380">From the menu, select **Debug**-&gt;**Build WingtipToys**.</span></span>  
   <span data-ttu-id="35028-381">Projeyi yeniden yeni eklenen ile **ImageButton** denetim.</span><span class="sxs-lookup"><span data-stu-id="35028-381">The project will be rebuilt with the newly added **ImageButton** control.</span></span>

### <a name="send-purchase-details-to-paypal"></a><span data-ttu-id="35028-382">Satın alma ayrıntıları PayPal için Gönder</span><span class="sxs-lookup"><span data-stu-id="35028-382">Send Purchase Details to PayPal</span></span>

<span data-ttu-id="35028-383">Kullanıcı tıkladığında **Checkout** alışveriş sepeti sayfasında düğmesini (*ShoppingCart.aspx*), satın alma işlemini başlarsınız.</span><span class="sxs-lookup"><span data-stu-id="35028-383">When the user clicks the **Checkout** button on the shopping cart page (*ShoppingCart.aspx*), they'll begin the purchase process.</span></span> <span data-ttu-id="35028-384">Aşağıdaki kod ürünleri satın almak için gereken ilk PayPal işlevi çağırır.</span><span class="sxs-lookup"><span data-stu-id="35028-384">The following code calls the first PayPal function needed to purchase products.</span></span>

1. <span data-ttu-id="35028-385">Gelen *Checkout* arka plan kodu dosya adlı klasörü, açık *CheckoutStart.aspx.cs*.</span><span class="sxs-lookup"><span data-stu-id="35028-385">From the *Checkout* folder, open the code-behind file named *CheckoutStart.aspx.cs*.</span></span>   
   <span data-ttu-id="35028-386">Arka plan kodu dosyayı açmaya emin olun.</span><span class="sxs-lookup"><span data-stu-id="35028-386">Be sure to open the code-behind file.</span></span>
2. <span data-ttu-id="35028-387">Var olan kodu aşağıdakilerle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-387">Replace the existing code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample19.cs)]

<span data-ttu-id="35028-388">Uygulamanın kullanıcı tıkladığında **Checkout** alışveriş sepeti sayfasında, tarayıcı düğmesi gidin *CheckoutStart.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="35028-388">When the user of the application clicks the **Checkout** button on the shopping cart page, the browser will navigate to the *CheckoutStart.aspx* page.</span></span> <span data-ttu-id="35028-389">Zaman *CheckoutStart.aspx* sayfa yüklendiğinde `ShortcutExpressCheckout` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="35028-389">When the *CheckoutStart.aspx* page loads, the `ShortcutExpressCheckout` method is called.</span></span> <span data-ttu-id="35028-390">Bu noktada, kullanıcı PayPal test web sitesine aktarılır.</span><span class="sxs-lookup"><span data-stu-id="35028-390">At this point, the user is transferred to the PayPal testing web site.</span></span> <span data-ttu-id="35028-391">PayPal sitesinde kullanıcı PayPal kimlik bilgilerini girer, satın alma ayrıntıları gözden geçirir, PayPal sözleşmesini kabul eder ve Wingtip Toys örnek uygulamaya döndürür nerede `ShortcutExpressCheckout` yöntemi tamamlar.</span><span class="sxs-lookup"><span data-stu-id="35028-391">On the PayPal site, the user enters their PayPal credentials, reviews the purchase details, accepts the PayPal agreement and returns to the Wingtip Toys sample application where the `ShortcutExpressCheckout` method completes.</span></span> <span data-ttu-id="35028-392">Zaman `ShortcutExpressCheckout` yöntemi tamamlandığında, kullanıcıya yönlendirir *CheckoutReview.aspx* belirtilen sayfa `ShortcutExpressCheckout` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="35028-392">When the `ShortcutExpressCheckout` method is complete, it will redirect the user to the *CheckoutReview.aspx* page specified in the `ShortcutExpressCheckout` method.</span></span> <span data-ttu-id="35028-393">Bu kullanıcının Wingtip Toys örnek uygulamasında sipariş ayrıntıları gözden olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-393">This allows the user to review the order details from within the Wingtip Toys sample application.</span></span>

### <a name="review-order-details"></a><span data-ttu-id="35028-394">Sipariş ayrıntılarını gözden geçir</span><span class="sxs-lookup"><span data-stu-id="35028-394">Review Order Details</span></span>

<span data-ttu-id="35028-395">PayPal döndürmeden sonra *CheckoutReview.aspx* Wingtip Toys örnek uygulaması sayfasında sipariş ayrıntılarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="35028-395">After returning from PayPal, the *CheckoutReview.aspx* page of the Wingtip Toys sample application displays the order details.</span></span> <span data-ttu-id="35028-396">Bu sayfa ürünleri satın almadan önce sipariş ayrıntılarını gözden geçirmek kullanıcı sağlar.</span><span class="sxs-lookup"><span data-stu-id="35028-396">This page allows the user to review the order details before purchasing the products.</span></span> <span data-ttu-id="35028-397">*CheckoutReview.aspx* sayfa gibi oluşturulmalıdır:</span><span class="sxs-lookup"><span data-stu-id="35028-397">The *CheckoutReview.aspx* page must be created as follows:</span></span>

1. <span data-ttu-id="35028-398">İçinde *Checkout* sayfa adlı klasörü, açık *CheckoutReview.aspx*.</span><span class="sxs-lookup"><span data-stu-id="35028-398">In the *Checkout* folder, open the page named *CheckoutReview.aspx*.</span></span>
2. <span data-ttu-id="35028-399">Varolan biçimlendirme aşağıdakiyle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-399">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample20.aspx)]
3. <span data-ttu-id="35028-400">Adlı arka plan kod sayfası açmak *CheckoutReview.aspx.cs* ve var olan kodu aşağıdakilerle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-400">Open the code-behind page named *CheckoutReview.aspx.cs* and replace the existing code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample21.cs)]

<span data-ttu-id="35028-401">**DetailsView** denetimi PayPal döndürülen sipariş ayrıntılarını görüntülemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="35028-401">The **DetailsView** control is used to display the order details that have been returned from PayPal.</span></span> <span data-ttu-id="35028-402">Ayrıca, yukarıdaki kod Wingtip Toys veritabanına sipariş ayrıntılarını kaydeder bir `OrderDetail` nesnesi.</span><span class="sxs-lookup"><span data-stu-id="35028-402">Also, the above code saves the order details to the Wingtip Toys database as an `OrderDetail` object.</span></span> <span data-ttu-id="35028-403">Kullanıcı tıkladığında üzerinde **tam sipariş** düğmesi, bunlar yönlendirilir için *CheckoutComplete.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="35028-403">When the user clicks on the **Complete Order** button, they are redirected to the *CheckoutComplete.aspx* page.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="35028-404">**İpucu**</span><span class="sxs-lookup"><span data-stu-id="35028-404">**Tip**</span></span>
> 
> <span data-ttu-id="35028-405">Biçimlendirmede *CheckoutReview.aspx* sayfasında, dikkat `<ItemStyle>` etiketi içinde öğelerin stilini değiştirmek için kullanılan **DetailsView** denetim sayfanın yakın.</span><span class="sxs-lookup"><span data-stu-id="35028-405">In the markup of the *CheckoutReview.aspx* page, notice that the `<ItemStyle>` tag is used to change the style of the items within the **DetailsView** control near the bottom of the page.</span></span> <span data-ttu-id="35028-406">Sayfanın görüntüleyerek **Tasarım görünümünde** (seçerek **tasarım** Visual Studio'nun sol alt köşesindeki), ardından seçerek **DetailsView** denetlemek ve seçme **Akıllı etiket** (üstündeki ok simgesine sağ denetiminin), görmeye olacaktır **DetailsView görevleri**.</span><span class="sxs-lookup"><span data-stu-id="35028-406">By viewing the page in **Design View** (by selecting **Design** at the lower left corner of Visual Studio), then selecting the **DetailsView** control, and selecting the **Smart Tag** (the arrow icon at the top right of the control), you will be able to see the **DetailsView Tasks**.</span></span>
> 
> ![Kullanıma alma ve PayPal - ödemeyle alanları Düzenle](checkout-and-payment-with-paypal/_static/image18.png)
> 
> <span data-ttu-id="35028-408">Seçerek **alanları Düzenle**, **alanları** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-408">By selecting **Edit Fields**, the **Fields** dialog box will appear.</span></span> <span data-ttu-id="35028-409">Bu iletişim kutusunda, kolayca görsel özelliklerini gibi denetleyebilirsiniz **ItemStyle**, **DetailsView** denetim.</span><span class="sxs-lookup"><span data-stu-id="35028-409">In this dialog box you can easily control the visual properties, such as **ItemStyle**, of the **DetailsView** control.</span></span>
> 
> ![Kullanıma alma ve PayPal - alanları iletişim ödemeyle](checkout-and-payment-with-paypal/_static/image19.png)


### <a name="complete-purchase"></a><span data-ttu-id="35028-411">Satın almanızı tamamlayın</span><span class="sxs-lookup"><span data-stu-id="35028-411">Complete Purchase</span></span>

<span data-ttu-id="35028-412">*CheckoutComplete.aspx* sayfası, PayPal satın alma yapar.</span><span class="sxs-lookup"><span data-stu-id="35028-412">*CheckoutComplete.aspx* page makes the purchase from PayPal.</span></span> <span data-ttu-id="35028-413">Yukarıda belirtildiği gibi kullanıcı üzerinde tıklatmalısınız **tam sipariş** uygulama gideceği önce düğmesini *CheckoutComplete.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="35028-413">As mentioned above, the user must click on the **Complete Order** button before the application will navigate to the *CheckoutComplete.aspx* page.</span></span>

1. <span data-ttu-id="35028-414">İçinde *Checkout* sayfa adlı klasörü, açık *CheckoutComplete.aspx*.</span><span class="sxs-lookup"><span data-stu-id="35028-414">In the *Checkout* folder, open the page named *CheckoutComplete.aspx*.</span></span>
2. <span data-ttu-id="35028-415">Varolan biçimlendirme aşağıdakiyle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-415">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample22.aspx)]
3. <span data-ttu-id="35028-416">Adlı arka plan kod sayfası açmak *CheckoutComplete.aspx.cs* ve var olan kodu aşağıdakilerle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-416">Open the code-behind page named *CheckoutComplete.aspx.cs* and replace the existing code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample23.cs)]

<span data-ttu-id="35028-417">Zaman *CheckoutComplete.aspx* sayfa yüklenir, `DoCheckoutPayment` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="35028-417">When the *CheckoutComplete.aspx* page is loaded, the `DoCheckoutPayment` method is called.</span></span> <span data-ttu-id="35028-418">Daha önce belirtildiği gibi `DoCheckoutPayment` yöntemi tamamlayan PayPal sınama ortamı'ndan satın alma.</span><span class="sxs-lookup"><span data-stu-id="35028-418">As mentioned earlier, the `DoCheckoutPayment` method completes the purchase from the PayPal testing environment.</span></span> <span data-ttu-id="35028-419">PayPal satın alma siparişi tamamlandıktan sonra *CheckoutComplete.aspx* sayfasını görüntüler ödeme işlem `ID` satın alan için.</span><span class="sxs-lookup"><span data-stu-id="35028-419">Once PayPal has completed the purchase of the order, the *CheckoutComplete.aspx* page displays a payment transaction `ID` to the purchaser.</span></span>

### <a name="handle-cancel-purchase"></a><span data-ttu-id="35028-420">Tanıtıcı iptal satın alma</span><span class="sxs-lookup"><span data-stu-id="35028-420">Handle Cancel Purchase</span></span>

<span data-ttu-id="35028-421">Satın alma iptal etmek kullanıcı karar verirse, bunlar yönlendirilirsiniz *CheckoutCancel.aspx* sayfa burada bunlar görürsünüz: sıralarına iptal edildi.</span><span class="sxs-lookup"><span data-stu-id="35028-421">If the user decides to cancel the purchase, they will be directed to the *CheckoutCancel.aspx* page where they will see that their order has been cancelled.</span></span>

1. <span data-ttu-id="35028-422">Adlı sayfasını açın *CheckoutCancel.aspx* içinde *Checkout* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-422">Open the page named *CheckoutCancel.aspx* in the *Checkout* folder.</span></span>
2. <span data-ttu-id="35028-423">Varolan biçimlendirme aşağıdakiyle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-423">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample24.aspx)]

### <a name="handle-purchase-errors"></a><span data-ttu-id="35028-424">Satın alma hataları işleme</span><span class="sxs-lookup"><span data-stu-id="35028-424">Handle Purchase Errors</span></span>

<span data-ttu-id="35028-425">Satın alma işlemi sırasında hatalar tarafından işleneceğini *CheckoutError.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="35028-425">Errors during the purchase process will be handled by the *CheckoutError.aspx* page.</span></span> <span data-ttu-id="35028-426">Arka plan kod, *CheckoutStart.aspx* sayfasında, *CheckoutReview.aspx* sayfasında ve *CheckoutComplete.aspx* sayfa her yeniden yönlendirmek için  *CheckoutError.aspx* bir hata oluşursa sayfa.</span><span class="sxs-lookup"><span data-stu-id="35028-426">The code-behind of the *CheckoutStart.aspx* page, the *CheckoutReview.aspx* page, and the *CheckoutComplete.aspx* page will each redirect to the *CheckoutError.aspx* page if an error occurs.</span></span>

1. <span data-ttu-id="35028-427">Adlı sayfasını açın *CheckoutError.aspx* içinde *Checkout* klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-427">Open the page named *CheckoutError.aspx* in the *Checkout* folder.</span></span>
2. <span data-ttu-id="35028-428">Varolan biçimlendirme aşağıdakiyle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="35028-428">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample25.aspx)]

<span data-ttu-id="35028-429">*CheckoutError.aspx* kullanıma alma işlemi sırasında bir hata oluştuğunda hata ayrıntılarla sayfası görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-429">The *CheckoutError.aspx* page is displayed with the error details when an error occurs during the checkout process.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="35028-430">Uygulamayı Çalıştırma</span><span class="sxs-lookup"><span data-stu-id="35028-430">Running the Application</span></span>

<span data-ttu-id="35028-431">Ürün satın nasıl görmek için uygulamayı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="35028-431">Run the application to see how to purchase products.</span></span> <span data-ttu-id="35028-432">PayPal sınama ortamında çalıştırırsınız olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="35028-432">Note that you will be running in the PayPal testing environment.</span></span> <span data-ttu-id="35028-433">Hiçbir gerçek para alınıp verilir.</span><span class="sxs-lookup"><span data-stu-id="35028-433">No actual money is being exchanged.</span></span>

1. <span data-ttu-id="35028-434">Tüm dosyalarınızı Visual Studio'da kaydedilmiş olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="35028-434">Make sure all your files are saved in Visual Studio.</span></span>
2. <span data-ttu-id="35028-435">Bir Web tarayıcısı açın ve gidin [ https://developer.paypal.com ](https://developer.paypal.com/).</span><span class="sxs-lookup"><span data-stu-id="35028-435">Open a Web browser and navigate to [https://developer.paypal.com](https://developer.paypal.com/).</span></span>
3. <span data-ttu-id="35028-436">Bu öğreticide daha önce oluşturduğunuz PayPal Geliştirici hesabınız ile oturum açın.</span><span class="sxs-lookup"><span data-stu-id="35028-436">Login with your PayPal developer account that you created earlier in this tutorial.</span></span>  
   <span data-ttu-id="35028-437">PayPal'ın Geliştirici korumalı alan için oturum açmanız gerekir. [ https://developer.paypal.com ](https://developer.paypal.com/) express checkout test etmek için.</span><span class="sxs-lookup"><span data-stu-id="35028-437">For PayPal's developer sandbox, you need to be logged in at [https://developer.paypal.com](https://developer.paypal.com/) to test express checkout.</span></span> <span data-ttu-id="35028-438">Bu yalnızca sınama, PayPal'ın dinamik ortamına değil PayPal'ın Korumalı alan için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="35028-438">This only applies to PayPal's sandbox testing, not to PayPal's live environment.</span></span>
4. <span data-ttu-id="35028-439">Visual Studio'da basın **F5** Wingtip Toys örnek uygulamayı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="35028-439">In Visual Studio, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="35028-440">Veritabanını yeniden oluşturur sonra tarayıcıyı açın Göster ve *Default.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="35028-440">After the database rebuilds, the browser will open and show the *Default.aspx* page.</span></span>
5. <span data-ttu-id="35028-441">"Araba" gibi ürün kategorisi seçerek ve ardından üç farklı ürünler alışveriş sepetine eklemek **Sepete Ekle** her ürünün yanındaki.</span><span class="sxs-lookup"><span data-stu-id="35028-441">Add three different products to the shopping cart by selecting the product category, such as "Cars" and then clicking **Add to Cart** next to each product.</span></span>  
   <span data-ttu-id="35028-442">Alışveriş sepeti seçmiş olduğunuz ürün görüntüler.</span><span class="sxs-lookup"><span data-stu-id="35028-442">The shopping cart will display the product you have selected.</span></span>
6. <span data-ttu-id="35028-443">Tıklatın **PayPal** checkout düğme.</span><span class="sxs-lookup"><span data-stu-id="35028-443">Click the **PayPal** button to checkout.</span></span> 

    ![Kullanıma alma ve PayPal - Sepeti ödemeyle](checkout-and-payment-with-paypal/_static/image20.png)

   <span data-ttu-id="35028-445">Kullanıma Wingtip Toys örnek uygulama için bir kullanıcı hesabına sahip olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="35028-445">Checking out will require that you have a user account for the Wingtip Toys sample application.</span></span>
7. <span data-ttu-id="35028-446">Tıklatın **Google** sağdaki varolan bir gmail.com e-posta hesabı ile oturum açmanız sayfasının bağlantısı.</span><span class="sxs-lookup"><span data-stu-id="35028-446">Click the **Google** link on the right of the page to log in with an existing gmail.com email account.</span></span>  
   <span data-ttu-id="35028-447">Bir gmail.com hesabı yoksa, test etmek için bir tane oluşturabilirsiniz [www.gmail.com](https://www.gmail.com/). Standart bir yerel hesap "Register"'i tıklatarak de kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-447">If you do not have a gmail.com account, you can create one for testing purposes at [www.gmail.com](https://www.gmail.com/). You can also use a standard local account by clicking "Register".</span></span> 

    ![Kullanıma alma ve ödeme PayPal ile-oturum açın](checkout-and-payment-with-paypal/_static/image21.png)
8. <span data-ttu-id="35028-449">Gmail hesap ve parola ile oturum açın.</span><span class="sxs-lookup"><span data-stu-id="35028-449">Sign in with your gmail account and password.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - Gmail oturum açma ile](checkout-and-payment-with-paypal/_static/image22.png)
9. <span data-ttu-id="35028-451">Tıklatın **oturum** gmail hesabınıza Wingtip Toys örnek uygulama kullanıcı adınız ile kaydetmek için düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-451">Click the **Log in** button to register your gmail account with your Wingtip Toys sample application user name.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - kayıt hesabı ile](checkout-and-payment-with-paypal/_static/image23.png)
10. <span data-ttu-id="35028-453">PayPal sınama sitesinde eklemek, **alıcı** e-posta adresi ve Bu öğreticide daha önce oluşturduğunuz parola ve ardından **oturum** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-453">On the PayPal test site, add your **buyer** email address and password that you created earlier in this tutorial, then click the **Log In** button.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - PayPal oturum açma ile](checkout-and-payment-with-paypal/_static/image24.png)
11. <span data-ttu-id="35028-455">Kabul PayPal ilkeyi ve tıklatın **kabul et ve devam et** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-455">Agree to the PayPal policy and click the **Agree and Continue** button.</span></span>  
    <span data-ttu-id="35028-456">Bu sayfa yalnızca olduğuna dikkat edin, bu PayPal hesabı kullanmak ilk kez görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-456">Note that this page is only displayed the first time you use this PayPal account.</span></span> <span data-ttu-id="35028-457">Bu bir test hesabıdır, gerçek bir para alınıp yeniden unutmayın.</span><span class="sxs-lookup"><span data-stu-id="35028-457">Again note that this is a test account, no real money is exchanged.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - PayPal İlkesi ile](checkout-and-payment-with-paypal/_static/image25.png)
12. <span data-ttu-id="35028-459">Ortam gözden geçirme sayfasını ve tıklatın sınama PayPal siparişi bilgileri gözden **devam**.</span><span class="sxs-lookup"><span data-stu-id="35028-459">Review the order information on the PayPal testing environment review page and click **Continue**.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - bilgileri gözden geçir](checkout-and-payment-with-paypal/_static/image26.png)
13. <span data-ttu-id="35028-461">Üzerinde *CheckoutReview.aspx* sayfasında sipariş miktarını doğrulayın ve oluşturulan teslimat adresi görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="35028-461">On the *CheckoutReview.aspx* page, verify the order amount and view the generated shipping address.</span></span> <span data-ttu-id="35028-462">Ardından **tam sipariş** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="35028-462">Then, click the **Complete Order** button.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - sipariş gözden geçirme](checkout-and-payment-with-paypal/_static/image27.png)
14. <span data-ttu-id="35028-464">**CheckoutComplete.aspx** sayfası, bir ödeme işlem kimliğiyle görüntülenir</span><span class="sxs-lookup"><span data-stu-id="35028-464">The **CheckoutComplete.aspx** page is displayed with a payment transaction ID.</span></span> 

    ![Kullanıma alma ve PayPal - Checkout tam ödemeyle](checkout-and-payment-with-paypal/_static/image28.png)

<a id="ReviewDBWebForms"></a>
## <a name="reviewing-the-database"></a><span data-ttu-id="35028-466">Veritabanı gözden geçirme</span><span class="sxs-lookup"><span data-stu-id="35028-466">Reviewing the Database</span></span>

<span data-ttu-id="35028-467">Uygulamayı çalıştırdıktan sonra güncelleştirilmiş verileri Wingtip Toys örnek uygulama veritabanındaki gözden geçirerek, uygulamanın başarıyla ürünleri satın kaydedilen görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35028-467">By reviewing the updated data in the Wingtip Toys sample application database after running the application, you can see that the application successfully recorded the purchase of the products.</span></span>

<span data-ttu-id="35028-468">Bulunan verileri inceleyebilirsiniz *Wingtiptoys.mdf* kullanarak veritabanı dosyası **Database Explorer** penceresi (**Sunucu Gezgini** Visual Studio'daki) yaptığınız gibi daha önce Bu öğretici serisinde.</span><span class="sxs-lookup"><span data-stu-id="35028-468">You can inspect the data contained in the *Wingtiptoys.mdf* database file by using the **Database Explorer** window (**Server Explorer** window in Visual Studio) as you did earlier in this tutorial series.</span></span>

1. <span data-ttu-id="35028-469">Hala açıksa tarayıcı penceresini kapatın.</span><span class="sxs-lookup"><span data-stu-id="35028-469">Close the browser window if it is still open.</span></span>
2. <span data-ttu-id="35028-470">Visual Studio'da seçin **tüm dosyaları göster** en üstündeki simgesi **Çözüm Gezgini** genişletmenize izin vermek için **uygulama\_veri** klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-470">In Visual Studio, select the **Show All Files** icon at the top of **Solution Explorer** to allow you to expand the **App\_Data** folder.</span></span>
3. <span data-ttu-id="35028-471">Genişletme **uygulama\_veri** klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-471">Expand the **App\_Data** folder.</span></span>  
 <span data-ttu-id="35028-472">Seçmek için gerek duyabileceğiniz **tüm dosyaları göster** klasörü simgesi.</span><span class="sxs-lookup"><span data-stu-id="35028-472">You may need to select the **Show All Files** icon for the folder.</span></span>
4. <span data-ttu-id="35028-473">Sağ *Wingtiptoys.mdf* veritabanı dosyası ve select **açık**.</span><span class="sxs-lookup"><span data-stu-id="35028-473">Right-click the *Wingtiptoys.mdf* database file and select **Open**.</span></span>  
    <span data-ttu-id="35028-474">**Sunucu Gezgini** görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-474">**Server Explorer** is displayed.</span></span>
5. <span data-ttu-id="35028-475">Genişletme **tabloları** klasör.</span><span class="sxs-lookup"><span data-stu-id="35028-475">Expand the **Tables** folder.</span></span>
6. <span data-ttu-id="35028-476">Sağ **siparişleri**tablo ve seçin **Show Table Data**.</span><span class="sxs-lookup"><span data-stu-id="35028-476">Right-click the **Orders**table and select **Show Table Data**.</span></span>  
 <span data-ttu-id="35028-477">**Siparişleri** tablo görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="35028-477">The **Orders** table is displayed.</span></span>
7. <span data-ttu-id="35028-478">Gözden geçirme **PaymentTransactionID** başarılı işlemlerin onaylamak için sütun.</span><span class="sxs-lookup"><span data-stu-id="35028-478">Review the **PaymentTransactionID** column to confirm successful transactions.</span></span> 

    ![Kullanıma alma ve ödeme PayPal - gözden geçirme veritabanı ile](checkout-and-payment-with-paypal/_static/image29.png)
8. <span data-ttu-id="35028-480">Kapat **siparişleri** Tablo penceresi.</span><span class="sxs-lookup"><span data-stu-id="35028-480">Close the **Orders** table window.</span></span>
9. <span data-ttu-id="35028-481">Sunucu Gezgini'nde sağ **sipariş ayrıntıları** tablo ve seçin **Show Table Data**.</span><span class="sxs-lookup"><span data-stu-id="35028-481">In the Server Explorer, right-click the **OrderDetails** table and select **Show Table Data**.</span></span>
10. <span data-ttu-id="35028-482">Gözden geçirme `OrderId` ve `Username` değerler **sipariş ayrıntıları** tablo.</span><span class="sxs-lookup"><span data-stu-id="35028-482">Review the `OrderId` and `Username` values in the **OrderDetails** table.</span></span> <span data-ttu-id="35028-483">Bu değerlerin eşleşmesi Not `OrderId` ve `Username` dahil değerleri **siparişleri** tablo.</span><span class="sxs-lookup"><span data-stu-id="35028-483">Note that these values match the `OrderId` and `Username` values included in the **Orders** table.</span></span>
11. <span data-ttu-id="35028-484">Kapat **sipariş ayrıntıları** Tablo penceresi.</span><span class="sxs-lookup"><span data-stu-id="35028-484">Close the **OrderDetails** table window.</span></span>
12. <span data-ttu-id="35028-485">Wingtip Toys veritabanı dosyasına sağ tıklayın (*Wingtiptoys.mdf*) seçip **yakın bağlantı**.</span><span class="sxs-lookup"><span data-stu-id="35028-485">Right-click the Wingtip Toys database file (*Wingtiptoys.mdf*) and select **Close Connection**.</span></span>
13. <span data-ttu-id="35028-486">Görmüyorsanız, **Çözüm Gezgini** penceresinde tıklatın **Çözüm Gezgini** alt kısmındaki **Sunucu Gezgini** göstermek için pencere **Çözüm Gezgini**  yeniden.</span><span class="sxs-lookup"><span data-stu-id="35028-486">If you do not see the **Solution Explorer** window, click **Solution Explorer** at the bottom of the **Server Explorer** window to show the **Solution Explorer** again.</span></span>

## <a name="summary"></a><span data-ttu-id="35028-487">Özet</span><span class="sxs-lookup"><span data-stu-id="35028-487">Summary</span></span>

<span data-ttu-id="35028-488">Bu öğreticide sırası ve siparişi ayrıntı şemalarını ürünleri satın izlemek için eklendi.</span><span class="sxs-lookup"><span data-stu-id="35028-488">In this tutorial you added order and order detail schemas to track the purchase of products.</span></span> <span data-ttu-id="35028-489">Wingtip Toys örnek uygulamaya PayPal işlevselliği de tümleşik.</span><span class="sxs-lookup"><span data-stu-id="35028-489">You also integrated PayPal functionality into the Wingtip Toys sample application.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="35028-490">Ek Kaynaklar</span><span class="sxs-lookup"><span data-stu-id="35028-490">Additional Resources</span></span>

<span data-ttu-id="35028-491">[ASP.NET yapılandırmasına genel bakış](https://msdn.microsoft.com/library/ms178683(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="35028-491">[ASP.NET Configuration Overview](https://msdn.microsoft.com/library/ms178683(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="35028-492">Güvenli ASP.NET Web Forms uygulama üyeliği, OAuth ve SQL veritabanı ile Azure App Service'e dağıtma</span><span class="sxs-lookup"><span data-stu-id="35028-492">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="35028-493">Microsoft Azure - ücretsiz deneme sürümü</span><span class="sxs-lookup"><span data-stu-id="35028-493">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

## <a name="disclaimer"></a><span data-ttu-id="35028-494">Sorumluluk reddi</span><span class="sxs-lookup"><span data-stu-id="35028-494">Disclaimer</span></span>

<span data-ttu-id="35028-495">Bu öğreticinin örnek kodunu içerir.</span><span class="sxs-lookup"><span data-stu-id="35028-495">This tutorial contains sample code.</span></span> <span data-ttu-id="35028-496">Bu örnek kod, hiçbir garanti "olduğu gibi" sağlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="35028-496">Such sample code is provided "as is" without warranty of any kind.</span></span> <span data-ttu-id="35028-497">Buna göre Microsoft doğruluğu, bütünlük ve örnek kod kalitesini garanti etmez.</span><span class="sxs-lookup"><span data-stu-id="35028-497">Accordingly, Microsoft does not guarantee the accuracy, integrity, or quality of the sample code.</span></span> <span data-ttu-id="35028-498">Örnek kod, kendi risk kullanmayı kabul etmiş olursunuz.</span><span class="sxs-lookup"><span data-stu-id="35028-498">You agree to use the sample code at your own risk.</span></span> <span data-ttu-id="35028-499">Hiçbir koşulda Microsoft herhangi bir şekilde size içerik dahil ancak bunlarla sınırlı olmamak üzere, herhangi bir hata veya eksikliklerden herhangi bir örnek kod, içerik veya herhangi kayıp veya hasar herhangi bir örnek kod kullanımı sonucunda sonucunda oluşan herhangi bir türde tüm örnek kod için sorumlu değildir.</span><span class="sxs-lookup"><span data-stu-id="35028-499">Under no circumstances will Microsoft be liable to you in any way for any sample code, content, including but not limited to, any errors or omissions in any sample code, content, or any loss or damage of any kind incurred as a result of the use of any sample code.</span></span> <span data-ttu-id="35028-500">Burada REDDETMEKTEDİR bildirilir ve burada REDDETMEKTEDİR tazmin, kabul kaydetmek ve Microsoft gelen ve tüm kaybı, talep kaybı, yaralanma veya hasar tür, bunlarla sınırlı olmamak kaydıyla tarafından occasioned dahil olmak üzere veya deftere malzemesini doğan karşı zararsız tutun iletme, kullanın veya, ancak bunlarla sınırlı olmamak, okuduğunuzu ifade görünümleri dahil olmak üzere üzerinde kullanır.</span><span class="sxs-lookup"><span data-stu-id="35028-500">You are hereby notified and do hereby agree to indemnify, save and hold Microsoft harmless from and against any and all loss, claims of loss, injury or damage of any kind including, without limitation, those occasioned by or arising from material that you post, transmit, use or rely on including, but not limited to, the views expressed therein.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="35028-501">[Önceki](shopping-cart.md)
> [sonraki](membership-and-administration.md)</span><span class="sxs-lookup"><span data-stu-id="35028-501">[Previous](shopping-cart.md)
[Next](membership-and-administration.md)</span></span>
